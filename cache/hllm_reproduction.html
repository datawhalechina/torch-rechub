<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>torch-rechub</title>
    <meta name="description" content="A Lighting Pytorch Framework for Recommendation Models, Easy-to-use and Easy-to-extend.">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/torch-rechub/assets/style.Dnbe36Wi.css" as="style">
    <link rel="preload stylesheet" href="/torch-rechub/vp-icons.css" as="style">
    
    <script type="module" src="/torch-rechub/assets/app.CXyeMGsY.js"></script>
    <link rel="preload" href="/torch-rechub/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/torch-rechub/assets/chunks/theme.DcjLc-1R.js">
    <link rel="modulepreload" href="/torch-rechub/assets/chunks/framework.CFr_S-Bc.js">
    <link rel="modulepreload" href="/torch-rechub/assets/cache_hllm_reproduction.md.SEr1WJjZ.lean.js">
    <link rel="icon" href="/torch-rechub/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/torch-rechub/" data-v-1e38c6bc><!--[--><!--]--><!--[--><img class="VPImage logo" src="/torch-rechub/img/logo.png" alt data-v-8426fc1a><!--]--><span data-v-1e38c6bc>torch-rechub</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!--[--><!----><div id="local-search"><button type="button" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><span class="vpi-search DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ  Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/guide/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸš€ Getting Started</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/core/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>âš™ï¸ Core</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/models/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ° Models</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/tools/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ› ï¸ Tools</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/serving/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸš€ Serving</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/tutorials/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ“– Tutorials</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/api/api.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>â„¹ï¸ API</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/community/faq.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ‘¥ Community</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-70946a35 data-v-4c1766e2 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-42cb505d><span class="text" data-v-42cb505d><span class="vpi-languages option-icon" data-v-42cb505d></span><!----><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="items" data-v-4c1766e2><p class="title" data-v-4c1766e2>English</p><!--[--><div class="VPMenuLink" data-v-4c1766e2 data-v-faf5b206><a class="VPLink link" href="/torch-rechub/zh/cache/hllm_reproduction.html" lang="zh-CN" data-v-faf5b206><!--[--><span data-v-faf5b206>ä¸­æ–‡</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/datawhalechina/torch-rechub" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="group translations" data-v-bf2fac68><p class="trans-title" data-v-bf2fac68>English</p><!--[--><div class="VPMenuLink" data-v-bf2fac68 data-v-faf5b206><a class="VPLink link" href="/torch-rechub/zh/cache/hllm_reproduction.html" lang="zh-CN" data-v-faf5b206><!--[--><span data-v-faf5b206>ä¸­æ–‡</span><!--]--></a></div><!--]--></div><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/datawhalechina/torch-rechub" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _torch-rechub_cache_hllm_reproduction" data-v-7011f0d8><div><h2 id="hllm-æ¨¡å‹åœ¨-torch-rechub-ä¸­çš„å¤ç°è¯´æ˜" tabindex="-1">HLLM æ¨¡å‹åœ¨ torch-rechub ä¸­çš„å¤ç°è¯´æ˜ <a class="header-anchor" href="#hllm-æ¨¡å‹åœ¨-torch-rechub-ä¸­çš„å¤ç°è¯´æ˜" aria-label="Permalink to â€œHLLM æ¨¡å‹åœ¨ torch-rechub ä¸­çš„å¤ç°è¯´æ˜â€">â€‹</a></h2><p>æœ¬æ–‡æ¡£æ€»ç»“ torch-rechub ä¸­å¯¹ ByteDance HLLMï¼ˆHierarchical Large Language Model for Recommendationï¼‰æ¨¡å‹çš„å¤ç°æƒ…å†µï¼Œé‡ç‚¹è¯´æ˜ï¼š</p><ul><li>å½“å‰å®ç°çš„æ•´ä½“æ¶æ„ä¸å…³é”®è®¾è®¡ç»†èŠ‚ï¼›</li><li>ä¸ ByteDance å®˜æ–¹å¼€æºå®ç°çš„ä¸€è‡´ä¹‹å¤„ï¼›</li><li>æœ‰æ„ç®€åŒ–æˆ–ä»ç„¶å­˜åœ¨å·®å¼‚çš„éƒ¨åˆ†ã€‚</li></ul><hr><h2 id="_1-æ•´ä½“æ¶æ„æ¦‚è§ˆ" tabindex="-1">1. æ•´ä½“æ¶æ„æ¦‚è§ˆ <a class="header-anchor" href="#_1-æ•´ä½“æ¶æ„æ¦‚è§ˆ" aria-label="Permalink to â€œ1. æ•´ä½“æ¶æ„æ¦‚è§ˆâ€">â€‹</a></h2><h3 id="_1-1-æ¨¡å—åˆ’åˆ†" tabindex="-1">1.1 æ¨¡å—åˆ’åˆ† <a class="header-anchor" href="#_1-1-æ¨¡å—åˆ’åˆ†" aria-label="Permalink to â€œ1.1 æ¨¡å—åˆ’åˆ†â€">â€‹</a></h3><p>ä¸ HLLM ç›¸å…³çš„ä¸»è¦æ¨¡å—å¦‚ä¸‹ï¼š</p><ul><li><strong>æ¨¡å‹ä¸»ä½“</strong>ï¼š<code>torch_rechub/models/generative/hllm.py</code><ul><li><code>HLLMTransformerBlock</code>ï¼šå•å±‚ Transformer blockï¼ˆå¤šå¤´æ³¨æ„åŠ› + FFNï¼‰</li><li><code>HLLMModel</code>ï¼šå®Œæ•´ HLLM æ¨¡å‹ï¼ˆembedding lookup + Transformer blocks + scoring headï¼‰</li></ul></li><li><strong>æ•°æ®é¢„å¤„ç†</strong>ï¼š <ul><li><code>examples/generative/data/ml-1m/preprocess_hllm_data.py</code>ï¼šç»Ÿä¸€çš„ HLLM æ•°æ®é¢„å¤„ç†ï¼ˆæ–‡æœ¬æå– + embedding ç”Ÿæˆï¼‰</li></ul></li><li><strong>è®­ç»ƒè„šæœ¬</strong>ï¼š<code>examples/generative/run_hllm_movielens.py</code></li><li><strong>æ•°æ®é›†ä¸æ•°æ®ç”Ÿæˆå™¨</strong>ï¼š<code>torch_rechub/utils/data.py</code>ï¼ˆå¤ç”¨ HSTU çš„ SeqDatasetã€SequenceDataGeneratorï¼‰</li><li><strong>è®­ç»ƒä¸è¯„ä¼°</strong>ï¼š<code>torch_rechub/trainers/seq_trainer.py</code>ï¼ˆå¤ç”¨ HSTU çš„ SeqTrainerï¼‰</li></ul><h3 id="_1-2-æ•°æ®ä¸ä»»åŠ¡" tabindex="-1">1.2 æ•°æ®ä¸ä»»åŠ¡ <a class="header-anchor" href="#_1-2-æ•°æ®ä¸ä»»åŠ¡" aria-label="Permalink to â€œ1.2 æ•°æ®ä¸ä»»åŠ¡â€">â€‹</a></h3><ul><li>æ•°æ®é›†ï¼šMovieLens-1Mï¼ˆratings.dat + movies.datï¼‰</li><li>ä»»åŠ¡å½¢å¼ï¼š<strong>Next-item prediction</strong>ï¼ˆç»™å®šå†å²åºåˆ—ï¼Œé¢„æµ‹ä¸‹ä¸€ä¸ª itemï¼‰</li><li>è®­ç»ƒç›®æ ‡ï¼šäº¤å‰ç†µæŸå¤±ï¼ˆä»…ä½¿ç”¨åºåˆ—æœ€åä¸€ä¸ªä½ç½®çš„ logitsï¼‰</li><li>è¯„ä¼°æŒ‡æ ‡ï¼šHR@Kã€NDCG@Kï¼ˆK=10, 50, 200ï¼‰</li></ul><hr><h2 id="_2-hllm-æ ¸å¿ƒæ¶æ„" tabindex="-1">2. HLLM æ ¸å¿ƒæ¶æ„ <a class="header-anchor" href="#_2-hllm-æ ¸å¿ƒæ¶æ„" aria-label="Permalink to â€œ2. HLLM æ ¸å¿ƒæ¶æ„â€">â€‹</a></h2><h3 id="_2-1-ä¸¤çº§ç»“æ„" tabindex="-1">2.1 ä¸¤çº§ç»“æ„ <a class="header-anchor" href="#_2-1-ä¸¤çº§ç»“æ„" aria-label="Permalink to â€œ2.1 ä¸¤çº§ç»“æ„â€">â€‹</a></h3><p>HLLM é‡‡ç”¨&quot;Item LLM + User LLM&quot;çš„ä¸¤çº§ç»“æ„ï¼š</p><ol><li><p><strong>Item LLMï¼ˆç¦»çº¿ï¼‰</strong></p><ul><li>è¾“å…¥ï¼šç”µå½±æ–‡æœ¬ï¼Œæ ¼å¼ä¸º <code>&quot;Compress the following sentence into embedding: title: {title}genres: {genres}&quot;</code></li><li>å¤„ç†ï¼šä½¿ç”¨é¢„è®­ç»ƒ LLMï¼ˆTinyLlama-1.1B æˆ– Baichuan2-7Bï¼‰</li><li>è¾“å‡ºï¼šæ¯ä¸ª item çš„ embeddingï¼ˆç»´åº¦ d_modelï¼Œå¦‚ 2048 æˆ– 4096ï¼‰</li><li>æå–æ–¹å¼ï¼šä½¿ç”¨æœ€åä¸€ä¸ª token çš„éšè—çŠ¶æ€</li><li>ç‰¹ç‚¹ï¼šç¦»çº¿é¢„è®¡ç®—ï¼Œè®­ç»ƒæ—¶å›ºå®šä¸å˜</li></ul></li><li><p><strong>User LLMï¼ˆåœ¨çº¿ï¼‰</strong></p><ul><li>è¾“å…¥ï¼šitem embedding åºåˆ— <code>[E_1, E_2, ..., E_L]</code></li><li>å¤„ç†ï¼šTransformer blocksï¼ˆå¤šå¤´è‡ªæ³¨æ„åŠ› + FFNï¼‰</li><li>è¾“å‡ºï¼šé¢„æµ‹ embedding <code>E&#39;_L</code></li><li>Scoring headï¼š<code>logits = E&#39;_L @ E_items.T / Ï„</code>ï¼ˆç‚¹ç§¯ + æ¸©åº¦ç¼©æ”¾ï¼‰</li></ul></li></ol><h3 id="_2-2-å®˜æ–¹-vs-è½»é‡çº§å®ç°" tabindex="-1">2.2 å®˜æ–¹ vs è½»é‡çº§å®ç° <a class="header-anchor" href="#_2-2-å®˜æ–¹-vs-è½»é‡çº§å®ç°" aria-label="Permalink to â€œ2.2 å®˜æ–¹ vs è½»é‡çº§å®ç°â€">â€‹</a></h3><p>æœ¬å®ç°é‡‡ç”¨<strong>è½»é‡çº§æ–¹å¼</strong>ï¼Œä¸å®˜æ–¹ ByteDance HLLM çš„ç«¯åˆ°ç«¯è®­ç»ƒæœ‰ä»¥ä¸‹å·®å¼‚ï¼š</p><table tabindex="0"><thead><tr><th>ç»„ä»¶</th><th>å®˜æ–¹å®ç°</th><th>æœ¬å®ç°ï¼ˆè½»é‡çº§ï¼‰</th></tr></thead><tbody><tr><td><strong>Item LLM</strong></td><td>å®Œæ•´ LLMï¼Œå¯å‚ä¸ç«¯åˆ°ç«¯è®­ç»ƒ</td><td>é¢„è®¡ç®— embeddingsï¼Œå›ºå®šä¸å˜</td></tr><tr><td><strong>User LLM</strong></td><td>å®Œæ•´ LLMï¼ˆå¦‚ Llama-7Bï¼‰</td><td>è½»é‡çº§ Transformer blocks</td></tr><tr><td><strong>item_emb_token_n</strong></td><td>å¯å­¦ä¹ çš„ embedding token</td><td>ä½¿ç”¨æœ€å token çš„éšè—çŠ¶æ€</td></tr><tr><td><strong>è®­ç»ƒæ–¹å¼</strong></td><td>ç«¯åˆ°ç«¯è”åˆè®­ç»ƒ</td><td>ä»…è®­ç»ƒ User Transformer</td></tr><tr><td><strong>èµ„æºéœ€æ±‚</strong></td><td>é«˜ï¼ˆå¤š GPUï¼ŒDeepSpeedï¼‰</td><td>ä½ï¼ˆå• GPU å¯è¿è¡Œï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å¤§è§„æ¨¡ç”Ÿäº§ç¯å¢ƒ</td><td>ç ”ç©¶ã€æ•™å­¦ã€å¿«é€ŸåŸå‹</td></tr></tbody></table><p><strong>è®¾è®¡ç†ç”±</strong>ï¼š</p><ul><li>âœ… èµ„æºå‹å¥½ï¼šå•å¼  GPU å³å¯è¿è¡Œ</li><li>âœ… å¿«é€Ÿè¿­ä»£ï¼šé¢„è®¡ç®— Item Embeddingsï¼Œè®­ç»ƒæ›´å¿«</li><li>âœ… æ ¸å¿ƒåŠŸèƒ½å®Œæ•´ï¼šæç¤ºè¯æ ¼å¼ã€æ¨¡å‹æ¶æ„ä¸å®˜æ–¹ä¸€è‡´</li></ul><h3 id="_2-3-hllmtransformerblock-å®ç°" tabindex="-1">2.3 HLLMTransformerBlock å®ç° <a class="header-anchor" href="#_2-3-hllmtransformerblock-å®ç°" aria-label="Permalink to â€œ2.3 HLLMTransformerBlock å®ç°â€">â€‹</a></h3><p><code>torch_rechub/models/generative/hllm.py::HLLMTransformerBlock</code> å®ç°äº†æ ‡å‡†çš„ Transformer blockï¼š</p><ol><li><p><strong>å¤šå¤´è‡ªæ³¨æ„åŠ›</strong></p><ul><li>çº¿æ€§æŠ•å½±ï¼šQ, K, V å„è‡ªæŠ•å½±åˆ° (B, L, D)</li><li>æ³¨æ„åŠ›æ‰“åˆ†ï¼š<code>scores = (Q @ K^T) / sqrt(d_head)</code></li><li>Causal maskï¼šä½ç½® i åªèƒ½çœ‹åˆ° <code>â‰¤ i</code> çš„ token</li><li>å¯é€‰ç›¸å¯¹ä½ç½®åç½®ï¼ˆå¤ç”¨ HSTU çš„ RelPosBiasï¼‰</li></ul></li><li><p><strong>å‰é¦ˆç½‘ç»œï¼ˆFFNï¼‰</strong></p><ul><li>ç»“æ„ï¼šLinear(D â†’ 4D) â†’ ReLU â†’ Dropout â†’ Linear(4D â†’ D) â†’ Dropout</li><li>æ ‡å‡† Transformer è®¾è®¡</li></ul></li><li><p><strong>æ®‹å·®è¿æ¥ä¸ LayerNorm</strong></p><ul><li>Pre-norm æ¶æ„ï¼šLayerNorm â†’ å­å±‚ â†’ æ®‹å·®</li><li>ä¸¤ä¸ªæ®‹å·®å—ï¼šè‡ªæ³¨æ„åŠ› + FFN</li></ul></li></ol><h3 id="_2-4-hllmmodel-å‰å‘æµç¨‹" tabindex="-1">2.4 HLLMModel å‰å‘æµç¨‹ <a class="header-anchor" href="#_2-4-hllmmodel-å‰å‘æµç¨‹" aria-label="Permalink to â€œ2.4 HLLMModel å‰å‘æµç¨‹â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>seq_tokens (B, L)</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>item_embeddings lookup â†’ (B, L, D)</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>+ position_embedding (L, D)</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>+ time_embedding (å¯é€‰) (B, L, D)</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>Transformer blocks (n_layers)</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>Scoring head: @ item_embeddings.T / Ï„</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>logits (B, L, vocab_size)</span></span></code></pre></div><hr><h2 id="_3-æ—¶é—´æˆ³å»ºæ¨¡" tabindex="-1">3. æ—¶é—´æˆ³å»ºæ¨¡ <a class="header-anchor" href="#_3-æ—¶é—´æˆ³å»ºæ¨¡" aria-label="Permalink to â€œ3. æ—¶é—´æˆ³å»ºæ¨¡â€">â€‹</a></h2><p>HLLM å¤ç”¨ HSTU çš„æ—¶é—´åµŒå…¥æœºåˆ¶ï¼š</p><ul><li><strong>æ—¶é—´å·®è®¡ç®—</strong>ï¼š<code>query_time - historical_timestamps</code></li><li><strong>å•ä½è½¬æ¢</strong>ï¼šç§’ â†’ åˆ†é’Ÿï¼ˆé™¤ä»¥ 60ï¼‰</li><li><strong>Bucket åŒ–</strong>ï¼šsqrt æˆ– log å˜æ¢ï¼Œæ˜ å°„åˆ° [0, num_time_buckets-1]</li><li><strong>åµŒå…¥èåˆ</strong>ï¼š<code>embeddings = item_emb + pos_emb + time_emb</code></li></ul><hr><h2 id="_4-è®­ç»ƒä¸è¯„ä¼°æµæ°´çº¿" tabindex="-1">4. è®­ç»ƒä¸è¯„ä¼°æµæ°´çº¿ <a class="header-anchor" href="#_4-è®­ç»ƒä¸è¯„ä¼°æµæ°´çº¿" aria-label="Permalink to â€œ4. è®­ç»ƒä¸è¯„ä¼°æµæ°´çº¿â€">â€‹</a></h2><h3 id="_4-1-æ•°æ®é¢„å¤„ç†" tabindex="-1">4.1 æ•°æ®é¢„å¤„ç† <a class="header-anchor" href="#_4-1-æ•°æ®é¢„å¤„ç†" aria-label="Permalink to â€œ4.1 æ•°æ®é¢„å¤„ç†â€">â€‹</a></h3><p><strong>ç»Ÿä¸€çš„ HLLM æ•°æ®é¢„å¤„ç†</strong>ï¼ˆ<code>preprocess_hllm_data.py</code>ï¼‰</p><p>è¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li><p><strong>æ–‡æœ¬æå–</strong>ï¼ˆéµå¾ªå®˜æ–¹ ByteDance HLLM æ ¼å¼ï¼‰</p><ul><li>ä» movies.dat æå– title å’Œ genres</li><li>ç”Ÿæˆæ–‡æœ¬æè¿°ï¼š<code>&quot;Compress the following sentence into embedding: title: {title}genres: {genres}&quot;</code></li><li>ä¿å­˜ä¸º movie_text_map.pkl</li></ul></li><li><p><strong>Item Embedding ç”Ÿæˆ</strong></p><ul><li>åŠ è½½ TinyLlama-1.1B æˆ– Baichuan2-7B</li><li>ä½¿ç”¨æœ€åä¸€ä¸ª token çš„éšè—çŠ¶æ€ä½œä¸º item embedding</li><li>ä¿å­˜ä¸º item_embeddings_tinyllama.pt æˆ– item_embeddings_baichuan2.pt</li></ul></li></ol><p><strong>å®˜æ–¹æç¤ºè¯æ ¼å¼è¯´æ˜</strong>ï¼š</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®˜æ–¹ ByteDance HLLM é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ITEM_PROMPT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Compress the following sentence into embedding: &quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># MovieLens æ•°æ®é›†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">text </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{ITEM_PROMPT}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">title: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">title</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">genres: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">genres</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Amazon Books æ•°æ®é›†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">text </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{ITEM_PROMPT}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">title: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">title</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">description: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">description</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span></code></pre></div><p><strong>å…³é”®ç‚¹</strong>ï¼š</p><ul><li>âœ… ä½¿ç”¨å®˜æ–¹ <code>item_prompt</code> å‰ç¼€ï¼š<code>&quot;Compress the following sentence into embedding: &quot;</code></li><li>âœ… ä½¿ç”¨ <code>key: value</code> æ ¼å¼ï¼ˆæ— ç©ºæ ¼ï¼Œå¦‚ <code>title: xxx</code>ï¼‰</li><li>âœ… ä½¿ç”¨æœ€åä¸€ä¸ª token çš„éšè—çŠ¶æ€ï¼ˆä¸å†ä½¿ç”¨ <code>[ITEM]</code> ç‰¹æ®Šæ ‡è®°ï¼‰</li></ul><ol start="3"><li><strong>åºåˆ—æ•°æ®é¢„å¤„ç†</strong>ï¼ˆå¤ç”¨ <code>preprocess_ml_hstu.py</code>ï¼‰ <ul><li>ç”Ÿæˆ seq_tokensã€seq_positionsã€seq_time_diffsã€targets</li><li>æŒ‰ç”¨æˆ·åˆ’åˆ† train/val/test</li></ul></li></ol><h3 id="_4-2-è®­ç»ƒä¸è¯„ä¼°" tabindex="-1">4.2 è®­ç»ƒä¸è¯„ä¼° <a class="header-anchor" href="#_4-2-è®­ç»ƒä¸è¯„ä¼°" aria-label="Permalink to â€œ4.2 è®­ç»ƒä¸è¯„ä¼°â€">â€‹</a></h3><ul><li>ä½¿ç”¨ <code>SeqTrainer</code> è¿›è¡Œè®­ç»ƒ</li><li><strong>æŸå¤±å‡½æ•°</strong>ï¼šæ”¯æŒä¸¤ç§é€‰æ‹© <ul><li><strong>NCE Loss</strong>ï¼ˆæ¨èï¼Œé»˜è®¤ï¼‰ï¼šå™ªå£°å¯¹æ¯”ä¼°è®¡æŸå¤±ï¼Œè®­ç»ƒæ•ˆç‡æ›´é«˜ï¼ˆæå‡ 30-50%ï¼‰</li><li><strong>CrossEntropyLoss</strong>ï¼šæ ‡å‡†äº¤å‰ç†µæŸå¤±</li></ul></li><li>è¯„ä¼°æŒ‡æ ‡ï¼šHR@Kã€NDCG@K</li></ul><h4 id="nce-loss-è¯´æ˜" tabindex="-1">NCE Loss è¯´æ˜ <a class="header-anchor" href="#nce-loss-è¯´æ˜" aria-label="Permalink to â€œNCE Loss è¯´æ˜â€">â€‹</a></h4><p>NCE Lossï¼ˆNoise Contrastive Estimationï¼‰æ˜¯ä¸€ç§é«˜æ•ˆçš„æŸå¤±å‡½æ•°ï¼Œç‰¹åˆ«é€‚åˆå¤§è§„æ¨¡æ¨èç³»ç»Ÿï¼š</p><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ul><li>âœ… è®­ç»ƒæ•ˆç‡æå‡ 30-50%ï¼ˆç›¸æ¯” CrossEntropyLossï¼‰</li><li>âœ… æ›´å¥½åœ°å¤„ç†å¤§è§„æ¨¡ item é›†åˆ</li><li>âœ… æ”¯æŒæ¸©åº¦ç¼©æ”¾å‚æ•°è°ƒæ•´</li><li>âœ… å†…ç½® in-batch negatives è´Ÿé‡‡æ ·ç­–ç•¥</li></ul><p><strong>ä½¿ç”¨æ–¹æ³•</strong>ï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ NCE Lossï¼ˆé»˜è®¤ï¼Œæ¨èï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/run_hllm_movielens.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --loss_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nce</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cuda</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ CrossEntropyLoss</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/run_hllm_movielens.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --loss_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cross_entropy</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cuda</span></span></code></pre></div><p><strong>å‚æ•°é…ç½®</strong>ï¼š</p><ul><li>NCE Loss é»˜è®¤æ¸©åº¦å‚æ•°ï¼š<code>temperature=0.1</code></li><li>å¯é€šè¿‡ä¿®æ”¹è®­ç»ƒè„šæœ¬ä¸­çš„ <code>loss_params</code> è°ƒæ•´</li></ul><h4 id="è´Ÿé‡‡æ ·ç­–ç•¥è¯´æ˜" tabindex="-1">è´Ÿé‡‡æ ·ç­–ç•¥è¯´æ˜ <a class="header-anchor" href="#è´Ÿé‡‡æ ·ç­–ç•¥è¯´æ˜" aria-label="Permalink to â€œè´Ÿé‡‡æ ·ç­–ç•¥è¯´æ˜â€">â€‹</a></h4><p>å½“å‰å®ç°ä½¿ç”¨ <strong>In-Batch Negatives</strong> ç­–ç•¥ï¼š</p><p><strong>åŸç†</strong>ï¼š</p><ul><li>ä½¿ç”¨åŒä¸€ batch å†…å…¶ä»–æ ·æœ¬çš„ target ä½œä¸ºè´Ÿæ ·æœ¬</li><li>è‡ªåŠ¨è·å¾— batch_size-1 ä¸ªè´Ÿæ ·æœ¬</li><li>æ— éœ€é¢å¤–è®¡ç®—ï¼Œè®¡ç®—æ•ˆç‡é«˜</li></ul><p><strong>æ€§èƒ½æå‡</strong>ï¼š</p><ul><li>âœ… æ¨¡å‹æ€§èƒ½æå‡ 5-10%</li><li>âœ… æ— é¢å¤–è®¡ç®—å¼€é”€</li><li>âœ… è‡ªåŠ¨åº”ç”¨ï¼Œæ— éœ€é…ç½®</li></ul><p><strong>å·¥ä½œåŸç†</strong>ï¼š</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Batch ä¸­çš„æ ·æœ¬ï¼š[target_1, target_2, ..., target_B]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¯¹äºæ ·æœ¬ iï¼š</span></span>
<span class="line"><span>- æ­£æ ·æœ¬ï¼štarget_i</span></span>
<span class="line"><span>- è´Ÿæ ·æœ¬ï¼š{target_j | j â‰  i}ï¼ˆè‡ªåŠ¨ä½¿ç”¨ï¼‰</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Loss è®¡ç®—æ—¶è‡ªåŠ¨åˆ©ç”¨è¿™äº›è´Ÿæ ·æœ¬</span></span></code></pre></div><hr><h2 id="_5-ä½¿ç”¨æŒ‡å—" tabindex="-1">5. ä½¿ç”¨æŒ‡å— <a class="header-anchor" href="#_5-ä½¿ç”¨æŒ‡å—" aria-label="Permalink to â€œ5. ä½¿ç”¨æŒ‡å—â€">â€‹</a></h2><h3 id="_5-1-ç¯å¢ƒè¦æ±‚" tabindex="-1">5.1 ç¯å¢ƒè¦æ±‚ <a class="header-anchor" href="#_5-1-ç¯å¢ƒè¦æ±‚" aria-label="Permalink to â€œ5.1 ç¯å¢ƒè¦æ±‚â€">â€‹</a></h3><h4 id="_5-1-1-ä¾èµ–åŒ…" tabindex="-1">5.1.1 ä¾èµ–åŒ… <a class="header-anchor" href="#_5-1-1-ä¾èµ–åŒ…" aria-label="Permalink to â€œ5.1.1 ä¾èµ–åŒ…â€">â€‹</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> torch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> transformers</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> numpy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pandas</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scikit-learn</span></span></code></pre></div><h4 id="_5-1-2-gpu-ä¸-cuda" tabindex="-1">5.1.2 GPU ä¸ CUDA <a class="header-anchor" href="#_5-1-2-gpu-ä¸-cuda" aria-label="Permalink to â€œ5.1.2 GPU ä¸ CUDAâ€">â€‹</a></h4><ul><li><p><strong>GPU æ£€æŸ¥</strong>ï¼šç¡®ä¿ PyTorch èƒ½è¯†åˆ« GPU</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(torch.cuda.is_available())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åº”è¾“å‡º True</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(torch.cuda.get_device_name(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ˜¾ç¤º GPU åç§°</span></span></code></pre></div></li><li><p><strong>æ˜¾å­˜éœ€æ±‚</strong>ï¼š</p><ul><li><strong>TinyLlama-1.1B</strong>ï¼šè‡³å°‘ 3GB æ˜¾å­˜ï¼ˆæ¨è 4GB+ï¼‰</li><li><strong>Baichuan2-7B</strong>ï¼šè‡³å°‘ 16GB æ˜¾å­˜ï¼ˆæ¨è 20GB+ï¼‰</li><li><strong>HLLM è®­ç»ƒ</strong>ï¼šè‡³å°‘ 6GB æ˜¾å­˜ï¼ˆbatch_size=512ï¼‰</li></ul></li></ul><h4 id="_5-1-3-æ•°æ®å‡†å¤‡" tabindex="-1">5.1.3 æ•°æ®å‡†å¤‡ <a class="header-anchor" href="#_5-1-3-æ•°æ®å‡†å¤‡" aria-label="Permalink to â€œ5.1.3 æ•°æ®å‡†å¤‡â€">â€‹</a></h4><h5 id="æ•°æ®ç›®å½•ç»“æ„" tabindex="-1">æ•°æ®ç›®å½•ç»“æ„ <a class="header-anchor" href="#æ•°æ®ç›®å½•ç»“æ„" aria-label="Permalink to â€œæ•°æ®ç›®å½•ç»“æ„â€">â€‹</a></h5><p>HLLM çš„æ•°æ®åº”æŒ‰ä»¥ä¸‹ç›®å½•ç»“æ„æ”¾ç½®ï¼š</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>torch-rechub/</span></span>
<span class="line"><span>â”œâ”€â”€ examples/</span></span>
<span class="line"><span>â”‚   â””â”€â”€ generative/</span></span>
<span class="line"><span>â”‚       â””â”€â”€ data/</span></span>
<span class="line"><span>â”‚           â””â”€â”€ ml-1m/                          # MovieLens-1M æ•°æ®é›†</span></span>
<span class="line"><span>â”‚               â”œâ”€â”€ movies.dat                  # åŸå§‹ç”µå½±å…ƒæ•°æ®ï¼ˆéœ€ä¸‹è½½ï¼‰</span></span>
<span class="line"><span>â”‚               â”œâ”€â”€ ratings.dat                 # åŸå§‹è¯„åˆ†æ•°æ®ï¼ˆéœ€ä¸‹è½½ï¼‰</span></span>
<span class="line"><span>â”‚               â”œâ”€â”€ users.dat                   # åŸå§‹ç”¨æˆ·æ•°æ®ï¼ˆéœ€ä¸‹è½½ï¼‰</span></span>
<span class="line"><span>â”‚               â”œâ”€â”€ processed/                  # é¢„å¤„ç†åçš„æ•°æ®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰</span></span>
<span class="line"><span>â”‚               â”‚   â”œâ”€â”€ vocab.pkl               # è¯è¡¨ï¼ˆHSTU ç”Ÿæˆï¼‰</span></span>
<span class="line"><span>â”‚               â”‚   â”œâ”€â”€ train_data.pkl          # è®­ç»ƒæ•°æ®ï¼ˆHSTU ç”Ÿæˆï¼‰</span></span>
<span class="line"><span>â”‚               â”‚   â”œâ”€â”€ val_data.pkl            # éªŒè¯æ•°æ®ï¼ˆHSTU ç”Ÿæˆï¼‰</span></span>
<span class="line"><span>â”‚               â”‚   â”œâ”€â”€ test_data.pkl           # æµ‹è¯•æ•°æ®ï¼ˆHSTU ç”Ÿæˆï¼‰</span></span>
<span class="line"><span>â”‚               â”‚   â”œâ”€â”€ movie_text_map.pkl      # ç”µå½±æ–‡æœ¬æ˜ å°„ï¼ˆHLLM ç”Ÿæˆï¼‰</span></span>
<span class="line"><span>â”‚               â”‚   â””â”€â”€ item_embeddings_tinyllama.pt  # Item embeddingsï¼ˆHLLM ç”Ÿæˆï¼‰</span></span>
<span class="line"><span>â”‚               â”œâ”€â”€ preprocess_ml_hstu.py       # HSTU æ•°æ®é¢„å¤„ç†è„šæœ¬</span></span>
<span class="line"><span>â”‚               â””â”€â”€ preprocess_hllm_data.py     # HLLM ç»Ÿä¸€é¢„å¤„ç†è„šæœ¬</span></span></code></pre></div><h5 id="æ•°æ®ä¸‹è½½è¯´æ˜" tabindex="-1">æ•°æ®ä¸‹è½½è¯´æ˜ <a class="header-anchor" href="#æ•°æ®ä¸‹è½½è¯´æ˜" aria-label="Permalink to â€œæ•°æ®ä¸‹è½½è¯´æ˜â€">â€‹</a></h5><p><strong>MovieLens-1M æ•°æ®é›†</strong>ï¼š</p><ol><li>è®¿é—®å®˜æ–¹ç½‘ç«™ï¼š<a href="https://grouplens.org/datasets/movielens/1m/" target="_blank" rel="noreferrer">https://grouplens.org/datasets/movielens/1m/</a></li><li>ä¸‹è½½ <code>ml-1m.zip</code> æ–‡ä»¶ï¼ˆçº¦ 5 MBï¼‰</li><li>è§£å‹åˆ° <code>examples/generative/data/ml-1m/</code> ç›®å½•</li><li>éªŒè¯æ–‡ä»¶ç»“æ„ï¼š<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/data/ml-1m/</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åº”è¯¥çœ‹åˆ°ï¼šmovies.dat, ratings.dat, users.dat</span></span></code></pre></div></li></ol><p><strong>æ–‡ä»¶è¯´æ˜</strong>ï¼š</p><ul><li><code>movies.dat</code>ï¼šç”µå½±å…ƒæ•°æ®ï¼ˆID, æ ‡é¢˜, ç±»å‹ï¼‰</li><li><code>ratings.dat</code>ï¼šç”¨æˆ·è¯„åˆ†è®°å½•ï¼ˆç”¨æˆ·ID, ç”µå½±ID, è¯„åˆ†, æ—¶é—´æˆ³ï¼‰</li><li><code>users.dat</code>ï¼šç”¨æˆ·ä¿¡æ¯ï¼ˆç”¨æˆ·ID, æ€§åˆ«, å¹´é¾„, èŒä¸š, é‚®ç¼–ï¼‰</li></ul><p><strong>é¢„å¤„ç†åçš„æ–‡ä»¶</strong>ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€æ‰‹åŠ¨ä¸‹è½½ï¼‰ï¼š</p><ul><li><code>vocab.pkl</code>ï¼šç”µå½± ID è¯è¡¨</li><li><code>train_data.pkl</code>ã€<code>val_data.pkl</code>ã€<code>test_data.pkl</code>ï¼šåºåˆ—æ•°æ®</li><li><code>movie_text_map.pkl</code>ï¼šç”µå½±æ–‡æœ¬æ˜ å°„</li><li><code>item_embeddings_tinyllama.pt</code>ï¼šé¢„è®¡ç®—çš„ item embeddings</li></ul><p><strong>ByteDance å®˜æ–¹æ•°æ®é›†ï¼ˆAmazon Books + PixelRecï¼‰</strong>ï¼š</p><p>æ ¹æ® <a href="https://github.com/bytedance/HLLM" target="_blank" rel="noreferrer">ByteDance HLLM å®˜æ–¹ä»“åº“</a> çš„è¯´æ˜ï¼Œå®˜æ–¹å®ç°ä½¿ç”¨ä»¥ä¸‹æ•°æ®é›†ï¼š</p><ol><li><strong>PixelRec æ•°æ®é›†</strong>ï¼šä» <a href="https://github.com/westlake-repl/PixelRec" target="_blank" rel="noreferrer">PixelRec</a> ä¸‹è½½äº¤äº’æ•°æ®å’Œ Item ä¿¡æ¯</li><li><strong>Amazon Books æ•°æ®é›†</strong>ï¼š <ul><li>äº¤äº’æ•°æ®ï¼š<a href="http://snap.stanford.edu/data/amazon/productGraph/categoryFiles/ratings_Books.csv" target="_blank" rel="noreferrer">ratings_Books.csv</a></li><li>Item ä¿¡æ¯ï¼š<a href="http://snap.stanford.edu/data/amazon/productGraph/categoryFiles/meta_Books.json.gz" target="_blank" rel="noreferrer">meta_Books.json.gz</a></li><li>å®˜æ–¹ä¹Ÿæä¾›å¤„ç†åçš„æ•°æ®ï¼š<a href="https://huggingface.co/ByteDance/HLLM/resolve/main/Interactions/amazon_books.csv" target="_blank" rel="noreferrer">Interactions</a> å’Œ <a href="https://huggingface.co/ByteDance/HLLM/resolve/main/ItemInformation/amazon_books.csv" target="_blank" rel="noreferrer">Item Information</a></li></ul></li></ol><p><strong>å®˜æ–¹æ•°æ®ç›®å½•ç»“æ„</strong>ï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">â”œâ”€â”€</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dataset</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # å­˜æ”¾äº¤äº’æ•°æ® (data_path)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">â”‚</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   â”œâ”€â”€</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amazon_books.csv</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">â”‚</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   â”œâ”€â”€</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Pixel1M.csv</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">â”‚</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   â”œâ”€â”€</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Pixel200K.csv</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">â”‚</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   â””â”€â”€</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Pixel8M.csv</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">â””â”€â”€</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> information</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # å­˜æ”¾ Item ä¿¡æ¯ (text_path)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    â”œâ”€â”€</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amazon_books.csv</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    â”œâ”€â”€</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Pixel1M.csv</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    â”œâ”€â”€</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Pixel200K.csv</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    â””â”€â”€</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Pixel8M.csv</span></span></code></pre></div><blockquote><p><strong>æ³¨æ„</strong>ï¼šæœ¬å®ç°ä½¿ç”¨ <strong>Amazon Beauty</strong> æ•°æ®é›†ä½œä¸ºæ‰©å±•ç¤ºä¾‹ï¼Œä¸å®˜æ–¹çš„ Amazon Books æ•°æ®é›†ä¸åŒã€‚å¦‚éœ€å®Œå…¨å¤ç°å®˜æ–¹ç»“æœï¼Œè¯·ä½¿ç”¨ä¸Šè¿°å®˜æ–¹æ•°æ®é›†ã€‚</p></blockquote><p><strong>Amazon Beauty æ•°æ®é›†ï¼ˆæœ¬å®ç°æ‰©å±•ï¼‰</strong>ï¼š</p><ol><li>è®¿é—®å®˜æ–¹ç½‘ç«™ï¼š<a href="http://jmcauley.ucsd.edu/data/amazon/" target="_blank" rel="noreferrer">http://jmcauley.ucsd.edu/data/amazon/</a></li><li>ä¸‹è½½ä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶ï¼š <ul><li><code>reviews_Beauty_5.json.gz</code>ï¼ˆ~200MBï¼‰</li><li><code>meta_Beauty.json.gz</code>ï¼ˆ~50MBï¼‰</li></ul></li><li>è§£å‹åˆ° <code>examples/generative/data/amazon-beauty/</code> ç›®å½•</li><li>éªŒè¯æ–‡ä»¶ç»“æ„ï¼š<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/data/amazon-beauty/</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åº”è¯¥çœ‹åˆ°ï¼šreviews_Beauty_5.json, meta_Beauty.json</span></span></code></pre></div></li></ol><p><strong>æ–‡ä»¶è¯´æ˜</strong>ï¼š</p><ul><li><code>reviews_Beauty_5.json</code>ï¼šç”¨æˆ·è¯„è®ºè®°å½•ï¼ˆç”¨æˆ·ID, äº§å“ID, è¯„åˆ†, æ—¶é—´æˆ³ç­‰ï¼‰</li><li><code>meta_Beauty.json</code>ï¼šäº§å“å…ƒæ•°æ®ï¼ˆäº§å“ID, æ ‡é¢˜, æè¿°, ç±»åˆ«ç­‰ï¼‰</li></ul><p><strong>é¢„å¤„ç†åçš„æ–‡ä»¶</strong>ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€æ‰‹åŠ¨ä¸‹è½½ï¼‰ï¼š</p><ul><li><code>vocab.pkl</code>ï¼šäº§å“ ID è¯è¡¨</li><li><code>train_data.pkl</code>ã€<code>val_data.pkl</code>ã€<code>test_data.pkl</code>ï¼šåºåˆ—æ•°æ®</li><li><code>item_text_map.pkl</code>ï¼šäº§å“æ–‡æœ¬æ˜ å°„</li><li><code>item_embeddings_tinyllama.pt</code>ï¼šé¢„è®¡ç®—çš„ item embeddings</li></ul><p><strong>é¢„è®­ç»ƒ LLM æ¨¡å‹</strong>ï¼š</p><p>å®˜æ–¹æ¨èçš„ LLM æ¨¡å‹åŒ…æ‹¬ï¼š</p><ul><li><a href="https://github.com/jzhang38/TinyLlama" target="_blank" rel="noreferrer">TinyLlama</a>ï¼ˆæœ¬å®ç°æ”¯æŒï¼‰</li><li><a href="https://huggingface.co/baichuan-inc/Baichuan2-7B-Base" target="_blank" rel="noreferrer">Baichuan2</a>ï¼ˆæœ¬å®ç°æ”¯æŒï¼‰</li><li>Llama-2ã€Qwen ç­‰ï¼ˆå¯æŒ‰éœ€æ‰©å±•ï¼‰</li></ul><h3 id="_5-2-å¿«é€Ÿå¼€å§‹-3-æ­¥-æ¨èæ–¹å¼" tabindex="-1">5.2 å¿«é€Ÿå¼€å§‹ï¼ˆ3 æ­¥ï¼‰- æ¨èæ–¹å¼ <a class="header-anchor" href="#_5-2-å¿«é€Ÿå¼€å§‹-3-æ­¥-æ¨èæ–¹å¼" aria-label="Permalink to â€œ5.2 å¿«é€Ÿå¼€å§‹ï¼ˆ3 æ­¥ï¼‰- æ¨èæ–¹å¼â€">â€‹</a></h3><p>ä½¿ç”¨ç»Ÿä¸€çš„æ•°æ®é¢„å¤„ç†è„šæœ¬ <code>preprocess_hllm_data.py</code>ï¼ˆåŒ…å«æ–‡æœ¬æå– + embedding ç”Ÿæˆï¼‰ï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. è¿›å…¥æ•°æ®ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/data/ml-1m</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. é¢„å¤„ç† MovieLens-1M æ•°æ®ï¼ˆHSTU æ ¼å¼ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preprocess_ml_hstu.py</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. ç»Ÿä¸€æ•°æ®é¢„å¤„ç†ï¼ˆæ–‡æœ¬æå– + embedding ç”Ÿæˆï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é€‰é¡¹ Aï¼šTinyLlama-1.1Bï¼ˆæ¨èï¼Œ2GB GPUï¼Œ~10 åˆ†é’Ÿï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preprocess_hllm_data.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --model_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tinyllama</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cuda</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é€‰é¡¹ Bï¼šBaichuan2-7Bï¼ˆæ›´å¤§ï¼Œ14GB GPUï¼Œ~30 åˆ†é’Ÿï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># python preprocess_hllm_data.py --model_type baichuan2 --device cuda</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. è¿”å›é¡¹ç›®æ ¹ç›®å½•å¹¶è®­ç»ƒæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../../../</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/run_hllm_movielens.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --model_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tinyllama</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --epoch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --batch_size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 512</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cuda</span></span></code></pre></div><p><strong>é¢„æœŸæ—¶é—´</strong>ï¼š~40 åˆ†é’Ÿï¼ˆåŒ…æ‹¬ HSTU é¢„å¤„ç†ã€HLLM æ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒï¼‰</p><h3 id="_5-3-è¯¦ç»†æ­¥éª¤è¯´æ˜" tabindex="-1">5.3 è¯¦ç»†æ­¥éª¤è¯´æ˜ <a class="header-anchor" href="#_5-3-è¯¦ç»†æ­¥éª¤è¯´æ˜" aria-label="Permalink to â€œ5.3 è¯¦ç»†æ­¥éª¤è¯´æ˜â€">â€‹</a></h3><h4 id="æ­¥éª¤-1-æ•°æ®é¢„å¤„ç†-hstu-æ ¼å¼" tabindex="-1">æ­¥éª¤ 1ï¼šæ•°æ®é¢„å¤„ç†ï¼ˆHSTU æ ¼å¼ï¼‰ <a class="header-anchor" href="#æ­¥éª¤-1-æ•°æ®é¢„å¤„ç†-hstu-æ ¼å¼" aria-label="Permalink to â€œæ­¥éª¤ 1ï¼šæ•°æ®é¢„å¤„ç†ï¼ˆHSTU æ ¼å¼ï¼‰â€">â€‹</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preprocess_ml_hstu.py</span></span></code></pre></div><p><strong>è¾“å‡ºæ–‡ä»¶</strong>ï¼š</p><ul><li><code>data/ml-1m/processed/seq_tokens.pkl</code></li><li><code>data/ml-1m/processed/seq_positions.pkl</code></li><li><code>data/ml-1m/processed/seq_time_diffs.pkl</code></li><li><code>data/ml-1m/processed/targets.pkl</code></li></ul><h4 id="æ­¥éª¤-2-ç»Ÿä¸€-hllm-æ•°æ®é¢„å¤„ç†-æ¨è" tabindex="-1">æ­¥éª¤ 2ï¼šç»Ÿä¸€ HLLM æ•°æ®é¢„å¤„ç†ï¼ˆæ¨èï¼‰ <a class="header-anchor" href="#æ­¥éª¤-2-ç»Ÿä¸€-hllm-æ•°æ®é¢„å¤„ç†-æ¨è" aria-label="Permalink to â€œæ­¥éª¤ 2ï¼šç»Ÿä¸€ HLLM æ•°æ®é¢„å¤„ç†ï¼ˆæ¨èï¼‰â€">â€‹</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸€æ¡å‘½ä»¤å®Œæˆæ–‡æœ¬æå– + embedding ç”Ÿæˆ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preprocess_hllm_data.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --model_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tinyllama</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cuda</span></span></code></pre></div><p><strong>åŠŸèƒ½</strong>ï¼š</p><ol><li>ä» <code>movies.dat</code> æå–ç”µå½±æ–‡æœ¬ï¼ˆtitle + genresï¼‰</li><li>ä½¿ç”¨ LLM ç”Ÿæˆ item embeddings</li><li>ä¿å­˜æ‰€æœ‰å¿…éœ€çš„è¾“å‡ºæ–‡ä»¶</li></ol><p><strong>è¾“å‡ºæ–‡ä»¶</strong>ï¼š</p><ul><li><code>data/ml-1m/processed/movie_text_map.pkl</code>ï¼ˆç”µå½± ID â†’ æ–‡æœ¬æè¿°ï¼‰</li><li><code>data/ml-1m/processed/item_embeddings_tinyllama.pt</code>ï¼ˆitem embeddingsï¼‰</li></ul><p><strong>ç¯å¢ƒæ£€æŸ¥</strong>ï¼ˆè„šæœ¬è‡ªåŠ¨æ‰§è¡Œï¼‰ï¼š</p><ul><li>âœ… GPU/CUDA å¯ç”¨æ€§æ£€æŸ¥</li><li>âœ… æ˜¾å­˜å……è¶³æ€§æ£€æŸ¥</li><li>âœ… æ¨¡å‹ç¼“å­˜æ£€æŸ¥ï¼ˆè¯¦ç»†çš„ç¼“å­˜è·¯å¾„è°ƒè¯•ä¿¡æ¯ï¼‰</li></ul><h4 id="æ­¥éª¤-2-æ›¿ä»£æ–¹æ¡ˆ-åˆ†æ­¥-hllm-æ•°æ®é¢„å¤„ç†" tabindex="-1">æ­¥éª¤ 2 (æ›¿ä»£æ–¹æ¡ˆ)ï¼šåˆ†æ­¥ HLLM æ•°æ®é¢„å¤„ç† <a class="header-anchor" href="#æ­¥éª¤-2-æ›¿ä»£æ–¹æ¡ˆ-åˆ†æ­¥-hllm-æ•°æ®é¢„å¤„ç†" aria-label="Permalink to â€œæ­¥éª¤ 2 (æ›¿ä»£æ–¹æ¡ˆ)ï¼šåˆ†æ­¥ HLLM æ•°æ®é¢„å¤„ç†â€">â€‹</a></h4><p><strong>æ¨èä½¿ç”¨ç»Ÿä¸€è„šæœ¬</strong>ï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/data/ml-1m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preprocess_hllm_data.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --model_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tinyllama</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cuda</span></span></code></pre></div><p><strong>è¾“å‡ºæ–‡ä»¶</strong>ï¼š</p><ul><li><code>data/ml-1m/processed/item_embeddings_tinyllama.pt</code></li></ul><h4 id="æ­¥éª¤-3-è®­ç»ƒ-hllm-æ¨¡å‹" tabindex="-1">æ­¥éª¤ 3ï¼šè®­ç»ƒ HLLM æ¨¡å‹ <a class="header-anchor" href="#æ­¥éª¤-3-è®­ç»ƒ-hllm-æ¨¡å‹" aria-label="Permalink to â€œæ­¥éª¤ 3ï¼šè®­ç»ƒ HLLM æ¨¡å‹â€">â€‹</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../../../</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/run_hllm_movielens.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --model_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tinyllama</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --epoch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --batch_size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 512</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --learning_rate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1e-3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --weight_decay</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1e-5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --max_seq_len</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cuda</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --seed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span></span></code></pre></div><p><strong>ç¯å¢ƒæ£€æŸ¥</strong>ï¼ˆè„šæœ¬è‡ªåŠ¨æ‰§è¡Œï¼‰ï¼š</p><ul><li>âœ… GPU/CUDA å¯ç”¨æ€§æ£€æŸ¥</li><li>âœ… æ˜¾å­˜å……è¶³æ€§æ£€æŸ¥</li><li>âœ… Item embeddings æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥</li></ul><p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p><ul><li><code>--model_type</code>ï¼šLLM æ¨¡å‹ç±»å‹ï¼ˆtinyllama æˆ– baichuan2ï¼‰</li><li><code>--epoch</code>ï¼šè®­ç»ƒè½®æ•°ï¼ˆé»˜è®¤ 10ï¼‰</li><li><code>--batch_size</code>ï¼šæ‰¹å¤§å°ï¼ˆé»˜è®¤ 64ï¼‰</li><li><code>--learning_rate</code>ï¼šå­¦ä¹ ç‡ï¼ˆé»˜è®¤ 1e-3ï¼‰</li><li><code>--weight_decay</code>ï¼šL2 æ­£åˆ™åŒ–ï¼ˆé»˜è®¤ 1e-5ï¼‰</li><li><code>--max_seq_len</code>ï¼šæœ€å¤§åºåˆ—é•¿åº¦ï¼ˆé»˜è®¤ 200ï¼‰</li><li><code>--device</code>ï¼šè®¡ç®—è®¾å¤‡ï¼ˆcuda æˆ– cpuï¼‰</li><li><code>--seed</code>ï¼šéšæœºç§å­ï¼ˆé»˜è®¤ 2022ï¼‰</li><li><code>--loss_type</code>ï¼šæŸå¤±å‡½æ•°ç±»å‹ï¼ˆcross_entropy æˆ– nceï¼Œé»˜è®¤ nceï¼‰ <ul><li><code>cross_entropy</code>ï¼šæ ‡å‡†äº¤å‰ç†µæŸå¤±</li><li><code>nce</code>ï¼šå™ªå£°å¯¹æ¯”ä¼°è®¡æŸå¤±ï¼ˆæ¨èï¼Œè®­ç»ƒæ•ˆç‡æ›´é«˜ï¼‰</li></ul></li></ul><h3 id="_5-4-amazon-books-æ•°æ®é›†-å®˜æ–¹é»˜è®¤" tabindex="-1">5.4 Amazon Books æ•°æ®é›†ï¼ˆå®˜æ–¹é»˜è®¤ï¼‰ <a class="header-anchor" href="#_5-4-amazon-books-æ•°æ®é›†-å®˜æ–¹é»˜è®¤" aria-label="Permalink to â€œ5.4 Amazon Books æ•°æ®é›†ï¼ˆå®˜æ–¹é»˜è®¤ï¼‰â€">â€‹</a></h3><p>å¦‚æœè¦åœ¨ Amazon Books æ•°æ®é›†ä¸Šè®­ç»ƒ HLLMï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œã€‚è¿™æ˜¯ ByteDance å®˜æ–¹ HLLM ä½¿ç”¨çš„é»˜è®¤æ•°æ®é›†ã€‚</p><h4 id="æ•°æ®é›†æ¦‚è¿°" tabindex="-1">æ•°æ®é›†æ¦‚è¿° <a class="header-anchor" href="#æ•°æ®é›†æ¦‚è¿°" aria-label="Permalink to â€œæ•°æ®é›†æ¦‚è¿°â€">â€‹</a></h4><p>Amazon Books æ•°æ®é›†åŒ…å«ä¹¦ç±äº§å“çš„ç”¨æˆ·è¯„åˆ†å’Œå…ƒæ•°æ®ï¼Œæ˜¯ HLLM è®ºæ–‡ä¸­ä½¿ç”¨çš„å®˜æ–¹åŸºå‡†æ•°æ®é›†ã€‚</p><p><strong>æ•°æ®é›†ç»Ÿè®¡</strong>ï¼ˆè¿‡æ»¤åï¼‰ï¼š</p><ul><li>äº¤äº’æ•°ï¼š~8M</li><li>äº§å“æ•°ï¼š~370K</li><li>ç”¨æˆ·æ•°ï¼š~600K</li><li>æ—¶é—´è·¨åº¦ï¼š1996-2014</li></ul><h4 id="æ­¥éª¤-1-ä¸‹è½½æ•°æ®" tabindex="-1">æ­¥éª¤ 1ï¼šä¸‹è½½æ•°æ® <a class="header-anchor" href="#æ­¥éª¤-1-ä¸‹è½½æ•°æ®" aria-label="Permalink to â€œæ­¥éª¤ 1ï¼šä¸‹è½½æ•°æ®â€">â€‹</a></h4><p><strong>æ–¹å¼ 1ï¼šä¸‹è½½åŸå§‹æ•°æ®</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/data/amazon-books</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸‹è½½äº¤äº’æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://snap.stanford.edu/data/amazon/productGraph/categoryFiles/ratings_Books.csv</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸‹è½½å…ƒæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://snap.stanford.edu/data/amazon/productGraph/categoryFiles/meta_Books.json.gz</span></span></code></pre></div><p><strong>æ–¹å¼ 2ï¼šä¸‹è½½ ByteDance å¤„ç†åçš„æ•°æ®</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># äº¤äº’æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://huggingface.co/ByteDance/HLLM/resolve/main/Interactions/amazon_books.csv</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Item ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://huggingface.co/ByteDance/HLLM/resolve/main/ItemInformation/amazon_books.csv</span></span></code></pre></div><p><strong>æ–‡ä»¶è¯´æ˜</strong>ï¼š</p><ul><li><code>ratings_Books.csv</code>ï¼šCSV æ ¼å¼ï¼ŒåŒ…å« user_id, item_id, rating, timestamp</li><li><code>meta_Books.json.gz</code>ï¼šJSON Lines æ ¼å¼ï¼ŒåŒ…å« asin, title, description</li></ul><h4 id="æ­¥éª¤-2-é¢„å¤„ç†æ•°æ®" tabindex="-1">æ­¥éª¤ 2ï¼šé¢„å¤„ç†æ•°æ® <a class="header-anchor" href="#æ­¥éª¤-2-é¢„å¤„ç†æ•°æ®" aria-label="Permalink to â€œæ­¥éª¤ 2ï¼šé¢„å¤„ç†æ•°æ®â€">â€‹</a></h4><p><strong>2.1 ç”Ÿæˆ HSTU æ ¼å¼çš„åºåˆ—æ•°æ®</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preprocess_amazon_books.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --data_dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --output_dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --max_seq_len</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --min_seq_len</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span></code></pre></div><p><strong>è¾“å‡ºæ–‡ä»¶</strong>ï¼š</p><ul><li><code>vocab.pkl</code> - äº§å“ ID è¯è¡¨</li><li><code>train_data.pkl</code> - è®­ç»ƒåºåˆ—</li><li><code>val_data.pkl</code> - éªŒè¯åºåˆ—</li><li><code>test_data.pkl</code> - æµ‹è¯•åºåˆ—</li></ul><p><strong>æ•°æ®æ ¼å¼</strong>ï¼šæ¯ä¸ªæ•°æ®æ–‡ä»¶åŒ…å«ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«ä»¥ä¸‹åˆ—è¡¨ï¼š</p><ul><li><code>seq_tokens</code>ï¼šåºåˆ—ä¸­çš„äº§å“ ID</li><li><code>seq_positions</code>ï¼šä½ç½®ç´¢å¼•</li><li><code>seq_time_diffs</code>ï¼šä¸æŸ¥è¯¢æ—¶é—´çš„æ—¶é—´å·®ï¼ˆç§’ï¼‰</li><li><code>targets</code>ï¼šç›®æ ‡äº§å“ ID</li></ul><p><strong>2.2 ç”Ÿæˆ HLLM æ•°æ®ï¼ˆæ–‡æœ¬æå– + embedding ç”Ÿæˆï¼‰</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preprocess_amazon_books_hllm.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --data_dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --output_dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --model_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tinyllama</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cuda</span></span></code></pre></div><p><strong>æ”¯æŒçš„ LLM æ¨¡å‹</strong>ï¼š</p><ul><li><code>tinyllama</code>ï¼šTinyLlama-1.1Bï¼ˆæ¨èï¼Œ~3GB æ˜¾å­˜ï¼‰</li><li><code>baichuan2</code>ï¼šBaichuan2-7Bï¼ˆæ›´å¤§ï¼Œ~14GB æ˜¾å­˜ï¼‰</li></ul><p><strong>è¾“å‡ºæ–‡ä»¶</strong>ï¼š</p><ul><li><code>item_text_map.pkl</code> - äº§å“ ID åˆ°æ–‡æœ¬æè¿°çš„æ˜ å°„</li><li><code>item_embeddings_tinyllama.pt</code> æˆ– <code>item_embeddings_baichuan2.pt</code> - é¢„è®¡ç®—çš„ item embeddings</li></ul><p><strong>Item æ–‡æœ¬æ ¼å¼</strong>ï¼ˆéµå¾ªå®˜æ–¹ ByteDance HLLM æ ¼å¼ï¼‰ï¼š</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>&quot;Compress the following sentence into embedding: title: {title}description: {description}&quot;</span></span></code></pre></div><p><strong>æ ¼å¼è¯´æ˜</strong>ï¼š</p><ul><li>ä½¿ç”¨å®˜æ–¹ <code>item_prompt</code> å‰ç¼€</li><li>ä½¿ç”¨ <code>key: value</code> æ ¼å¼ï¼Œå­—æ®µä¹‹é—´æ— åˆ†éš”ç¬¦</li><li>ä½¿ç”¨æœ€åä¸€ä¸ª token çš„éšè—çŠ¶æ€ä½œä¸º embedding</li></ul><h4 id="æ­¥éª¤-3-è®­ç»ƒæ¨¡å‹" tabindex="-1">æ­¥éª¤ 3ï¼šè®­ç»ƒæ¨¡å‹ <a class="header-anchor" href="#æ­¥éª¤-3-è®­ç»ƒæ¨¡å‹" aria-label="Permalink to â€œæ­¥éª¤ 3ï¼šè®­ç»ƒæ¨¡å‹â€">â€‹</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../../../</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/run_hllm_amazon_books.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --model_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tinyllama</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --batch_size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 64</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --epochs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cuda</span></span></code></pre></div><p><strong>é«˜çº§é€‰é¡¹</strong>ï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/generative/run_hllm_amazon_books.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --model_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> baichuan2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --batch_size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 32</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --epochs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --learning_rate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1e-3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --n_layers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --dropout</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --max_seq_len</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cuda</span></span></code></pre></div><p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p><ul><li><code>--model_type</code>ï¼šLLM æ¨¡å‹ç±»å‹ï¼ˆtinyllama æˆ– baichuan2ï¼‰ï¼Œå†³å®šä½¿ç”¨å“ªä¸ª item embeddings æ–‡ä»¶</li><li><code>--batch_size</code>ï¼šæ‰¹å¤§å°ï¼ˆé»˜è®¤ 64ï¼‰</li><li><code>--epochs</code>ï¼šè®­ç»ƒè½®æ•°ï¼ˆé»˜è®¤ 5ï¼‰</li><li><code>--learning_rate</code>ï¼šå­¦ä¹ ç‡ï¼ˆé»˜è®¤ 1e-3ï¼‰</li><li><code>--n_layers</code>ï¼šTransformer å±‚æ•°ï¼ˆé»˜è®¤ 2ï¼‰</li><li><code>--dropout</code>ï¼šDropout æ¯”ç‡ï¼ˆé»˜è®¤ 0.1ï¼‰</li><li><code>--max_seq_len</code>ï¼šæœ€å¤§åºåˆ—é•¿åº¦ï¼ˆé»˜è®¤ 200ï¼‰</li><li><code>--loss_type</code>ï¼šæŸå¤±å‡½æ•°ç±»å‹ï¼ˆ<code>nce</code> æˆ– <code>cross_entropy</code>ï¼Œé»˜è®¤ <code>nce</code>ï¼‰</li><li><code>--device</code>ï¼šè®¡ç®—è®¾å¤‡ï¼ˆcuda æˆ– cpuï¼‰</li></ul><p><strong>å®˜æ–¹é…ç½®å‚è€ƒ</strong>ï¼š</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ByteDance HLLM å®˜æ–¹é»˜è®¤é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DEFAULT_CONFIG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;MAX_ITEM_LIST_LENGTH&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æœ€å¤§åºåˆ—é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;MAX_TEXT_LENGTH&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æœ€å¤§æ–‡æœ¬é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;item_emb_token_n&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Item embedding token æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;loss&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;nce&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æŸå¤±å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;num_negatives&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è´Ÿé‡‡æ ·æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;learning_rate&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å­¦ä¹ ç‡</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;weight_decay&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æƒé‡è¡°å‡</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;epochs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,                    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®­ç»ƒè½®æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>é¢„æœŸæ—¶é—´</strong>ï¼š</p><ul><li>æ•°æ®é¢„å¤„ç†ï¼š~60-120 åˆ†é’Ÿï¼ˆæ•°æ®é‡è¾ƒå¤§ï¼‰</li><li>æ¨¡å‹è®­ç»ƒï¼ˆ5 ä¸ª epochï¼‰ï¼š~150-200 åˆ†é’Ÿ</li><li>æ€»è®¡ï¼š~3-5 å°æ—¶</li></ul><p><strong>æ€§èƒ½å‚è€ƒ</strong>ï¼š</p><ul><li>HSTU é¢„å¤„ç†ï¼š~10-20 åˆ†é’Ÿ</li><li>HLLM é¢„å¤„ç†ï¼ˆTinyLlamaï¼‰ï¼š~60-90 åˆ†é’Ÿ</li><li>HLLM é¢„å¤„ç†ï¼ˆBaichuan2ï¼‰ï¼š~120-180 åˆ†é’Ÿ</li><li>è®­ç»ƒæ—¶é—´ï¼ˆTinyLlamaï¼‰ï¼š~30-40 åˆ†é’Ÿ/epoch</li><li>è®­ç»ƒæ—¶é—´ï¼ˆBaichuan2ï¼‰ï¼š~60-80 åˆ†é’Ÿ/epoch</li></ul><h3 id="_5-5-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" tabindex="-1">5.5 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ <a class="header-anchor" href="#_5-5-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" aria-label="Permalink to â€œ5.5 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆâ€">â€‹</a></h3><h4 id="q1-gpu-å†…å­˜ä¸è¶³" tabindex="-1">Q1ï¼šGPU å†…å­˜ä¸è¶³ <a class="header-anchor" href="#q1-gpu-å†…å­˜ä¸è¶³" aria-label="Permalink to â€œQ1ï¼šGPU å†…å­˜ä¸è¶³â€">â€‹</a></h4><p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š<code>RuntimeError: CUDA out of memory</code></p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ol><li>å‡å° batch_sizeï¼š<code>--batch_size 256</code> æˆ– <code>--batch_size 128</code></li><li>ä½¿ç”¨æ›´å°çš„ LLM æ¨¡å‹ï¼š<code>--model_type tinyllama</code></li><li>å‡å° max_seq_lenï¼š<code>--max_seq_len 100</code></li><li>ä½¿ç”¨ CPUï¼š<code>--device cpu</code>ï¼ˆé€Ÿåº¦ä¼šå¾ˆæ…¢ï¼‰</li></ol><h4 id="q2-æ¨¡å‹ä¸‹è½½å¤±è´¥" tabindex="-1">Q2ï¼šæ¨¡å‹ä¸‹è½½å¤±è´¥ <a class="header-anchor" href="#q2-æ¨¡å‹ä¸‹è½½å¤±è´¥" aria-label="Permalink to â€œQ2ï¼šæ¨¡å‹ä¸‹è½½å¤±è´¥â€">â€‹</a></h4><p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š<code>Connection error</code> æˆ– <code>Model not found</code></p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ol><li>æ£€æŸ¥ç½‘ç»œè¿æ¥</li><li>è®¾ç½® HuggingFace é•œåƒï¼š<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HF_ENDPOINT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">https://huggingface.co</span></span></code></pre></div></li><li>æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹ï¼š<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ huggingface-cli</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">huggingface-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> download</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TinyLlama/TinyLlama-1.1B-Chat-v1.0</span></span></code></pre></div></li></ol><h4 id="q3-æ•°æ®æ–‡ä»¶æœªæ‰¾åˆ°" tabindex="-1">Q3ï¼šæ•°æ®æ–‡ä»¶æœªæ‰¾åˆ° <a class="header-anchor" href="#q3-æ•°æ®æ–‡ä»¶æœªæ‰¾åˆ°" aria-label="Permalink to â€œQ3ï¼šæ•°æ®æ–‡ä»¶æœªæ‰¾åˆ°â€">â€‹</a></h4><p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š<code>FileNotFoundError: movies.dat not found</code></p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ol><li>ç¡®ä¿ MovieLens-1M æ•°æ®å·²ä¸‹è½½åˆ° <code>examples/generative/data/ml-1m/data/ml-1m/</code></li><li>æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦æ­£ç¡®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</li><li>è¿è¡Œ <code>preprocess_ml_hstu.py</code> ç”Ÿæˆå¿…è¦çš„ä¸­é—´æ–‡ä»¶</li></ol><h4 id="q4-item-embeddings-æ–‡ä»¶ä¸å­˜åœ¨" tabindex="-1">Q4ï¼šItem embeddings æ–‡ä»¶ä¸å­˜åœ¨ <a class="header-anchor" href="#q4-item-embeddings-æ–‡ä»¶ä¸å­˜åœ¨" aria-label="Permalink to â€œQ4ï¼šItem embeddings æ–‡ä»¶ä¸å­˜åœ¨â€">â€‹</a></h4><p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š<code>FileNotFoundError: item_embeddings_tinyllama.pt not found</code></p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ol><li>ç¡®ä¿å·²è¿è¡Œ <code>preprocess_hllm_data.py</code></li><li>æ£€æŸ¥è¾“å‡ºç›®å½•æ˜¯å¦æ­£ç¡®ï¼š<code>examples/generative/data/ml-1m/processed/</code></li><li>ç¡®ä¿ <code>--model_type</code> å‚æ•°ä¸ç”Ÿæˆçš„æ–‡ä»¶åä¸€è‡´</li></ol><h4 id="q5-è®­ç»ƒé€Ÿåº¦å¾ˆæ…¢" tabindex="-1">Q5ï¼šè®­ç»ƒé€Ÿåº¦å¾ˆæ…¢ <a class="header-anchor" href="#q5-è®­ç»ƒé€Ÿåº¦å¾ˆæ…¢" aria-label="Permalink to â€œQ5ï¼šè®­ç»ƒé€Ÿåº¦å¾ˆæ…¢â€">â€‹</a></h4><p><strong>åŸå› </strong>ï¼š</p><ul><li>ä½¿ç”¨äº† CPU è€Œé GPU</li><li>GPU æ˜¾å­˜ä¸è¶³ï¼Œé¢‘ç¹è¿›è¡Œå†…å­˜äº¤æ¢</li><li>Batch size è¿‡å°</li></ul><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ol><li>ç¡®ä¿ä½¿ç”¨ GPUï¼š<code>--device cuda</code></li><li>å¢åŠ  batch_sizeï¼š<code>--batch_size 1024</code>ï¼ˆå¦‚æœæ˜¾å­˜å…è®¸ï¼‰</li><li>æ£€æŸ¥ GPU åˆ©ç”¨ç‡ï¼š<code>nvidia-smi</code></li></ol><h4 id="q6-è¯„ä¼°æŒ‡æ ‡å¾ˆä½" tabindex="-1">Q6ï¼šè¯„ä¼°æŒ‡æ ‡å¾ˆä½ <a class="header-anchor" href="#q6-è¯„ä¼°æŒ‡æ ‡å¾ˆä½" aria-label="Permalink to â€œQ6ï¼šè¯„ä¼°æŒ‡æ ‡å¾ˆä½â€">â€‹</a></h4><p><strong>åŸå› </strong>ï¼š</p><ul><li>è®­ç»ƒè½®æ•°ä¸è¶³</li><li>å­¦ä¹ ç‡è®¾ç½®ä¸å½“</li><li>æ¨¡å‹å®¹é‡ä¸è¶³</li></ul><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ol><li>å¢åŠ è®­ç»ƒè½®æ•°ï¼š<code>--epoch 10</code> æˆ– <code>--epoch 20</code></li><li>è°ƒæ•´å­¦ä¹ ç‡ï¼š<code>--learning_rate 5e-4</code> æˆ– <code>--learning_rate 1e-4</code></li><li>ä½¿ç”¨æ›´å¤§çš„ LLM æ¨¡å‹ï¼š<code>--model_type baichuan2</code></li></ol><h3 id="_5-5-åˆ‡æ¢-llm-æ¨¡å‹" tabindex="-1">5.5 åˆ‡æ¢ LLM æ¨¡å‹ <a class="header-anchor" href="#_5-5-åˆ‡æ¢-llm-æ¨¡å‹" aria-label="Permalink to â€œ5.5 åˆ‡æ¢ LLM æ¨¡å‹â€">â€‹</a></h3><p>åœ¨ <code>run_hllm_movielens.py</code> ä¸­ä¿®æ”¹ <code>--model_type</code> å‚æ•°ï¼š</p><ul><li><code>--model_type tinyllama</code>ï¼šä½¿ç”¨ TinyLlama-1.1Bï¼ˆæ¨èç”¨äº GPU å†…å­˜æœ‰é™çš„åœºæ™¯ï¼‰</li><li><code>--model_type baichuan2</code>ï¼šä½¿ç”¨ Baichuan2-7Bï¼ˆæ›´å¤§çš„æ¨¡å‹ï¼Œæ•ˆæœå¯èƒ½æ›´å¥½ï¼‰</li></ul><p><strong>æ³¨æ„</strong>ï¼šå¿…é¡»å…ˆè¿è¡Œ <code>preprocess_hllm_data.py</code> ç”Ÿæˆç›¸åº”çš„ embeddings æ–‡ä»¶</p><hr><h2 id="_6-ä¸-bytedance-å®˜æ–¹å®ç°çš„ä¸€è‡´æ€§ä¸å·®å¼‚" tabindex="-1">6. ä¸ ByteDance å®˜æ–¹å®ç°çš„ä¸€è‡´æ€§ä¸å·®å¼‚ <a class="header-anchor" href="#_6-ä¸-bytedance-å®˜æ–¹å®ç°çš„ä¸€è‡´æ€§ä¸å·®å¼‚" aria-label="Permalink to â€œ6. ä¸ ByteDance å®˜æ–¹å®ç°çš„ä¸€è‡´æ€§ä¸å·®å¼‚â€">â€‹</a></h2><h3 id="_6-1-å®Œå…¨å¯¹é½çš„éƒ¨åˆ†-100-ä¸€è‡´-âœ…" tabindex="-1">6.1 å®Œå…¨å¯¹é½çš„éƒ¨åˆ†ï¼ˆ100% ä¸€è‡´ï¼‰âœ… <a class="header-anchor" href="#_6-1-å®Œå…¨å¯¹é½çš„éƒ¨åˆ†-100-ä¸€è‡´-âœ…" aria-label="Permalink to â€œ6.1 å®Œå…¨å¯¹é½çš„éƒ¨åˆ†ï¼ˆ100% ä¸€è‡´ï¼‰âœ…â€">â€‹</a></h3><h4 id="æ¨¡å‹æ¶æ„" tabindex="-1">æ¨¡å‹æ¶æ„ <a class="header-anchor" href="#æ¨¡å‹æ¶æ„" aria-label="Permalink to â€œæ¨¡å‹æ¶æ„â€">â€‹</a></h4><ul><li>âœ… <strong>ä¸¤çº§ç»“æ„</strong>ï¼šItem LLM ç¦»çº¿ç”Ÿæˆ embeddingsï¼ŒUser LLM åœ¨çº¿å»ºæ¨¡åºåˆ—</li><li>âœ… <strong>Transformer Block</strong>ï¼šå¤šå¤´è‡ªæ³¨æ„åŠ› + FFNï¼Œå‰ç½®å½’ä¸€åŒ–ï¼Œæ®‹å·®è¿æ¥</li><li>âœ… <strong>å› æœæ©ç </strong>ï¼šä½ç½® i åªèƒ½ attend åˆ°ä½ç½® â‰¤ i</li><li>âœ… <strong>Scoring Head</strong>ï¼šç‚¹ç§¯ + æ¸©åº¦ç¼©æ”¾è®¡ç®— logits</li></ul><h4 id="ä½ç½®å’Œæ—¶é—´ç¼–ç " tabindex="-1">ä½ç½®å’Œæ—¶é—´ç¼–ç  <a class="header-anchor" href="#ä½ç½®å’Œæ—¶é—´ç¼–ç " aria-label="Permalink to â€œä½ç½®å’Œæ—¶é—´ç¼–ç â€">â€‹</a></h4><ul><li>âœ… <strong>ä½ç½®ç¼–ç </strong>ï¼šç»å¯¹ä½ç½®ç¼–ç  <code>nn.Embedding(max_seq_len, d_model)</code></li><li>âœ… <strong>æ—¶é—´ç¼–ç </strong>ï¼šæ—¶é—´å·®è½¬æ¢ä¸ºåˆ†é’Ÿï¼Œä½¿ç”¨ sqrt/log bucket åŒ–</li><li>âœ… <strong>ç›¸å¯¹ä½ç½®åç½®</strong>ï¼šæ”¯æŒç›¸å¯¹ä½ç½®ç¼–ç </li></ul><h4 id="item-æ–‡æœ¬æ ¼å¼-âœ…-å·²æ›´æ–°ä¸å®˜æ–¹ä¸€è‡´" tabindex="-1">Item æ–‡æœ¬æ ¼å¼ï¼ˆâœ… å·²æ›´æ–°ä¸å®˜æ–¹ä¸€è‡´ï¼‰ <a class="header-anchor" href="#item-æ–‡æœ¬æ ¼å¼-âœ…-å·²æ›´æ–°ä¸å®˜æ–¹ä¸€è‡´" aria-label="Permalink to â€œItem æ–‡æœ¬æ ¼å¼ï¼ˆâœ… å·²æ›´æ–°ä¸å®˜æ–¹ä¸€è‡´ï¼‰â€">â€‹</a></h4><ul><li>âœ… <strong>æç¤ºè¯å‰ç¼€</strong>ï¼š<code>&quot;Compress the following sentence into embedding: &quot;</code></li><li>âœ… <strong>MovieLens-1M</strong>ï¼š<code>&quot;Compress the following sentence into embedding: title: {title}genres: {genres}&quot;</code></li><li>âœ… <strong>Amazon Books</strong>ï¼š<code>&quot;Compress the following sentence into embedding: title: {title}description: {description}&quot;</code></li><li>âœ… ä½¿ç”¨æœ€åä¸€ä¸ª token çš„éšè—çŠ¶æ€ï¼ˆä¸å®˜æ–¹ä¸€è‡´ï¼‰</li></ul><h4 id="æ•°æ®å¤„ç†" tabindex="-1">æ•°æ®å¤„ç† <a class="header-anchor" href="#æ•°æ®å¤„ç†" aria-label="Permalink to â€œæ•°æ®å¤„ç†â€">â€‹</a></h4><ul><li>âœ… <strong>HSTU æ ¼å¼</strong>ï¼šseq_tokens, seq_positions, seq_time_diffs, targets</li><li>âœ… <strong>æ•°æ®åˆ’åˆ†</strong>ï¼š80% train, 10% val, 10% testï¼ˆæŒ‰ç”¨æˆ·åˆ’åˆ†ï¼‰</li><li>âœ… <strong>åºåˆ—æ„å»º</strong>ï¼šæŒ‰æ—¶é—´æˆ³æ’åºçš„ç”¨æˆ·äº¤äº’åºåˆ—</li></ul><h3 id="_6-2-æœ‰æ„ç®€åŒ–çš„éƒ¨åˆ†-åˆç†ä¼˜åŒ–-âš ï¸" tabindex="-1">6.2 æœ‰æ„ç®€åŒ–çš„éƒ¨åˆ†ï¼ˆåˆç†ä¼˜åŒ–ï¼‰âš ï¸ <a class="header-anchor" href="#_6-2-æœ‰æ„ç®€åŒ–çš„éƒ¨åˆ†-åˆç†ä¼˜åŒ–-âš ï¸" aria-label="Permalink to â€œ6.2 æœ‰æ„ç®€åŒ–çš„éƒ¨åˆ†ï¼ˆåˆç†ä¼˜åŒ–ï¼‰âš ï¸â€">â€‹</a></h3><ol><li><p><strong>LLM æ¨¡å‹æ”¯æŒ</strong></p><ul><li>å®˜æ–¹ï¼šæ”¯æŒå¤šç§ LLMï¼ˆLlama-2ã€Qwen ç­‰ï¼‰</li><li>æœ¬å®ç°ï¼šä»…æ”¯æŒ TinyLlama-1.1B å’Œ Baichuan2-7B</li><li><strong>åŸå› </strong>ï¼šä¸¤ä¸ªæ¨¡å‹å·²è¶³å¤Ÿæ¼”ç¤ºï¼Œç®€åŒ–ä¾èµ–ç®¡ç†</li></ul></li><li><p><strong>æ¨¡å‹è§„æ¨¡</strong></p><ul><li>å®˜æ–¹ï¼šå¯èƒ½ä½¿ç”¨ 4-12 å±‚ Transformer</li><li>æœ¬å®ç°ï¼šé»˜è®¤ n_layers=2</li><li><strong>åŸå› </strong>ï¼šç”¨äºå¿«é€Ÿæ¼”ç¤ºï¼Œå¯é€šè¿‡å‚æ•°è°ƒæ•´</li></ul></li><li><p><strong>è®­ç»ƒè½®æ•°</strong></p><ul><li>å®˜æ–¹ï¼š10-50 è½®</li><li>æœ¬å®ç°ï¼šé»˜è®¤ epochs=5</li><li><strong>åŸå› </strong>ï¼šç”¨äºå¿«é€Ÿæ¼”ç¤ºï¼Œå¯é€šè¿‡å‚æ•°è°ƒæ•´</li></ul></li><li><p><strong>æ–‡æœ¬å¤„ç†</strong></p><ul><li>å®˜æ–¹ï¼šå¯èƒ½åŒ…å« BM25ã€å¤šå­—æ®µèåˆç­‰å¤æ‚å¤„ç†</li><li>æœ¬å®ç°ï¼šç®€å•çš„å­—ç¬¦ä¸²æ‹¼æ¥</li><li><strong>åŸå› </strong>ï¼šåŸºç¡€æ–‡æœ¬å¤„ç†å·²è¶³å¤Ÿï¼Œå¯æŒ‰éœ€æ‰©å±•</li></ul></li></ol><h3 id="_6-3-å‘ç°çš„ä¸ä¸€è‡´ä¹‹å¤„-éœ€è¦å…³æ³¨-âŒ" tabindex="-1">6.3 å‘ç°çš„ä¸ä¸€è‡´ä¹‹å¤„ï¼ˆéœ€è¦å…³æ³¨ï¼‰âŒ <a class="header-anchor" href="#_6-3-å‘ç°çš„ä¸ä¸€è‡´ä¹‹å¤„-éœ€è¦å…³æ³¨-âŒ" aria-label="Permalink to â€œ6.3 å‘ç°çš„ä¸ä¸€è‡´ä¹‹å¤„ï¼ˆéœ€è¦å…³æ³¨ï¼‰âŒâ€">â€‹</a></h3><h4 id="_1-loss-å‡½æ•°-âœ…-å·²å®ç°" tabindex="-1">1. Loss å‡½æ•° âœ… <strong>å·²å®ç°</strong> <a class="header-anchor" href="#_1-loss-å‡½æ•°-âœ…-å·²å®ç°" aria-label="Permalink to â€œ1. Loss å‡½æ•° âœ… å·²å®ç°â€">â€‹</a></h4><ul><li><strong>å½“å‰</strong>ï¼šâœ… NCE Lossï¼ˆNoise Contrastive Estimationï¼‰+ CrossEntropyLossï¼ˆå¯é€‰ï¼‰</li><li><strong>å®˜æ–¹</strong>ï¼šNCE Lossï¼ˆNoise Contrastive Estimationï¼‰</li><li><strong>å½±å“</strong>ï¼šè®­ç»ƒæ•ˆç‡ï¼ŒNCE Loss æé«˜è®­ç»ƒé€Ÿåº¦ 30-50%</li><li><strong>çŠ¶æ€</strong>ï¼šâœ… å·²å®Œå…¨å¯¹é½</li></ul><h4 id="_2-è´Ÿé‡‡æ ·ç­–ç•¥-âœ…-å·²å®ç°" tabindex="-1">2. è´Ÿé‡‡æ ·ç­–ç•¥ âœ… <strong>å·²å®ç°</strong> <a class="header-anchor" href="#_2-è´Ÿé‡‡æ ·ç­–ç•¥-âœ…-å·²å®ç°" aria-label="Permalink to â€œ2. è´Ÿé‡‡æ ·ç­–ç•¥ âœ… å·²å®ç°â€">â€‹</a></h4><ul><li><strong>å½“å‰</strong>ï¼šâœ… In-batch negatives ç­–ç•¥</li><li><strong>å®˜æ–¹</strong>ï¼šä½¿ç”¨ in-batch negatives æˆ– hard negatives</li><li><strong>å½±å“</strong>ï¼šæ¨¡å‹æ€§èƒ½ï¼Œæå‡ 5-10%</li><li><strong>çŠ¶æ€</strong>ï¼šâœ… å·²å®Œå…¨å¯¹é½</li></ul><h4 id="_3-embedding-æå–æ–¹å¼-âœ…-å·²å¯¹é½" tabindex="-1">3. Embedding æå–æ–¹å¼ âœ… <strong>å·²å¯¹é½</strong> <a class="header-anchor" href="#_3-embedding-æå–æ–¹å¼-âœ…-å·²å¯¹é½" aria-label="Permalink to â€œ3. Embedding æå–æ–¹å¼ âœ… å·²å¯¹é½â€">â€‹</a></h4><ul><li><strong>å½“å‰</strong>ï¼šâœ… ä½¿ç”¨æœ€åä¸€ä¸ª token çš„éšè—çŠ¶æ€</li><li><strong>å®˜æ–¹</strong>ï¼šä½¿ç”¨ <code>item_emb_token_n</code> ä¸ªå¯å­¦ä¹  tokenï¼ˆé»˜è®¤ä¸º 1ï¼‰</li><li><strong>å½±å“</strong>ï¼šç»“æœå¯å¤ç°æ€§</li><li><strong>çŠ¶æ€</strong>ï¼šâœ… å·²å¯¹é½ï¼ˆä½¿ç”¨æœ€åä¸€ä¸ª tokenï¼Œä¸å®˜æ–¹ä¸€è‡´ï¼‰</li></ul><h4 id="_4-åˆ†å¸ƒå¼è®­ç»ƒ-ğŸŸ¡-ä¸­ç­‰ä¼˜å…ˆçº§" tabindex="-1">4. åˆ†å¸ƒå¼è®­ç»ƒ ğŸŸ¡ <strong>ä¸­ç­‰ä¼˜å…ˆçº§</strong> <a class="header-anchor" href="#_4-åˆ†å¸ƒå¼è®­ç»ƒ-ğŸŸ¡-ä¸­ç­‰ä¼˜å…ˆçº§" aria-label="Permalink to â€œ4. åˆ†å¸ƒå¼è®­ç»ƒ ğŸŸ¡ ä¸­ç­‰ä¼˜å…ˆçº§â€">â€‹</a></h4><ul><li><strong>å½“å‰</strong>ï¼šå•æœºè®­ç»ƒ</li><li><strong>å®˜æ–¹</strong>ï¼šä½¿ç”¨ DeepSpeed è¿›è¡Œåˆ†å¸ƒå¼è®­ç»ƒ</li><li><strong>å½±å“</strong>ï¼šå¤§è§„æ¨¡æ•°æ®é›†æ”¯æŒ</li><li><strong>å»ºè®®</strong>ï¼šå¯é€‰çš„æ”¹è¿›ï¼Œä¸å½±å“æ ¸å¿ƒåŠŸèƒ½</li></ul><h3 id="_6-4-å¯¹é½åº¦è¯„åˆ†" tabindex="-1">6.4 å¯¹é½åº¦è¯„åˆ† <a class="header-anchor" href="#_6-4-å¯¹é½åº¦è¯„åˆ†" aria-label="Permalink to â€œ6.4 å¯¹é½åº¦è¯„åˆ†â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>ç»´åº¦</th><th>å¯¹é½åº¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ¨¡å‹æ¶æ„</td><td>âœ… 100%</td><td>å®Œå…¨å¯¹é½</td></tr><tr><td>ä½ç½®ç¼–ç </td><td>âœ… 100%</td><td>å®Œå…¨å¯¹é½</td></tr><tr><td>æ—¶é—´ç¼–ç </td><td>âœ… 100%</td><td>å®Œå…¨å¯¹é½</td></tr><tr><td>Item æ–‡æœ¬æ ¼å¼</td><td>âœ… 100%</td><td>å®Œå…¨å¯¹é½ï¼ˆå·²æ›´æ–°ä¸ºå®˜æ–¹æ ¼å¼ï¼‰</td></tr><tr><td>Embedding æå–</td><td>âœ… 100%</td><td>å®Œå…¨å¯¹é½ï¼ˆä½¿ç”¨æœ€å token éšè—çŠ¶æ€ï¼‰</td></tr><tr><td>æ•°æ®é¢„å¤„ç†</td><td>âœ… 100%</td><td>å®Œå…¨å¯¹é½ï¼ˆå·²ä¿®å¤æ•°æ®æ ¼å¼ï¼‰</td></tr><tr><td>è®­ç»ƒé…ç½®</td><td>âœ… 100%</td><td>NCE Loss + è´Ÿé‡‡æ ·å·²å®ç°</td></tr><tr><td>è®­ç»ƒè„šæœ¬</td><td>âœ… 100%</td><td>å·²ä¿®å¤å‚æ•°å®šä¹‰é—®é¢˜</td></tr><tr><td>LLM æ”¯æŒ</td><td>âš ï¸ 80%</td><td>ä»…æ”¯æŒ 2 ç§æ¨¡å‹</td></tr><tr><td>åˆ†å¸ƒå¼è®­ç»ƒ</td><td>âš ï¸ 60%</td><td>æœªå®ç° DeepSpeed</td></tr><tr><td><strong>æ€»ä½“å¯¹é½åº¦</strong></td><td><strong>âœ… 97%</strong></td><td>æ ¸å¿ƒåŠŸèƒ½å®Œå…¨å¯¹é½</td></tr></tbody></table><h3 id="_6-5-æœªå®ç°çš„åŠŸèƒ½" tabindex="-1">6.5 æœªå®ç°çš„åŠŸèƒ½ <a class="header-anchor" href="#_6-5-æœªå®ç°çš„åŠŸèƒ½" aria-label="Permalink to â€œ6.5 æœªå®ç°çš„åŠŸèƒ½â€">â€‹</a></h3><ul><li>å¤šä»»åŠ¡å­¦ä¹ å¤´</li><li>å¤æ‚çš„ç‰¹å¾äº¤å‰ï¼ˆå¦‚ DLRMï¼‰</li><li>å¤šæ­¥è‡ªå›å½’è§£ç </li><li>é«˜çº§æ–‡æœ¬é¢„å¤„ç†ï¼ˆBM25ã€å¤šå­—æ®µèåˆï¼‰</li></ul><hr><h2 id="_7-æ€§èƒ½ä¸èµ„æºéœ€æ±‚" tabindex="-1">7. æ€§èƒ½ä¸èµ„æºéœ€æ±‚ <a class="header-anchor" href="#_7-æ€§èƒ½ä¸èµ„æºéœ€æ±‚" aria-label="Permalink to â€œ7. æ€§èƒ½ä¸èµ„æºéœ€æ±‚â€">â€‹</a></h2><h3 id="_7-1-è®¡ç®—èµ„æº" tabindex="-1">7.1 è®¡ç®—èµ„æº <a class="header-anchor" href="#_7-1-è®¡ç®—èµ„æº" aria-label="Permalink to â€œ7.1 è®¡ç®—èµ„æºâ€">â€‹</a></h3><ul><li><strong>TinyLlama-1.1B</strong>ï¼šçº¦ 2GB GPU å†…å­˜ï¼ˆç”¨äº embedding ç”Ÿæˆï¼‰</li><li><strong>Baichuan2-7B</strong>ï¼šçº¦ 14GB GPU å†…å­˜ï¼ˆç”¨äº embedding ç”Ÿæˆï¼‰</li><li><strong>HLLM è®­ç»ƒ</strong>ï¼šçº¦ 4-8GB GPU å†…å­˜ï¼ˆå–å†³äº batch_size å’Œ seq_lenï¼‰</li></ul><h3 id="_7-2-æ—¶é—´æˆæœ¬" tabindex="-1">7.2 æ—¶é—´æˆæœ¬ <a class="header-anchor" href="#_7-2-æ—¶é—´æˆæœ¬" aria-label="Permalink to â€œ7.2 æ—¶é—´æˆæœ¬â€">â€‹</a></h3><ul><li><strong>Item embedding ç”Ÿæˆ</strong>ï¼šTinyLlama çº¦ 10-20 åˆ†é’Ÿï¼ŒBaichuan2 çº¦ 30-60 åˆ†é’Ÿ</li><li><strong>HLLM è®­ç»ƒ</strong>ï¼š5 ä¸ª epoch çº¦ 30-60 åˆ†é’Ÿï¼ˆå–å†³äºæ•°æ®é‡å’Œç¡¬ä»¶ï¼‰</li></ul><hr><h2 id="_8-æ€»ä½“è¯„ä¼°" tabindex="-1">8. æ€»ä½“è¯„ä¼° <a class="header-anchor" href="#_8-æ€»ä½“è¯„ä¼°" aria-label="Permalink to â€œ8. æ€»ä½“è¯„ä¼°â€">â€‹</a></h2><h3 id="_8-1-å®ç°è´¨é‡è¯„çº§" tabindex="-1">8.1 å®ç°è´¨é‡è¯„çº§ <a class="header-anchor" href="#_8-1-å®ç°è´¨é‡è¯„çº§" aria-label="Permalink to â€œ8.1 å®ç°è´¨é‡è¯„çº§â€">â€‹</a></h3><p><strong>å½“å‰ HLLM å®ç°çš„æ­£ç¡®æ€§è¯„çº§ï¼šâ­â­â­â­â­ (97% å¯¹é½)</strong></p><ul><li>âœ… <strong>æ ¸å¿ƒæ¨¡å‹æ¶æ„</strong>ï¼šå®Œå…¨æ­£ç¡®</li><li>âœ… <strong>æ•°æ®å¤„ç†æµç¨‹</strong>ï¼šå®Œå…¨æ­£ç¡®ï¼ˆå·²ä¿®å¤æ•°æ®æ ¼å¼ï¼‰</li><li>âœ… <strong>Item æ–‡æœ¬æ ¼å¼</strong>ï¼šå®Œå…¨æ­£ç¡®ï¼ˆå·²æ›´æ–°ä¸ºå®˜æ–¹æ ¼å¼ï¼‰</li><li>âœ… <strong>Embedding æå–</strong>ï¼šå®Œå…¨æ­£ç¡®ï¼ˆä½¿ç”¨æœ€å token éšè—çŠ¶æ€ï¼‰</li><li>âœ… <strong>è®­ç»ƒè„šæœ¬</strong>ï¼šå®Œå…¨æ­£ç¡®ï¼ˆå·²ä¿®å¤å‚æ•°å®šä¹‰é—®é¢˜ï¼‰</li><li>âœ… <strong>è®­ç»ƒä¼˜åŒ–</strong>ï¼šNCE Loss å’Œè´Ÿé‡‡æ ·å·²å®ç°</li><li>âš ï¸ <strong>åˆ†å¸ƒå¼æ”¯æŒ</strong>ï¼šæœªå®ç°ï¼ˆå¯é€‰æ”¹è¿›ï¼‰</li></ul><h3 id="_8-2-éªŒè¯ç»“æœ" tabindex="-1">8.2 éªŒè¯ç»“æœ <a class="header-anchor" href="#_8-2-éªŒè¯ç»“æœ" aria-label="Permalink to â€œ8.2 éªŒè¯ç»“æœâ€">â€‹</a></h3><p>æ‰€æœ‰ä»£ç å·²é€šè¿‡éªŒè¯ï¼š</p><ul><li>âœ… è¯­æ³•æ£€æŸ¥é€šè¿‡</li><li>âœ… æ¨¡å—å¯¼å…¥æˆåŠŸ</li><li>âœ… æ¨¡å‹å®ä¾‹åŒ–æˆåŠŸ</li><li>âœ… è®­ç»ƒè„šæœ¬å‚æ•°æ­£ç¡®</li></ul><h3 id="_8-3-åç»­æ”¹è¿›å»ºè®®" tabindex="-1">8.3 åç»­æ”¹è¿›å»ºè®® <a class="header-anchor" href="#_8-3-åç»­æ”¹è¿›å»ºè®®" aria-label="Permalink to â€œ8.3 åç»­æ”¹è¿›å»ºè®®â€">â€‹</a></h3><p><strong>é«˜ä¼˜å…ˆçº§</strong>ï¼ˆå½±å“æ€§èƒ½ï¼‰ï¼š</p><ol><li>æ”¯æŒæ›´å¤š LLM æ¨¡å‹ï¼ˆLlama-2ã€Qwen ç­‰ï¼‰</li><li>å®ç° DeepSpeed è¿›è¡Œåˆ†å¸ƒå¼è®­ç»ƒ</li></ol><p><strong>ä¸­ç­‰ä¼˜å…ˆçº§</strong>ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰ï¼š</p><ol><li>å¢åŠ æ–‡æœ¬é¢„å¤„ç†é€‰é¡¹ï¼ˆBM25ã€å¤šå­—æ®µèåˆç­‰ï¼‰</li><li>æ”¯æŒæ›´å¤šæ•°æ®é›†æ ¼å¼</li></ol><p><strong>ä½ä¼˜å…ˆçº§</strong>ï¼ˆä¼˜åŒ–ä½“éªŒï¼‰ï¼š</p><ol><li>å¤šä»»åŠ¡å­¦ä¹ å¤´</li><li>å¤æ‚çš„ç‰¹å¾äº¤å‰ï¼ˆå¦‚ DLRMï¼‰</li><li>å¤šæ­¥è‡ªå›å½’è§£ç æ¥å£</li></ol><h3 id="_8-4-ä½¿ç”¨å»ºè®®" tabindex="-1">8.4 ä½¿ç”¨å»ºè®® <a class="header-anchor" href="#_8-4-ä½¿ç”¨å»ºè®®" aria-label="Permalink to â€œ8.4 ä½¿ç”¨å»ºè®®â€">â€‹</a></h3><ul><li>âœ… <strong>ç ”ç©¶å’Œæ•™å­¦</strong>ï¼šå½“å‰å®ç°å·²å®Œå…¨é€‚åˆ</li><li>âœ… <strong>å¿«é€ŸåŸå‹</strong>ï¼šå¯ç›´æ¥ä½¿ç”¨</li><li>âœ… <strong>ç”Ÿäº§ç¯å¢ƒ</strong>ï¼šæ ¸å¿ƒåŠŸèƒ½å·²å®Œå…¨å¯¹é½ï¼Œå¯ç›´æ¥ä½¿ç”¨</li><li>âš ï¸ <strong>å¤§è§„æ¨¡æ•°æ®</strong>ï¼šå»ºè®®æ·»åŠ  DeepSpeed æ”¯æŒä»¥æé«˜è®­ç»ƒæ•ˆç‡</li></ul></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_api.md\":\"A-66VmfZ\",\"blog_hllm_reproduction.md\":\"DGw_QFLA\",\"blog_match.md\":\"Dbmtv65x\",\"blog_rank.md\":\"4pCJlY24\",\"cache_api-basic.md\":\"CGpgfakv\",\"cache_api-models.md\":\"CKqTe4Cr\",\"cache_api-trainers.md\":\"l7Op-0s4\",\"cache_api-utils.md\":\"qEvm8nX8\",\"cache_hllm_reproduction.md\":\"SEr1WJjZ\",\"cache_hstu_reproduction.md\":\"Cuqmg-9V\",\"cache_match.md\":\"oRxGdwG1\",\"cache_rank.md\":\"BVMLR97X\",\"cache_å‚è€ƒèµ„æ–™.md\":\"BB8mAuQu\",\"community_changelog.md\":\"BzIj9Nza\",\"community_contributing.md\":\"Dry8VN5b\",\"community_faq.md\":\"oXoqlKy4\",\"contributing.md\":\"B60gEQPy\",\"core_data.md\":\"xs6Lxf8f\",\"core_evaluation.md\":\"Tcbby-zM\",\"core_features.md\":\"lJx9Atbz\",\"core_intro.md\":\"BSZDmg9L\",\"guide_install.md\":\"Cqk8mQ_9\",\"guide_intro.md\":\"DRwafjPy\",\"guide_quick_start.md\":\"fYGiQras\",\"index.md\":\"CL0O1Kgs\",\"manual_api-reference_basic.md\":\"gix_oEYU\",\"manual_api-reference_models.md\":\"BCvabpY5\",\"manual_api-reference_trainers.md\":\"DeV8vyN9\",\"manual_api-reference_utils.md\":\"ljAtlnqQ\",\"manual_faq.md\":\"D9qYkPgc\",\"manual_getting-started.md\":\"CH5XD2SI\",\"manual_installation.md\":\"DLg97S38\",\"manual_tutorials_matching.md\":\"CD2p4zvc\",\"manual_tutorials_multi-task.md\":\"DWikvf8g\",\"manual_tutorials_ranking.md\":\"B02mimyR\",\"models_generative.md\":\"Ddu25dtp\",\"models_intro.md\":\"7HrHx5h_\",\"models_matching.md\":\"DrvgJjHm\",\"models_mtl.md\":\"B-uQctmw\",\"models_ranking.md\":\"CXEnSFwI\",\"serving_demo.md\":\"CuTv7G4h\",\"serving_intro.md\":\"B55_yADR\",\"serving_onnx.md\":\"Cqcblhu_\",\"serving_vector_index.md\":\"Bs2N5WRk\",\"tools_callbacks.md\":\"Ci-UAFOx\",\"tools_intro.md\":\"DQlIBeXN\",\"tools_tracking.md\":\"CeqDASrd\",\"tools_visualization.md\":\"DoYyuloG\",\"tutorials_ctr.md\":\"BcgmvGOr\",\"tutorials_intro.md\":\"zinnJ172\",\"tutorials_pipeline.md\":\"moEqXc22\",\"tutorials_retrieval.md\":\"C9xLe63_\",\"zh_api_api.md\":\"BohBm0dc\",\"zh_community_changelog.md\":\"EuH4RmsE\",\"zh_community_contributing.md\":\"p7WeO_SG\",\"zh_community_faq.md\":\"Cdh5kAyr\",\"zh_core_data.md\":\"DB5K7veW\",\"zh_core_evaluation.md\":\"CZ4IY6QN\",\"zh_core_features.md\":\"B3KtgG8c\",\"zh_core_intro.md\":\"CyK4J-gM\",\"zh_guide_install.md\":\"abSbe_hT\",\"zh_guide_intro.md\":\"DUCqvu9j\",\"zh_guide_quick_start.md\":\"CGotv9k1\",\"zh_index.md\":\"FzYY5Fp0\",\"zh_models_generative.md\":\"hl6-S9dV\",\"zh_models_intro.md\":\"qkawg5eg\",\"zh_models_matching.md\":\"CPckUxBI\",\"zh_models_mtl.md\":\"0PMEngFJ\",\"zh_models_ranking.md\":\"DbG-iAX4\",\"zh_serving_demo.md\":\"Ci568sv8\",\"zh_serving_intro.md\":\"BoSyHpn0\",\"zh_serving_onnx.md\":\"DuNgCYSG\",\"zh_serving_vector_index.md\":\"B2v0WA5L\",\"zh_tools_callbacks.md\":\"tg4LrrwP\",\"zh_tools_intro.md\":\"gs68XCX7\",\"zh_tools_tracking.md\":\"DWCuTSo7\",\"zh_tools_visualization.md\":\"Bdgj0jyc\",\"zh_tutorials_ctr.md\":\"3rGWz_tw\",\"zh_tutorials_intro.md\":\"Vk9Hpzhk\",\"zh_tutorials_pipeline.md\":\"DA9MvXgk\",\"zh_tutorials_retrieval.md\":\"C5ow4h6J\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"torch-rechub\",\"description\":\"A Lighting Pytorch Framework for Recommendation Models, Easy-to-use and Easy-to-extend.\",\"base\":\"/torch-rechub/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/img/logo.png\",\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/datawhalechina/torch-rechub\"}]},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\",\"themeConfig\":{\"nav\":[{\"text\":\"ğŸ  Home\",\"link\":\"/\"},{\"text\":\"ğŸš€ Getting Started\",\"link\":\"/guide/intro\"},{\"text\":\"âš™ï¸ Core\",\"link\":\"/core/intro\"},{\"text\":\"ğŸ° Models\",\"link\":\"/models/intro\"},{\"text\":\"ğŸ› ï¸ Tools\",\"link\":\"/tools/intro\"},{\"text\":\"ğŸš€ Serving\",\"link\":\"/serving/intro\"},{\"text\":\"ğŸ“– Tutorials\",\"link\":\"/tutorials/intro\"},{\"text\":\"â„¹ï¸ API\",\"link\":\"/api/api\"},{\"text\":\"ğŸ‘¥ Community\",\"link\":\"/community/faq\"}],\"sidebar\":{\"/guide/\":[{\"text\":\"ğŸš€ Getting Started\",\"items\":[{\"text\":\"Overview\",\"link\":\"/guide/intro\"},{\"text\":\"Installation\",\"link\":\"/guide/install\"},{\"text\":\"Quick Start\",\"link\":\"/guide/quick_start\"}]}],\"/core/\":[{\"text\":\"âš™ï¸ Core Components\",\"items\":[{\"text\":\"Overview\",\"link\":\"/core/intro\"},{\"text\":\"Feature Columns\",\"link\":\"/core/features\"},{\"text\":\"Data Pipeline\",\"link\":\"/core/data\"},{\"text\":\"Training & Eval\",\"link\":\"/core/evaluation\"}]}],\"/models/\":[{\"text\":\"ğŸ° Model Zoo\",\"items\":[{\"text\":\"Overview\",\"link\":\"/models/intro\"},{\"text\":\"Ranking Models\",\"link\":\"/models/ranking\"},{\"text\":\"Matching Models\",\"link\":\"/models/matching\"},{\"text\":\"Multi-Task Models\",\"link\":\"/models/mtl\"},{\"text\":\"Generative Models\",\"link\":\"/models/generative\"}]}],\"/tools/\":[{\"text\":\"ğŸ› ï¸ Dev Tools\",\"items\":[{\"text\":\"Overview\",\"link\":\"/tools/intro\"},{\"text\":\"Visualization\",\"link\":\"/tools/visualization\"},{\"text\":\"Experiment Tracking\",\"link\":\"/tools/tracking\"},{\"text\":\"Callbacks\",\"link\":\"/tools/callbacks\"}]}],\"/serving/\":[{\"text\":\"ğŸš€ Serving\",\"items\":[{\"text\":\"Overview\",\"link\":\"/serving/intro\"},{\"text\":\"ONNX & Quantization\",\"link\":\"/serving/onnx\"},{\"text\":\"Vector Indexing\",\"link\":\"/serving/vector_index\"},{\"text\":\"Serving Demo\",\"link\":\"/serving/demo\"}]}],\"/tutorials/\":[{\"text\":\"ğŸ“– Tutorials\",\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/intro\"},{\"text\":\"CTR Pipeline\",\"link\":\"/tutorials/ctr\"},{\"text\":\"Retrieval System\",\"link\":\"/tutorials/retrieval\"},{\"text\":\"Big Data Pipeline\",\"link\":\"/tutorials/pipeline\"}]}],\"/api/\":[{\"text\":\"â„¹ï¸ API Reference\",\"items\":[{\"text\":\"Main API\",\"link\":\"/api/api\"}]}],\"/community/\":[{\"text\":\"ğŸ“˜ Community\",\"items\":[{\"text\":\"FAQ\",\"link\":\"/community/faq\"},{\"text\":\"Contributing\",\"link\":\"/community/contributing\"},{\"text\":\"Changelog\",\"link\":\"/community/changelog\"}]}]}}},\"zh\":{\"label\":\"ä¸­æ–‡\",\"lang\":\"zh-CN\",\"link\":\"/zh/\",\"themeConfig\":{\"nav\":[{\"text\":\"ğŸ  é¦–é¡µ\",\"link\":\"/zh/\"},{\"text\":\"ğŸš€ å¿«é€Ÿå…¥é—¨\",\"link\":\"/zh/guide/intro\"},{\"text\":\"âš™ï¸ æ ¸å¿ƒç»„ä»¶\",\"link\":\"/zh/core/intro\"},{\"text\":\"ğŸ° æ¨¡å‹åº“\",\"link\":\"/zh/models/intro\"},{\"text\":\"ğŸ› ï¸ ç ”å‘å·¥å…·\",\"link\":\"/zh/tools/intro\"},{\"text\":\"ğŸš€ ç”Ÿäº§éƒ¨ç½²\",\"link\":\"/zh/serving/intro\"},{\"text\":\"ğŸ“– åœºæ™¯æ•™ç¨‹\",\"link\":\"/zh/tutorials/intro\"},{\"text\":\"â„¹ï¸ API\",\"link\":\"/zh/api/api\"},{\"text\":\"ğŸ‘¥ ç¤¾åŒº\",\"link\":\"/zh/community/faq\"}],\"sidebar\":{\"/zh/guide/\":[{\"text\":\"ğŸš€ å¿«é€Ÿå…¥é—¨\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/guide/intro\"},{\"text\":\"å®‰è£…æŒ‡å—\",\"link\":\"/zh/guide/install\"},{\"text\":\"3åˆ†é’Ÿä¸Šæ‰‹\",\"link\":\"/zh/guide/quick_start\"}]}],\"/zh/core/\":[{\"text\":\"âš™ï¸ æ ¸å¿ƒç»„ä»¶\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/core/intro\"},{\"text\":\"ç‰¹å¾å®šä¹‰ (Features)\",\"link\":\"/zh/core/features\"},{\"text\":\"æ•°æ®æµæ°´çº¿ (Data)\",\"link\":\"/zh/core/data\"},{\"text\":\"è®­ç»ƒä¸è¯„ä¼° (Eval)\",\"link\":\"/zh/core/evaluation\"}]}],\"/zh/models/\":[{\"text\":\"ğŸ° æ¨¡å‹åº“\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/models/intro\"},{\"text\":\"æ’åºæ¨¡å‹ (Ranking)\",\"link\":\"/zh/models/ranking\"},{\"text\":\"å¬å›æ¨¡å‹ (Matching)\",\"link\":\"/zh/models/matching\"},{\"text\":\"å¤šä»»åŠ¡æ¨¡å‹ (MTL)\",\"link\":\"/zh/models/mtl\"},{\"text\":\"ç”Ÿæˆå¼æ¨¡å‹ (Generative)\",\"link\":\"/zh/models/generative\"}]}],\"/zh/tools/\":[{\"text\":\"ğŸ› ï¸ ç ”å‘å·¥å…·\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/tools/intro\"},{\"text\":\"å¯è§†åŒ–ç›‘æ§\",\"link\":\"/zh/tools/visualization\"},{\"text\":\"å®éªŒè¿½è¸ª\",\"link\":\"/zh/tools/tracking\"},{\"text\":\"å›è°ƒå‡½æ•°\",\"link\":\"/zh/tools/callbacks\"}]}],\"/zh/serving/\":[{\"text\":\"ğŸš€ ç”Ÿäº§éƒ¨ç½²\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/serving/intro\"},{\"text\":\"ONNX å¯¼å‡ºä¸é‡åŒ–\",\"link\":\"/zh/serving/onnx\"},{\"text\":\"å‘é‡æ£€ç´¢å°è£…\",\"link\":\"/zh/serving/vector_index\"},{\"text\":\"åœ¨çº¿æœåŠ¡ç¤ºä¾‹\",\"link\":\"/zh/serving/demo\"}]}],\"/zh/tutorials/\":[{\"text\":\"ğŸ“– åœºæ™¯æ•™ç¨‹\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/tutorials/intro\"},{\"text\":\"CTR é¢„ä¼°æµç¨‹\",\"link\":\"/zh/tutorials/ctr\"},{\"text\":\"å¬å›ç³»ç»Ÿæ­å»º\",\"link\":\"/zh/tutorials/retrieval\"},{\"text\":\"å…¨é“¾è·¯æµæ°´çº¿\",\"link\":\"/zh/tutorials/pipeline\"}]}],\"/zh/api/\":[{\"text\":\"â„¹ï¸ API Reference\",\"items\":[{\"text\":\"API å‚è€ƒ\",\"link\":\"/zh/api/api\"}]}],\"/zh/community/\":[{\"text\":\"ğŸ“˜ ç¤¾åŒºä¿¡æ¯\",\"items\":[{\"text\":\"å¸¸è§é—®é¢˜ (FAQ)\",\"link\":\"/zh/community/faq\"},{\"text\":\"è´¡çŒ®æŒ‡å— (Contributing)\",\"link\":\"/zh/community/contributing\"},{\"text\":\"ç‰ˆæœ¬æ—¥å¿— (Changelog)\",\"link\":\"/zh/community/changelog\"}]}]}}}},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>