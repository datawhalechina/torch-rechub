<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å¬å›æ¨¡å‹ | torch-rechub</title>
    <meta name="description" content="Torch-RecHub å¬å›æ¨¡å‹è¯¦ç»†ä»‹ç»">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/torch-rechub/assets/style.Dnbe36Wi.css" as="style">
    <link rel="preload stylesheet" href="/torch-rechub/vp-icons.css" as="style">
    
    <script type="module" src="/torch-rechub/assets/app.CtCE54ez.js"></script>
    <link rel="preload" href="/torch-rechub/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/torch-rechub/assets/chunks/theme.BkbgLTTS.js">
    <link rel="modulepreload" href="/torch-rechub/assets/chunks/framework.BiSKXDrp.js">
    <link rel="modulepreload" href="/torch-rechub/assets/zh_models_matching.md.BPmlhh3Q.lean.js">
    <link rel="icon" href="/torch-rechub/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle has-sidebar" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/torch-rechub/zh/" data-v-1e38c6bc><!--[--><!--]--><!--[--><img class="VPImage logo" src="/torch-rechub/img/logo.png" alt data-v-8426fc1a><!--]--><span data-v-1e38c6bc>torch-rechub</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!--[--><!----><div id="local-search"><button type="button" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><span class="vpi-search DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ  é¦–é¡µ</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/guide/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸš€ å¿«é€Ÿå…¥é—¨</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/core/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>âš™ï¸ æ ¸å¿ƒç»„ä»¶</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/models/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ° æ¨¡å‹åº“</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/tools/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ› ï¸ ç ”å‘å·¥å…·</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/serving/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸš€ ç”Ÿäº§éƒ¨ç½²</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/tutorials/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ“– åœºæ™¯æ•™ç¨‹</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/api/api.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>â„¹ï¸ API</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/community/faq.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ‘¥ ç¤¾åŒº</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-70946a35 data-v-4c1766e2 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-42cb505d><span class="text" data-v-42cb505d><span class="vpi-languages option-icon" data-v-42cb505d></span><!----><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="items" data-v-4c1766e2><p class="title" data-v-4c1766e2>ä¸­æ–‡</p><!--[--><div class="VPMenuLink" data-v-4c1766e2 data-v-faf5b206><a class="VPLink link" href="/torch-rechub/models/matching.html" lang="en" data-v-faf5b206><!--[--><span data-v-faf5b206>English</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/datawhalechina/torch-rechub" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="group translations" data-v-bf2fac68><p class="trans-title" data-v-bf2fac68>ä¸­æ–‡</p><!--[--><div class="VPMenuLink" data-v-bf2fac68 data-v-faf5b206><a class="VPLink link" href="/torch-rechub/models/matching.html" lang="en" data-v-faf5b206><!--[--><span data-v-faf5b206>English</span><!--]--></a></div><!--]--></div><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/datawhalechina/torch-rechub" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-db738f89><span class="vpi-align-left menu-icon" data-v-db738f89></span><span class="menu-text" data-v-db738f89>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1df9f90f data-v-af661f50><div class="curtain" data-v-af661f50></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-af661f50><span class="visually-hidden" id="sidebar-aria-label" data-v-af661f50> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 has-active" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>ğŸ° æ¨¡å‹åº“</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/intro.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>å¯¼è§ˆ (Overview)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/ranking.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>æ’åºæ¨¡å‹ (Ranking)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/matching.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>å¬å›æ¨¡å‹ (Matching)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/mtl.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>å¤šä»»åŠ¡æ¨¡å‹ (MTL)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/generative.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>ç”Ÿæˆå¼æ¨¡å‹ (Generative)</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-sidebar has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _torch-rechub_zh_models_matching" data-v-7011f0d8><div><h1 id="å¬å›æ¨¡å‹" tabindex="-1">å¬å›æ¨¡å‹ <a class="header-anchor" href="#å¬å›æ¨¡å‹" aria-label="Permalink to â€œå¬å›æ¨¡å‹â€">â€‹</a></h1><p>å¬å›æ¨¡å‹æ˜¯æ¨èç³»ç»Ÿä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œç”¨äºä»æµ·é‡ç‰©å“ä¸­å¿«é€Ÿå¬å›ä¸ç”¨æˆ·ç›¸å…³çš„å€™é€‰é›†ã€‚Torch-RecHub æä¾›äº†å¤šç§å…ˆè¿›çš„å¬å›æ¨¡å‹ï¼Œæ¶µç›–äº†ä¸åŒçš„å¬å›ç­–ç•¥å’Œå»ºæ¨¡æ–¹å¼ã€‚</p><h2 id="_1-dssm" tabindex="-1">1. DSSM <a class="header-anchor" href="#_1-dssm" aria-label="Permalink to â€œ1. DSSMâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>DSSMï¼ˆDeep Structured Semantic Modelsï¼‰æ˜¯ä¸€ç§ç»å…¸çš„åŒå¡”å¬å›æ¨¡å‹ï¼Œé€šè¿‡å°†ç”¨æˆ·å’Œç‰©å“æ˜ å°„åˆ°åŒä¸€å‘é‡ç©ºé—´ï¼Œè®¡ç®—å‘é‡ç›¸ä¼¼åº¦æ¥è¿›è¡Œå¬å›ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Huang, Po-Sen, et al. &quot;Learning deep structured semantic models for web search using clickthrough data.&quot; Proceedings of the 22nd ACM international conference on Information &amp; Knowledge Management. 2013.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>åŒå¡”ç»“æ„</strong>ï¼šåŒ…å«ç”¨æˆ·å¡”å’Œç‰©å“å¡”ä¸¤ä¸ªç‹¬ç«‹çš„ç¥ç»ç½‘ç»œ</li><li><strong>ç‰¹å¾åµŒå…¥</strong>ï¼šå°†ç”¨æˆ·å’Œç‰©å“ç‰¹å¾åˆ†åˆ«æ˜ å°„åˆ°ä½ç»´å‘é‡ç©ºé—´</li><li><strong>ç›¸ä¼¼åº¦è®¡ç®—</strong>ï¼šä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦æˆ–ç‚¹ç§¯è®¡ç®—ç”¨æˆ·å’Œç‰©å“å‘é‡çš„ç›¸ä¼¼åº¦</li><li><strong>è´Ÿé‡‡æ ·</strong>ï¼šé€šè¿‡è´Ÿé‡‡æ ·è®­ç»ƒæ¨¡å‹ï¼Œä¼˜åŒ–æ’åºæ€§èƒ½</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DSSM</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.basic.features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SparseFeature, DenseFeature</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DenseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;item_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;category&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DSSM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prelu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prelu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°ï¼Œç”¨äºè°ƒæ•´ç›¸ä¼¼åº¦åˆ†å¸ƒ</td><td>0.02</td></tr><tr><td>user_params</td><td>dict</td><td>ç”¨æˆ·å¡”ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>item_params</td><td>dict</td><td>ç‰©å“å¡”ç½‘ç»œå‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>æ–‡æœ¬åŒ¹é…åœºæ™¯</li><li>å¤§è§„æ¨¡æ¨èç³»ç»Ÿ</li><li>å†·å¯åŠ¨é—®é¢˜</li></ul><h2 id="_2-facebookdssm" tabindex="-1">2. FaceBookDSSM <a class="header-anchor" href="#_2-facebookdssm" aria-label="Permalink to â€œ2. FaceBookDSSMâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-1" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-1" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>FaceBookDSSM æ˜¯ Facebook æå‡ºçš„ DSSM å˜ç§ï¼Œé‡‡ç”¨äº†ä¸åŒçš„ç½‘ç»œç»“æ„å’ŒæŸå¤±å‡½æ•°ï¼Œè¿›ä¸€æ­¥æé«˜äº†å¬å›æ•ˆæœã€‚</p><h3 id="æ ¸å¿ƒåŸç†-1" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-1" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>åŒå¡”ç»“æ„</strong>ï¼šç»§æ‰¿äº† DSSM çš„åŒå¡”ç»“æ„</li><li><strong>æ·±å±‚ç½‘ç»œ</strong>ï¼šä½¿ç”¨æ›´æ·±çš„ç½‘ç»œç»“æ„ï¼Œæé«˜æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›</li><li><strong>æ”¹è¿›çš„æŸå¤±å‡½æ•°</strong>ï¼šä½¿ç”¨æ”¹è¿›çš„æŸå¤±å‡½æ•°ï¼Œä¼˜åŒ–æ¨¡å‹è®­ç»ƒ</li><li><strong>ç‰¹å¾å·¥ç¨‹</strong>ï¼šæ³¨é‡ç‰¹å¾å·¥ç¨‹ï¼Œæ”¯æŒå¤šç§ç‰¹å¾ç±»å‹</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-1" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-1" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FaceBookDSSM</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FaceBookDSSM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-1" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-1" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>user_params</td><td>dict</td><td>ç”¨æˆ·å¡”ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>item_params</td><td>dict</td><td>ç‰©å“å¡”ç½‘ç»œå‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-1" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-1" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>å¤§è§„æ¨¡æ¨èç³»ç»Ÿ</li><li>å¹¿å‘Šå¬å›</li><li>å†…å®¹æ¨è</li></ul><h2 id="_3-youtubednn" tabindex="-1">3. YoutubeDNN <a class="header-anchor" href="#_3-youtubednn" aria-label="Permalink to â€œ3. YoutubeDNNâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-2" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-2" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>YoutubeDNN æ˜¯ YouTube æå‡ºçš„æ·±åº¦å¬å›æ¨¡å‹ï¼ŒåŸºäºç”¨æˆ·å†å²è¡Œä¸ºåºåˆ—é¢„æµ‹ä¸‹ä¸€ä¸ªè§‚çœ‹çš„è§†é¢‘ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-1" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-1" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Covington, Paul, Jay Adams, and Emre Sargin. &quot;Deep neural networks for youtube recommendations.&quot; Proceedings of the 10th ACM conference on recommender systems. 2016.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-2" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-2" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>åºåˆ—å»ºæ¨¡</strong>ï¼šä½¿ç”¨æ·±åº¦ç¥ç»ç½‘ç»œå»ºæ¨¡ç”¨æˆ·å†å²è¡Œä¸ºåºåˆ—</li><li><strong>è´Ÿé‡‡æ ·</strong>ï¼šé‡‡ç”¨è´Ÿé‡‡æ ·æŠ€æœ¯ï¼Œæé«˜è®­ç»ƒæ•ˆç‡</li><li><strong>åŒå¡”ç»“æ„</strong>ï¼šåŒ…å«ç”¨æˆ·å¡”å’Œç‰©å“å¡”ï¼Œæ”¯æŒç¦»çº¿é¢„è®¡ç®—ç‰©å“åµŒå…¥</li><li><strong>å¤šç›®æ ‡ä¼˜åŒ–</strong>ï¼šåŒæ—¶ä¼˜åŒ–ç‚¹å‡»ç‡å’Œè§‚çœ‹æ—¶é•¿ç­‰å¤šä¸ªç›®æ ‡</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-2" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-2" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> YoutubeDNN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.basic.features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SequenceFeature</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰åºåˆ—ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SequenceFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pooling</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mean&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;item_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;category&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> YoutubeDNN(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-2" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-2" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>user_params</td><td>dict</td><td>ç”¨æˆ·å¡”ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°</td><td>0.02</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-2" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-2" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>è§†é¢‘æ¨è</li><li>éŸ³ä¹æ¨è</li><li>å†…å®¹æ¨è</li><li>åŸºäºå†å²è¡Œä¸ºçš„æ¨è</li></ul><h2 id="_4-youtubesbc" tabindex="-1">4. YoutubeSBC <a class="header-anchor" href="#_4-youtubesbc" aria-label="Permalink to â€œ4. YoutubeSBCâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-3" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-3" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>YoutubeSBCï¼ˆSample Bias Correctionï¼‰æ˜¯ YouTube æå‡ºçš„æ”¹è¿›ç‰ˆæ·±åº¦å¬å›æ¨¡å‹ï¼Œè§£å†³äº†é‡‡æ ·åå·®é—®é¢˜ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-2" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-2" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Wu, Liang, et al. &quot;RecSys 2019 tutorial: Deep learning for recommendations.&quot; Proceedings of the 13th ACM Conference on Recommender Systems. 2019.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-3" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-3" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>é‡‡æ ·åå·®æ ¡æ­£</strong>ï¼šå¼•å…¥é‡‡æ ·åå·®æ ¡æ­£æœºåˆ¶ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›</li><li><strong>åŒå¡”ç»“æ„</strong>ï¼šç»§æ‰¿äº† YoutubeDNN çš„åŒå¡”ç»“æ„</li><li><strong>æ”¹è¿›çš„è®­ç»ƒæ–¹æ³•</strong>ï¼šä½¿ç”¨æ”¹è¿›çš„è®­ç»ƒæ–¹æ³•ï¼Œä¼˜åŒ–æ¨¡å‹æ€§èƒ½</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-3" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-3" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> YoutubeSBC</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> YoutubeSBC(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-3" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-3" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>user_params</td><td>dict</td><td>ç”¨æˆ·å¡”ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°</td><td>0.02</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-3" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-3" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>å¤§è§„æ¨¡æ¨èç³»ç»Ÿ</li><li>é‡‡æ ·åå·®é—®é¢˜ä¸¥é‡çš„åœºæ™¯</li><li>å†…å®¹æ¨è</li></ul><h2 id="_5-mind" tabindex="-1">5. MIND <a class="header-anchor" href="#_5-mind" aria-label="Permalink to â€œ5. MINDâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-4" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-4" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>MINDï¼ˆMulti-Interest Network with Dynamic Routingï¼‰æ˜¯ä¸€ç§å¤šå…´è¶£å¬å›æ¨¡å‹ï¼Œèƒ½å¤Ÿä¸ºæ¯ä¸ªç”¨æˆ·å­¦ä¹ å¤šä¸ªå…´è¶£è¡¨ç¤ºã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-3" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-3" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Chen, Jiaxi, et al. &quot;Multi-interest network with dynamic routing for recommendation at Tmall.&quot; Proceedings of the 28th ACM International Conference on Information and Knowledge Management. 2019.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-4" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-4" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>å¤šå…´è¶£å»ºæ¨¡</strong>ï¼šä¸ºæ¯ä¸ªç”¨æˆ·å­¦ä¹ å¤šä¸ªå…´è¶£å‘é‡</li><li><strong>åŠ¨æ€è·¯ç”±</strong>ï¼šä½¿ç”¨èƒ¶å›Šç½‘ç»œä¸­çš„åŠ¨æ€è·¯ç”±æœºåˆ¶ï¼Œè‡ªé€‚åº”åœ°èšåˆç”¨æˆ·å…´è¶£</li><li><strong>å…´è¶£æ¼”åŒ–</strong>ï¼šæ•æ‰ç”¨æˆ·å…´è¶£çš„åŠ¨æ€å˜åŒ–</li><li><strong>åŒå¡”ç»“æ„</strong>ï¼šæ”¯æŒç¦»çº¿é¢„è®¡ç®—ç‰©å“åµŒå…¥</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-4" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-4" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MIND</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰åºåˆ—ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SequenceFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pooling</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MIND(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_items</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_interest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å­¦ä¹ çš„å…´è¶£æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-4" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-4" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>user_params</td><td>dict</td><td>ç”¨æˆ·å¡”ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>n_items</td><td>int</td><td>ç‰©å“æ€»æ•°</td><td>None</td></tr><tr><td>n_interest</td><td>int</td><td>å­¦ä¹ çš„å…´è¶£æ•°é‡</td><td>4</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°</td><td>0.02</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-4" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-4" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ç”¨æˆ·å…´è¶£å¤šæ ·åŒ–çš„åœºæ™¯</li><li>ç”µå•†æ¨è</li><li>å†…å®¹æ¨è</li></ul><h2 id="_6-gru4rec" tabindex="-1">6. GRU4Rec <a class="header-anchor" href="#_6-gru4rec" aria-label="Permalink to â€œ6. GRU4Recâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-5" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-5" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>GRU4Rec æ˜¯ä¸€ç§åŸºäº GRUï¼ˆGated Recurrent Unitï¼‰çš„åºåˆ—æ¨èæ¨¡å‹ï¼Œèƒ½å¤Ÿæ•è·ç”¨æˆ·è¡Œä¸ºåºåˆ—ä¸­çš„åŠ¨æ€ä¾èµ–å…³ç³»ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-4" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-4" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Hidasi, BalÃ¡zs, et al. &quot;Session-based recommendations with recurrent neural networks.&quot; arXiv preprint arXiv:1511.06939 (2015).</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-5" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-5" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>GRU åºåˆ—å»ºæ¨¡</strong>ï¼šä½¿ç”¨ GRU æ•æ‰ç”¨æˆ·è¡Œä¸ºåºåˆ—çš„åŠ¨æ€å˜åŒ–</li><li><strong>ä¼šè¯æ¨è</strong>ï¼šä¸“æ³¨äºä¼šè¯å†…çš„æ¨èï¼Œä¸éœ€è¦ç”¨æˆ·å†å²æ•°æ®</li><li><strong>è´Ÿé‡‡æ ·</strong>ï¼šé‡‡ç”¨è´Ÿé‡‡æ ·æŠ€æœ¯ï¼Œæé«˜è®­ç»ƒæ•ˆç‡</li><li><strong>BPR æŸå¤±</strong>ï¼šä½¿ç”¨ BPR æŸå¤±å‡½æ•°ï¼Œä¼˜åŒ–æ’åºæ€§èƒ½</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-5" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-5" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GRU4Rec</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰åºåˆ—ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SequenceFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pooling</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GRU4Rec(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    embedding_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    hidden_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    num_layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    dropout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-5" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-5" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>embedding_dim</td><td>int</td><td>Embedding ç»´åº¦</td><td>32</td></tr><tr><td>hidden_size</td><td>int</td><td>GRU éšè—å±‚å¤§å°</td><td>64</td></tr><tr><td>num_layers</td><td>int</td><td>GRU å±‚æ•°</td><td>2</td></tr><tr><td>dropout</td><td>float</td><td>Dropout ç‡</td><td>0.2</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°</td><td>0.02</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-5" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-5" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ä¼šè¯æ¨è</li><li>çŸ­åºåˆ—æ¨è</li><li>ç”µå•†åœºæ™¯</li></ul><h2 id="_7-narm" tabindex="-1">7. NARM <a class="header-anchor" href="#_7-narm" aria-label="Permalink to â€œ7. NARMâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-6" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-6" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>NARMï¼ˆNeural Attentive Session-based Recommendationï¼‰æ˜¯ä¸€ç§åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„ä¼šè¯æ¨èæ¨¡å‹ï¼Œèƒ½å¤ŸåŒæ—¶æ•è·ä¼šè¯å†…çš„å±€éƒ¨å’Œå…¨å±€å…´è¶£ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-5" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-5" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Li, Jing, et al. &quot;Neural attentive session-based recommendation.&quot; Proceedings of the 2017 ACM on Conference on Information and Knowledge Management. 2017.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-6" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-6" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>GRU åºåˆ—å»ºæ¨¡</strong>ï¼šä½¿ç”¨ GRU æ•æ‰ä¼šè¯å†…çš„åºåˆ—ä¾èµ–</li><li><strong>æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šå¼•å…¥æ³¨æ„åŠ›æœºåˆ¶ï¼Œæ•è·ä¼šè¯å†…çš„å±€éƒ¨å…´è¶£</li><li><strong>å…¨å±€è¡¨ç¤º</strong>ï¼šåŒæ—¶å­¦ä¹ ä¼šè¯çš„å…¨å±€è¡¨ç¤ºï¼Œç»“åˆå±€éƒ¨å’Œå…¨å±€å…´è¶£</li><li><strong>ä¼šè¯æ¨è</strong>ï¼šä¸“æ³¨äºä¼šè¯å†…çš„æ¨è</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-6" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-6" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NARM</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NARM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    embedding_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    hidden_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    num_layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    dropout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-6" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-6" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>embedding_dim</td><td>int</td><td>Embedding ç»´åº¦</td><td>32</td></tr><tr><td>hidden_size</td><td>int</td><td>GRU éšè—å±‚å¤§å°</td><td>64</td></tr><tr><td>num_layers</td><td>int</td><td>GRU å±‚æ•°</td><td>1</td></tr><tr><td>dropout</td><td>float</td><td>Dropout ç‡</td><td>0.2</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°</td><td>0.02</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-6" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-6" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ä¼šè¯æ¨è</li><li>çŸ­åºåˆ—æ¨è</li><li>å±€éƒ¨å’Œå…¨å±€å…´è¶£å»ºæ¨¡</li></ul><h2 id="_8-sasrec" tabindex="-1">8. SASRec <a class="header-anchor" href="#_8-sasrec" aria-label="Permalink to â€œ8. SASRecâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-7" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-7" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>SASRecï¼ˆSelf-Attentive Sequential Recommendationï¼‰æ˜¯ä¸€ç§åŸºäºè‡ªæ³¨æ„åŠ›æœºåˆ¶çš„åºåˆ—æ¨èæ¨¡å‹ï¼Œèƒ½å¤Ÿæ•è·ç”¨æˆ·è¡Œä¸ºåºåˆ—ä¸­çš„é•¿è·ç¦»ä¾èµ–å…³ç³»ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-6" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-6" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Kang, Wang-Cheng, and Julian McAuley. &quot;Self-attentive sequential recommendation.&quot; 2018 IEEE International Conference on Data Mining (ICDM). IEEE, 2018.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-7" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-7" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šä½¿ç”¨å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶æ•è·åºåˆ—ä¸­çš„é•¿è·ç¦»ä¾èµ–</li><li><strong>ä½ç½®ç¼–ç </strong>ï¼šæ·»åŠ ä½ç½®ä¿¡æ¯ï¼Œä¿ç•™åºåˆ—çš„é¡ºåºä¿¡æ¯</li><li><strong>å±‚å½’ä¸€åŒ–</strong>ï¼šåŠ é€Ÿæ¨¡å‹æ”¶æ•›ï¼Œæé«˜è®­ç»ƒç¨³å®šæ€§</li><li><strong>æ®‹å·®è¿æ¥</strong>ï¼šå¢å¼ºæ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-7" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-7" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SASRec</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SASRec(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    embedding_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    num_heads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    num_layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    hidden_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    dropout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-7" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-7" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>embedding_dim</td><td>int</td><td>Embedding ç»´åº¦</td><td>32</td></tr><tr><td>num_heads</td><td>int</td><td>æ³¨æ„åŠ›å¤´æ•°</td><td>4</td></tr><tr><td>num_layers</td><td>int</td><td>Transformer å±‚æ•°</td><td>2</td></tr><tr><td>hidden_size</td><td>int</td><td>éšè—å±‚å¤§å°</td><td>128</td></tr><tr><td>dropout</td><td>float</td><td>Dropout ç‡</td><td>0.2</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°</td><td>0.02</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-7" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-7" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>é•¿åºåˆ—æ¨è</li><li>ç”¨æˆ·è¡Œä¸ºåºåˆ—é‡è¦çš„åœºæ™¯</li><li>é¡ºåºæ¨èä»»åŠ¡</li></ul><h2 id="_9-sine" tabindex="-1">9. SINE <a class="header-anchor" href="#_9-sine" aria-label="Permalink to â€œ9. SINEâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-8" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-8" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>SINEï¼ˆSparse Interest Network for Sequential Recommendationï¼‰æ˜¯ä¸€ç§ç¨€ç–å…´è¶£ç½‘ç»œï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å»ºæ¨¡ç”¨æˆ·çš„ç¨€ç–å…´è¶£ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-7" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-7" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Chen, Jiaxi, et al. &quot;SINE: A sparse interest network for sequential recommendation.&quot; Proceedings of the 14th ACM Conference on Recommender Systems. 2021.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-8" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-8" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>ç¨€ç–å…´è¶£å»ºæ¨¡</strong>ï¼šä¸“é—¨å¤„ç†ç”¨æˆ·å…´è¶£ç¨€ç–çš„é—®é¢˜</li><li><strong>åŠ¨æ€è·¯ç”±</strong>ï¼šä½¿ç”¨åŠ¨æ€è·¯ç”±æœºåˆ¶ï¼Œè‡ªé€‚åº”åœ°èšåˆç”¨æˆ·å…´è¶£</li><li><strong>å…´è¶£æ¼”åŒ–</strong>ï¼šæ•æ‰ç”¨æˆ·å…´è¶£çš„åŠ¨æ€å˜åŒ–</li><li><strong>é«˜æ•ˆè®¡ç®—</strong>ï¼šä¼˜åŒ–äº†è®¡ç®—æ•ˆç‡ï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-8" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-8" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> SINE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SINE(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    embedding_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    num_heads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    num_layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    hidden_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    dropout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_interest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-8" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-8" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>embedding_dim</td><td>int</td><td>Embedding ç»´åº¦</td><td>32</td></tr><tr><td>num_heads</td><td>int</td><td>æ³¨æ„åŠ›å¤´æ•°</td><td>4</td></tr><tr><td>num_layers</td><td>int</td><td>Transformer å±‚æ•°</td><td>2</td></tr><tr><td>hidden_size</td><td>int</td><td>éšè—å±‚å¤§å°</td><td>128</td></tr><tr><td>dropout</td><td>float</td><td>Dropout ç‡</td><td>0.2</td></tr><tr><td>n_interest</td><td>int</td><td>å…´è¶£æ•°é‡</td><td>4</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°</td><td>0.02</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-8" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-8" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ç”¨æˆ·å…´è¶£ç¨€ç–çš„åœºæ™¯</li><li>å¤§è§„æ¨¡æ¨èç³»ç»Ÿ</li><li>ç”µå•†æ¨è</li></ul><h2 id="_10-stamp" tabindex="-1">10. STAMP <a class="header-anchor" href="#_10-stamp" aria-label="Permalink to â€œ10. STAMPâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-9" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-9" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>STAMPï¼ˆShort-Term Attention/Memory Priority Modelï¼‰æ˜¯ä¸€ç§åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„ä¼šè¯æ¨èæ¨¡å‹ï¼Œä¸“æ³¨äºè¿‘æœŸç”¨æˆ·è¡Œä¸ºçš„å»ºæ¨¡ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-8" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-8" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Liu, Qiao, et al. &quot;STAMP: short-term attention/memory priority model for session-based recommendation.&quot; Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining. 2018.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-9" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-9" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>çŸ­æœŸæ³¨æ„åŠ›</strong>ï¼šä¸“æ³¨äºè¿‘æœŸç”¨æˆ·è¡Œä¸ºï¼Œç»™äºˆè¿‘æœŸè¡Œä¸ºæ›´é«˜çš„æƒé‡</li><li><strong>è®°å¿†æ¨¡å—</strong>ï¼šç»´æŠ¤ä¸€ä¸ªè®°å¿†å‘é‡ï¼Œæ•è·ä¼šè¯çš„å…¨å±€ä¿¡æ¯</li><li><strong>ä¼šè¯æ¨è</strong>ï¼šä¸“æ³¨äºä¼šè¯å†…çš„æ¨è</li><li><strong>ç®€å•é«˜æ•ˆ</strong>ï¼šæ¨¡å‹ç»“æ„ç®€å•ï¼Œè®¡ç®—æ•ˆç‡é«˜</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-9" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-9" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> STAMP</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> STAMP(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    embedding_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    hidden_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    dropout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-9" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-9" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>embedding_dim</td><td>int</td><td>Embedding ç»´åº¦</td><td>32</td></tr><tr><td>hidden_size</td><td>int</td><td>éšè—å±‚å¤§å°</td><td>128</td></tr><tr><td>dropout</td><td>float</td><td>Dropout ç‡</td><td>0.2</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°</td><td>0.02</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-9" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-9" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ä¼šè¯æ¨è</li><li>çŸ­æœŸå…´è¶£å»ºæ¨¡</li><li>ç”µå•†åœºæ™¯</li></ul><h2 id="_11-comirecdr" tabindex="-1">11. ComirecDR <a class="header-anchor" href="#_11-comirecdr" aria-label="Permalink to â€œ11. ComirecDRâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-10" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-10" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>ComirecDRï¼ˆControllable Multi-Interest Recommendation with Dynamic Routingï¼‰æ˜¯ä¸€ç§å¯æ§å¤šå…´è¶£æ¨èæ¨¡å‹ï¼Œå…è®¸æ§åˆ¶ç”Ÿæˆçš„å…´è¶£æ•°é‡ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-9" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-9" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Chen, Jiaxi, et al. &quot;Controllable multi-interest framework for recommendation.&quot; Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining. 2020.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-10" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-10" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>å¯æ§å¤šå…´è¶£</strong>ï¼šå…è®¸æ§åˆ¶ç”Ÿæˆçš„å…´è¶£æ•°é‡</li><li><strong>åŠ¨æ€è·¯ç”±</strong>ï¼šä½¿ç”¨åŠ¨æ€è·¯ç”±æœºåˆ¶ï¼Œè‡ªé€‚åº”åœ°èšåˆç”¨æˆ·å…´è¶£</li><li><strong>åŒå¡”ç»“æ„</strong>ï¼šæ”¯æŒç¦»çº¿é¢„è®¡ç®—ç‰©å“åµŒå…¥</li><li><strong>é«˜æ•ˆè®¡ç®—</strong>ï¼šä¼˜åŒ–äº†è®¡ç®—æ•ˆç‡ï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-10" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-10" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ComirecDR</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ComirecDR(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    embedding_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    hidden_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    num_layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_interest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    dropout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-10" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-10" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>embedding_dim</td><td>int</td><td>Embedding ç»´åº¦</td><td>32</td></tr><tr><td>hidden_size</td><td>int</td><td>éšè—å±‚å¤§å°</td><td>128</td></tr><tr><td>num_layers</td><td>int</td><td>å±‚æ•°</td><td>2</td></tr><tr><td>n_interest</td><td>int</td><td>å…´è¶£æ•°é‡</td><td>4</td></tr><tr><td>dropout</td><td>float</td><td>Dropout ç‡</td><td>0.2</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°</td><td>0.02</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-10" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-10" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>å¯æ§å¤šå…´è¶£æ¨è</li><li>ç”¨æˆ·å…´è¶£å¤šæ ·åŒ–çš„åœºæ™¯</li><li>å¤§è§„æ¨¡æ¨èç³»ç»Ÿ</li></ul><h2 id="_12-comirecsa" tabindex="-1">12. ComirecSA <a class="header-anchor" href="#_12-comirecsa" aria-label="Permalink to â€œ12. ComirecSAâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-11" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-11" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>ComirecSAï¼ˆControllable Multi-Interest Recommendation with Self-Attentionï¼‰æ˜¯ Comirec çš„è‡ªæ³¨æ„åŠ›ç‰ˆæœ¬ï¼Œä½¿ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶å»ºæ¨¡ç”¨æˆ·å…´è¶£ã€‚</p><h3 id="æ ¸å¿ƒåŸç†-11" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-11" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šä½¿ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶æ•è·ç”¨æˆ·è¡Œä¸ºåºåˆ—ä¸­çš„ä¾èµ–å…³ç³»</li><li><strong>å¯æ§å¤šå…´è¶£</strong>ï¼šå…è®¸æ§åˆ¶ç”Ÿæˆçš„å…´è¶£æ•°é‡</li><li><strong>åŒå¡”ç»“æ„</strong>ï¼šæ”¯æŒç¦»çº¿é¢„è®¡ç®—ç‰©å“åµŒå…¥</li><li><strong>é«˜æ•ˆè®¡ç®—</strong>ï¼šä¼˜åŒ–äº†è®¡ç®—æ•ˆç‡ï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-11" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-11" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ComirecSA</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ComirecSA(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    embedding_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    num_heads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    num_layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    hidden_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_interest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    dropout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-11" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-11" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>user_features</td><td>list</td><td>ç”¨æˆ·ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>item_features</td><td>list</td><td>ç‰©å“ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>embedding_dim</td><td>int</td><td>Embedding ç»´åº¦</td><td>32</td></tr><tr><td>num_heads</td><td>int</td><td>æ³¨æ„åŠ›å¤´æ•°</td><td>4</td></tr><tr><td>num_layers</td><td>int</td><td>Transformer å±‚æ•°</td><td>2</td></tr><tr><td>hidden_size</td><td>int</td><td>éšè—å±‚å¤§å°</td><td>128</td></tr><tr><td>n_interest</td><td>int</td><td>å…´è¶£æ•°é‡</td><td>4</td></tr><tr><td>dropout</td><td>float</td><td>Dropout ç‡</td><td>0.2</td></tr><tr><td>temperature</td><td>float</td><td>æ¸©åº¦å‚æ•°</td><td>0.02</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-11" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-11" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>å¯æ§å¤šå…´è¶£æ¨è</li><li>é•¿åºåˆ—å…´è¶£å»ºæ¨¡</li><li>å¤§è§„æ¨¡æ¨èç³»ç»Ÿ</li></ul><h2 id="_13-æ¨¡å‹æ¯”è¾ƒ" tabindex="-1">13. æ¨¡å‹æ¯”è¾ƒ <a class="header-anchor" href="#_13-æ¨¡å‹æ¯”è¾ƒ" aria-label="Permalink to â€œ13. æ¨¡å‹æ¯”è¾ƒâ€">â€‹</a></h2><table tabindex="0"><thead><tr><th>æ¨¡å‹</th><th>å¤æ‚åº¦</th><th>è¡¨è¾¾èƒ½åŠ›</th><th>è®¡ç®—æ•ˆç‡</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>DSSM</td><td>ä½</td><td>ä¸­</td><td>é«˜</td><td>æ–‡æœ¬åŒ¹é…ã€å†·å¯åŠ¨</td></tr><tr><td>FaceBookDSSM</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>å¤§è§„æ¨¡æ¨èã€å¹¿å‘Šå¬å›</td></tr><tr><td>YoutubeDNN</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>è§†é¢‘æ¨èã€å†…å®¹æ¨è</td></tr><tr><td>YoutubeSBC</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>å¤§è§„æ¨¡æ¨èã€é‡‡æ ·åå·®åœºæ™¯</td></tr><tr><td>MIND</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>å¤šå…´è¶£æ¨èã€ç”µå•†åœºæ™¯</td></tr><tr><td>GRU4Rec</td><td>ä¸­</td><td>ä¸­</td><td>é«˜</td><td>ä¼šè¯æ¨èã€çŸ­åºåˆ—æ¨è</td></tr><tr><td>NARM</td><td>ä¸­</td><td>ä¸­</td><td>ä¸­</td><td>ä¼šè¯æ¨èã€å±€éƒ¨å…¨å±€å…´è¶£</td></tr><tr><td>SASRec</td><td>é«˜</td><td>é«˜</td><td>ä½</td><td>é•¿åºåˆ—æ¨èã€é¡ºåºæ¨è</td></tr><tr><td>SINE</td><td>é«˜</td><td>é«˜</td><td>ä¸­</td><td>ç¨€ç–å…´è¶£å»ºæ¨¡ã€å¤§è§„æ¨¡æ¨è</td></tr><tr><td>STAMP</td><td>ä½</td><td>ä¸­</td><td>é«˜</td><td>ä¼šè¯æ¨èã€çŸ­æœŸå…´è¶£</td></tr><tr><td>ComirecDR</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>å¯æ§å¤šå…´è¶£ã€å¤§è§„æ¨¡æ¨è</td></tr><tr><td>ComirecSA</td><td>é«˜</td><td>é«˜</td><td>ä¸­</td><td>å¯æ§å¤šå…´è¶£ã€é•¿åºåˆ—æ¨è</td></tr></tbody></table><h2 id="_14-ä½¿ç”¨å»ºè®®" tabindex="-1">14. ä½¿ç”¨å»ºè®® <a class="header-anchor" href="#_14-ä½¿ç”¨å»ºè®®" aria-label="Permalink to â€œ14. ä½¿ç”¨å»ºè®®â€">â€‹</a></h2><ol><li><p><strong>æ ¹æ®æ•°æ®ç‰¹ç‚¹é€‰æ‹©æ¨¡å‹</strong>ï¼š</p><ul><li>é•¿åºåˆ—æ•°æ®æ¨èä½¿ç”¨ SASRecã€ComirecSA</li><li>ä¼šè¯æ•°æ®æ¨èä½¿ç”¨ GRU4Recã€NARMã€STAMP</li><li>å¤šå…´è¶£åœºæ™¯æ¨èä½¿ç”¨ MINDã€ComirecDRã€ComirecSA</li></ul></li><li><p><strong>æ ¹æ®è®¡ç®—èµ„æºé€‰æ‹©æ¨¡å‹</strong>ï¼š</p><ul><li>è®¡ç®—èµ„æºæœ‰é™æ—¶æ¨èä½¿ç”¨ DSSMã€GRU4Recã€STAMP</li><li>è®¡ç®—èµ„æºå……è¶³æ—¶å¯ä»¥å°è¯•æ›´å¤æ‚çš„æ¨¡å‹ï¼Œå¦‚ SASRecã€SINE</li></ul></li><li><p><strong>è€ƒè™‘ä¸šåŠ¡éœ€æ±‚</strong>ï¼š</p><ul><li>éœ€è¦å¯æ§å¤šå…´è¶£æ—¶æ¨èä½¿ç”¨ ComirecDRã€ComirecSA</li><li>éœ€è¦å¤„ç†ç¨€ç–å…´è¶£æ—¶æ¨èä½¿ç”¨ SINE</li><li>éœ€è¦å¤„ç†é‡‡æ ·åå·®æ—¶æ¨èä½¿ç”¨ YoutubeSBC</li></ul></li><li><p><strong>å°è¯•å¤šç§å¬å›ç­–ç•¥èåˆ</strong>ï¼š</p><ul><li>ä¸åŒå¬å›æ¨¡å‹å¯èƒ½æ•è·ä¸åŒçš„ç”¨æˆ·å…´è¶£ï¼Œæ¨¡å‹èåˆå¯ä»¥æé«˜æœ€ç»ˆå¬å›æ•ˆæœ</li><li>å¯ä»¥ç»“åˆå†…å®¹å¬å›ã€ååŒå¬å›ç­‰å¤šç§å¬å›ç­–ç•¥</li></ul></li></ol><h2 id="_15-ä»£ç ç¤ºä¾‹-å®Œæ•´çš„å¬å›æ¨¡å‹è®­ç»ƒæµç¨‹" tabindex="-1">15. ä»£ç ç¤ºä¾‹ï¼šå®Œæ•´çš„å¬å›æ¨¡å‹è®­ç»ƒæµç¨‹ <a class="header-anchor" href="#_15-ä»£ç ç¤ºä¾‹-å®Œæ•´çš„å¬å›æ¨¡å‹è®­ç»ƒæµç¨‹" aria-label="Permalink to â€œ15. ä»£ç ç¤ºä¾‹ï¼šå®Œæ•´çš„å¬å›æ¨¡å‹è®­ç»ƒæµç¨‹â€">â€‹</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DSSM</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.trainers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MatchTrainer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.utils.data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MatchDataGenerator</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.basic.features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SparseFeature, DenseFeature</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. å®šä¹‰ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DenseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gender&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;item_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;category&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. å‡†å¤‡æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å‡è®¾ x å’Œ y æ˜¯å·²ç»å¤„ç†å¥½çš„ç‰¹å¾å’Œæ ‡ç­¾æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># x åŒ…å«ç”¨æˆ·ç‰¹å¾å’Œç‰©å“ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: user_id_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: age_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;gender&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: gender_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;item_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: item_id_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;category&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: category_data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> label_data  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç‚¹å‡»/ä¸ç‚¹å‡»æ ‡ç­¾</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æµ‹è¯•ç”¨æˆ·æ•°æ®å’Œæ‰€æœ‰ç‰©å“æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_test_user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: test_user_id_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: test_age_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;gender&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: test_gender_data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_all_item </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;item_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: all_item_id_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;category&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: all_item_category_data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. åˆ›å»ºæ•°æ®ç”Ÿæˆå™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MatchDataGenerator(x, y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">train_dl, test_dl, item_dl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dg.generate_dataloader(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    x_test_user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_test_user,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    x_all_item</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_all_item,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    batch_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    num_workers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DSSM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prelu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    item_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prelu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. åˆ›å»ºè®­ç»ƒå™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MatchTrainer(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 0: point-wise, 1: pair-wise, 2: list-wise</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    optimizer_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;lr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;weight_decay&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_epoch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    earlystop_patience</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cuda:0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    model_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;saved/dssm&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 6. è®­ç»ƒæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer.fit(train_dl, test_dl)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 7. å¯¼å‡ºONNXæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯¼å‡ºç”¨æˆ·å¡”</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer.export_onnx(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_tower.onnx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯¼å‡ºç‰©å“å¡”</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer.export_onnx(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;item_tower.onnx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;item&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 8. å‘é‡å¬å›ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”Ÿæˆç”¨æˆ·åµŒå…¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_embeddings </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> trainer.inference_embedding(model, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data_loader</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test_dl, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">model_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;saved/dssm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”Ÿæˆç‰©å“åµŒå…¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_embeddings </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> trainer.inference_embedding(model, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;item&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data_loader</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_dl, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">model_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;saved/dssm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ Annoy æˆ– Faiss è¿›è¡Œå‘é‡ç´¢å¼•å’Œå¬å›</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿™é‡Œä»¥ Annoy ä¸ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> annoy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AnnoyIndex</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AnnoyIndex(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;angular&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 64 æ˜¯åµŒå…¥ç»´åº¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i, embedding </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(item_embeddings):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    index.add_item(i, embedding.tolist())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.build(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 10æ£µæ ‘</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¬å›ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_idx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_emb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user_embeddings[user_idx].tolist()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">recall_results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> index.get_nns_by_vector(user_emb, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¬å› top 10 ç‰©å“</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;User </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_idx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> å¬å›çš„ç‰©å“: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">recall_results</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## 16. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### Q: å¦‚ä½•å¤„ç†å¤§è§„æ¨¡ç‰©å“é›†ï¼Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A: å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ä½¿ç”¨åŒå¡”ç»“æ„ï¼Œæ”¯æŒç¦»çº¿é¢„è®¡ç®—ç‰©å“åµŒå…¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ä½¿ç”¨è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢åº“ï¼ˆå¦‚ Annoyã€Faissï¼‰åŠ é€Ÿå‘é‡æ£€ç´¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> é‡‡ç”¨åˆ†å±‚å¬å›ç­–ç•¥ï¼Œå…ˆç²—å¬å›å†ç²¾å¬å›</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### Q: å¦‚ä½•å¤„ç†å†·å¯åŠ¨é—®é¢˜ï¼Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A: å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> å¯¹äºæ–°ç”¨æˆ·ï¼Œä½¿ç”¨åŸºäºå†…å®¹çš„å¬å›</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> å¯¹äºæ–°ç‰©å“ï¼Œä½¿ç”¨ååŒè¿‡æ»¤æˆ–åŸºäºå†…å®¹çš„å¬å›</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ä½¿ç”¨è¿ç§»å­¦ä¹ ï¼Œä»å…¶ä»–ç›¸å…³é¢†åŸŸè¿ç§»çŸ¥è¯†</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### Q: å¦‚ä½•è¯„ä¼°å¬å›æ¨¡å‹çš„æ•ˆæœï¼Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A: å¸¸ç”¨çš„å¬å›è¯„ä¼°æŒ‡æ ‡åŒ…æ‹¬ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Recall</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kï¼šå‰ K ä¸ªå¬å›ç»“æœä¸­ç›¸å…³ç‰©å“çš„æ¯”ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Precision</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kï¼šå‰ K ä¸ªå¬å›ç»“æœä¸­ç›¸å…³ç‰©å“çš„æ¯”ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NDCG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kï¼šè€ƒè™‘æ’åºçš„å¬å›è´¨é‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Hit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kï¼šæ˜¯å¦å¬å›è‡³å°‘ä¸€ä¸ªç›¸å…³ç‰©å“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MRR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kï¼šå¹³å‡å€’æ•°æ’å</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### Q: å¦‚ä½•é€‰æ‹©åˆé€‚çš„è´Ÿé‡‡æ ·ç­–ç•¥ï¼Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A: å¸¸è§çš„è´Ÿé‡‡æ ·ç­–ç•¥åŒ…æ‹¬ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> éšæœºè´Ÿé‡‡æ ·ï¼šç®€å•é«˜æ•ˆï¼Œä½†å¯èƒ½é‡‡æ ·åˆ°ä¸ç›¸å…³çš„ç‰©å“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> åŸºäºæµè¡Œåº¦çš„è´Ÿé‡‡æ ·ï¼šæ ¹æ®ç‰©å“æµè¡Œåº¦é‡‡æ ·ï¼Œæ›´ç¬¦åˆå®é™…æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> å›°éš¾è´Ÿé‡‡æ ·ï¼šé‡‡æ ·ä¸æ­£æ ·æœ¬ç›¸ä¼¼çš„è´Ÿæ ·æœ¬ï¼Œæé«˜æ¨¡å‹çš„åŒºåˆ†èƒ½åŠ›</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> å¯¹æ¯”å­¦ä¹ ä¸­çš„è´Ÿé‡‡æ ·ï¼šå¦‚ MoCoã€SimCLR ç­‰æ–¹æ³•</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### Q: å¦‚ä½•ä¼˜åŒ–å¬å›æ¨¡å‹çš„æ€§èƒ½ï¼Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A: å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> å¢åŠ æ¨¡å‹æ·±åº¦å’Œå®½åº¦ï¼Œæé«˜æ¨¡å‹è¡¨è¾¾èƒ½åŠ›</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ä½¿ç”¨æ›´é«˜çº§çš„ç‰¹å¾å·¥ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ä¼˜åŒ–è´Ÿé‡‡æ ·ç­–ç•¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> å°è¯•æ¨¡å‹èåˆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> è°ƒæ•´æ¸©åº¦å‚æ•°ï¼Œä¼˜åŒ–ç›¸ä¼¼åº¦åˆ†å¸ƒ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## 17. å¬å›æ¨¡å‹éƒ¨ç½²å»ºè®®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ç¦»çº¿é¢„è®¡ç®—</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ï¼šå¯¹äºåŒå¡”æ¨¡å‹ï¼Œç¦»çº¿é¢„è®¡ç®—ç‰©å“åµŒå…¥ï¼Œå‡å°‘åœ¨çº¿è®¡ç®—é‡</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">å‘é‡ç´¢å¼•</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ï¼šä½¿ç”¨é«˜æ•ˆçš„å‘é‡ç´¢å¼•åº“ï¼ˆå¦‚ Faissï¼‰å­˜å‚¨ç‰©å“åµŒå…¥ï¼ŒåŠ é€Ÿåœ¨çº¿æ£€ç´¢</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">åˆ†å±‚éƒ¨ç½²</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ï¼šé‡‡ç”¨åˆ†å±‚å¬å›æ¶æ„ï¼Œå…ˆä½¿ç”¨ç®€å•æ¨¡å‹ç²—å¬å›ï¼Œå†ä½¿ç”¨å¤æ‚æ¨¡å‹ç²¾å¬å›</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ç¼“å­˜æœºåˆ¶</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ï¼šç¼“å­˜é«˜é¢‘ç”¨æˆ·çš„å¬å›ç»“æœï¼Œå‡å°‘é‡å¤è®¡ç®—</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">å®æ—¶æ›´æ–°</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ï¼šå®šæœŸæ›´æ–°ç‰©å“åµŒå…¥ï¼Œä¿è¯å¬å›ç»“æœçš„æ—¶æ•ˆæ€§</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">B æµ‹è¯•</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ï¼šé€šè¿‡ A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">B æµ‹è¯•éªŒè¯ä¸åŒå¬å›ç­–ç•¥çš„æ•ˆæœ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">å¬å›æ¨¡å‹æ˜¯æ¨èç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œé€‰æ‹©åˆé€‚çš„å¬å›æ¨¡å‹å¹¶è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥æ˜¾è‘—æé«˜æ¨èç³»ç»Ÿçš„æ•´ä½“æ•ˆæœã€‚Torch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RecHub æä¾›äº†ä¸°å¯Œçš„å¬å›æ¨¡å‹ï¼Œæ¶µç›–äº†ä¸åŒçš„å¬å›ç­–ç•¥ï¼Œæ–¹ä¾¿å¼€å‘è€…æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©å’Œä½¿ç”¨ã€‚</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/torch-rechub/zh/models/ranking.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>æ’åºæ¨¡å‹ (Ranking)</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/torch-rechub/zh/models/mtl.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>å¤šä»»åŠ¡æ¨¡å‹ (MTL)</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_api.md\":\"DJkjBqY1\",\"blog_hllm_reproduction.md\":\"ChKe_XN3\",\"blog_match.md\":\"BedaiOiS\",\"blog_rank.md\":\"CjbEHKm4\",\"cache_api-basic.md\":\"CxBzBbeT\",\"cache_api-models.md\":\"_Nh38IC9\",\"cache_api-trainers.md\":\"qTIo5JV-\",\"cache_api-utils.md\":\"DMICx_Eb\",\"cache_hllm_reproduction.md\":\"DJwx9hU5\",\"cache_hstu_reproduction.md\":\"bQOULsOs\",\"cache_match.md\":\"BcCUbgKz\",\"cache_rank.md\":\"DiUyOquO\",\"cache_å‚è€ƒèµ„æ–™.md\":\"-t2bObt5\",\"community_changelog.md\":\"DI6L-6X3\",\"community_contributing.md\":\"xtydGDVG\",\"community_faq.md\":\"B2o2gfCA\",\"contributing.md\":\"B4CsM6F1\",\"core_data.md\":\"Bubnqsmb\",\"core_evaluation.md\":\"DLBJ7YIh\",\"core_features.md\":\"D6cNP9Y0\",\"core_intro.md\":\"Lk2AEgiP\",\"guide_install.md\":\"BKEyLNSv\",\"guide_intro.md\":\"CcqgfzKq\",\"guide_quick_start.md\":\"BafQ4m9I\",\"index.md\":\"BWkYO4CN\",\"introduction.md\":\"DCcoFN4C\",\"manual_api-reference_basic.md\":\"mdpaLngf\",\"manual_api-reference_models.md\":\"ClWTbT_c\",\"manual_api-reference_trainers.md\":\"DMq3Y4lN\",\"manual_api-reference_utils.md\":\"CwgYI4XX\",\"manual_faq.md\":\"Bt4nAaSb\",\"manual_getting-started.md\":\"D1tlYLXA\",\"manual_installation.md\":\"BEi4-tgX\",\"manual_tutorials_matching.md\":\"Drdc8zHk\",\"manual_tutorials_multi-task.md\":\"DUzIv4Pd\",\"manual_tutorials_ranking.md\":\"PE87Y6VF\",\"models_intro.md\":\"C8lRqRQK\",\"models_matching.md\":\"COwPnsEO\",\"models_mtl.md\":\"sP0ImAnD\",\"models_ranking.md\":\"D7MJwMCh\",\"serving_demo.md\":\"BR_nJdJp\",\"serving_intro.md\":\"Dbvd1QrA\",\"serving_onnx.md\":\"DrRUe4sH\",\"serving_vector_index.md\":\"D24mwGrX\",\"tools_callbacks.md\":\"Bs7UMuyY\",\"tools_intro.md\":\"dsxQIeoA\",\"tools_tracking.md\":\"ZPTrqYAs\",\"tools_visualization.md\":\"DDQwCOuE\",\"tutorials_ctr.md\":\"C2DkoDG-\",\"tutorials_intro.md\":\"6_GHNz3c\",\"tutorials_pipeline.md\":\"Cx5gWVpZ\",\"tutorials_retrieval.md\":\"QT31LYiv\",\"zh_api_api.md\":\"DVI6Mi62\",\"zh_community_changelog.md\":\"JvWSlN_3\",\"zh_community_contributing.md\":\"XG8ponp6\",\"zh_community_faq.md\":\"BpQXxVSl\",\"zh_core_data.md\":\"CvO2Pken\",\"zh_core_evaluation.md\":\"DR3CPkh0\",\"zh_core_features.md\":\"C3UgMFjz\",\"zh_core_intro.md\":\"C5-GowRG\",\"zh_guide_install.md\":\"BjMbjNWH\",\"zh_guide_intro.md\":\"Drdzv92U\",\"zh_guide_quick_start.md\":\"D3UL5FjI\",\"zh_index.md\":\"DvSpQJI5\",\"zh_models_generative.md\":\"B9Hc2oiC\",\"zh_models_intro.md\":\"Ckt95GI6\",\"zh_models_matching.md\":\"BPmlhh3Q\",\"zh_models_mtl.md\":\"CAMx5Qxv\",\"zh_models_ranking.md\":\"Cnb4xZjQ\",\"zh_serving_demo.md\":\"DUDfCT9o\",\"zh_serving_intro.md\":\"W9cxABun\",\"zh_serving_onnx.md\":\"BEGPf9Qt\",\"zh_serving_vector_index.md\":\"DmaohZpJ\",\"zh_tools_callbacks.md\":\"3an-IhME\",\"zh_tools_intro.md\":\"Chd53O0c\",\"zh_tools_tracking.md\":\"BBve1TKh\",\"zh_tools_visualization.md\":\"BjvRwYtC\",\"zh_tutorials_ctr.md\":\"DP55NTbQ\",\"zh_tutorials_intro.md\":\"2HyFqT62\",\"zh_tutorials_pipeline.md\":\"Byb65Sp2\",\"zh_tutorials_retrieval.md\":\"BnX5iygo\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"torch-rechub\",\"description\":\"A Lighting Pytorch Framework for Recommendation Models, Easy-to-use and Easy-to-extend.\",\"base\":\"/torch-rechub/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/img/logo.png\",\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/datawhalechina/torch-rechub\"}]},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\",\"themeConfig\":{\"nav\":[{\"text\":\"ğŸ  Home\",\"link\":\"/\"},{\"text\":\"ğŸš€ Getting Started\",\"link\":\"/guide/intro\"},{\"text\":\"âš™ï¸ Core\",\"link\":\"/core/intro\"},{\"text\":\"ğŸ° Models\",\"link\":\"/models/intro\"},{\"text\":\"ğŸ› ï¸ Tools\",\"link\":\"/tools/intro\"},{\"text\":\"ğŸš€ Serving\",\"link\":\"/serving/intro\"},{\"text\":\"ğŸ“– Tutorials\",\"link\":\"/tutorials/intro\"},{\"text\":\"â„¹ï¸ API\",\"link\":\"/api/api\"},{\"text\":\"ğŸ‘¥ Community\",\"link\":\"/community/faq\"}],\"sidebar\":{\"/guide/\":[{\"text\":\"ğŸš€ Getting Started\",\"items\":[{\"text\":\"Overview\",\"link\":\"/guide/intro\"},{\"text\":\"Installation\",\"link\":\"/guide/install\"},{\"text\":\"Quick Start\",\"link\":\"/guide/quick_start\"}]}],\"/core/\":[{\"text\":\"âš™ï¸ Core Components\",\"items\":[{\"text\":\"Overview\",\"link\":\"/core/intro\"},{\"text\":\"Feature Columns\",\"link\":\"/core/features\"},{\"text\":\"Data Pipeline\",\"link\":\"/core/data\"},{\"text\":\"Training & Eval\",\"link\":\"/core/evaluation\"}]}],\"/models/\":[{\"text\":\"ğŸ° Model Zoo\",\"items\":[{\"text\":\"Overview\",\"link\":\"/models/intro\"},{\"text\":\"Ranking Models\",\"link\":\"/models/ranking\"},{\"text\":\"Matching Models\",\"link\":\"/models/matching\"},{\"text\":\"Multi-Task Models\",\"link\":\"/models/mtl\"},{\"text\":\"Generative Models\",\"link\":\"/models/generative\"}]}],\"/tools/\":[{\"text\":\"ğŸ› ï¸ Dev Tools\",\"items\":[{\"text\":\"Overview\",\"link\":\"/tools/intro\"},{\"text\":\"Visualization\",\"link\":\"/tools/visualization\"},{\"text\":\"Experiment Tracking\",\"link\":\"/tools/tracking\"},{\"text\":\"Callbacks\",\"link\":\"/tools/callbacks\"}]}],\"/serving/\":[{\"text\":\"ğŸš€ Serving\",\"items\":[{\"text\":\"Overview\",\"link\":\"/serving/intro\"},{\"text\":\"ONNX & Quantization\",\"link\":\"/serving/onnx\"},{\"text\":\"Vector Indexing\",\"link\":\"/serving/vector_index\"},{\"text\":\"Serving Demo\",\"link\":\"/serving/demo\"}]}],\"/tutorials/\":[{\"text\":\"ğŸ“– Tutorials\",\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/intro\"},{\"text\":\"CTR Pipeline\",\"link\":\"/tutorials/ctr\"},{\"text\":\"Retrieval System\",\"link\":\"/tutorials/retrieval\"},{\"text\":\"Big Data Pipeline\",\"link\":\"/tutorials/pipeline\"}]}],\"/api/\":[{\"text\":\"â„¹ï¸ API Reference\",\"items\":[{\"text\":\"Main API\",\"link\":\"/api/api\"}]}],\"/community/\":[{\"text\":\"ğŸ“˜ Community\",\"items\":[{\"text\":\"FAQ\",\"link\":\"/community/faq\"},{\"text\":\"Contributing\",\"link\":\"/community/contributing\"},{\"text\":\"Changelog\",\"link\":\"/community/changelog\"}]}]}}},\"zh\":{\"label\":\"ä¸­æ–‡\",\"lang\":\"zh-CN\",\"link\":\"/zh/\",\"themeConfig\":{\"nav\":[{\"text\":\"ğŸ  é¦–é¡µ\",\"link\":\"/zh/\"},{\"text\":\"ğŸš€ å¿«é€Ÿå…¥é—¨\",\"link\":\"/zh/guide/intro\"},{\"text\":\"âš™ï¸ æ ¸å¿ƒç»„ä»¶\",\"link\":\"/zh/core/intro\"},{\"text\":\"ğŸ° æ¨¡å‹åº“\",\"link\":\"/zh/models/intro\"},{\"text\":\"ğŸ› ï¸ ç ”å‘å·¥å…·\",\"link\":\"/zh/tools/intro\"},{\"text\":\"ğŸš€ ç”Ÿäº§éƒ¨ç½²\",\"link\":\"/zh/serving/intro\"},{\"text\":\"ğŸ“– åœºæ™¯æ•™ç¨‹\",\"link\":\"/zh/tutorials/intro\"},{\"text\":\"â„¹ï¸ API\",\"link\":\"/zh/api/api\"},{\"text\":\"ğŸ‘¥ ç¤¾åŒº\",\"link\":\"/zh/community/faq\"}],\"sidebar\":{\"/zh/guide/\":[{\"text\":\"ğŸš€ å¿«é€Ÿå…¥é—¨\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/guide/intro\"},{\"text\":\"å®‰è£…æŒ‡å—\",\"link\":\"/zh/guide/install\"},{\"text\":\"3åˆ†é’Ÿä¸Šæ‰‹\",\"link\":\"/zh/guide/quick_start\"}]}],\"/zh/core/\":[{\"text\":\"âš™ï¸ æ ¸å¿ƒç»„ä»¶\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/core/intro\"},{\"text\":\"ç‰¹å¾å®šä¹‰ (Features)\",\"link\":\"/zh/core/features\"},{\"text\":\"æ•°æ®æµæ°´çº¿ (Data)\",\"link\":\"/zh/core/data\"},{\"text\":\"è®­ç»ƒä¸è¯„ä¼° (Eval)\",\"link\":\"/zh/core/evaluation\"}]}],\"/zh/models/\":[{\"text\":\"ğŸ° æ¨¡å‹åº“\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/models/intro\"},{\"text\":\"æ’åºæ¨¡å‹ (Ranking)\",\"link\":\"/zh/models/ranking\"},{\"text\":\"å¬å›æ¨¡å‹ (Matching)\",\"link\":\"/zh/models/matching\"},{\"text\":\"å¤šä»»åŠ¡æ¨¡å‹ (MTL)\",\"link\":\"/zh/models/mtl\"},{\"text\":\"ç”Ÿæˆå¼æ¨¡å‹ (Generative)\",\"link\":\"/zh/models/generative\"}]}],\"/zh/tools/\":[{\"text\":\"ğŸ› ï¸ ç ”å‘å·¥å…·\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/tools/intro\"},{\"text\":\"å¯è§†åŒ–ç›‘æ§\",\"link\":\"/zh/tools/visualization\"},{\"text\":\"å®éªŒè¿½è¸ª\",\"link\":\"/zh/tools/tracking\"},{\"text\":\"å›è°ƒå‡½æ•°\",\"link\":\"/zh/tools/callbacks\"}]}],\"/zh/serving/\":[{\"text\":\"ğŸš€ ç”Ÿäº§éƒ¨ç½²\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/serving/intro\"},{\"text\":\"ONNX å¯¼å‡ºä¸é‡åŒ–\",\"link\":\"/zh/serving/onnx\"},{\"text\":\"å‘é‡æ£€ç´¢å°è£…\",\"link\":\"/zh/serving/vector_index\"},{\"text\":\"åœ¨çº¿æœåŠ¡ç¤ºä¾‹\",\"link\":\"/zh/serving/demo\"}]}],\"/zh/tutorials/\":[{\"text\":\"ğŸ“– åœºæ™¯æ•™ç¨‹\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/tutorials/intro\"},{\"text\":\"CTR é¢„ä¼°æµç¨‹\",\"link\":\"/zh/tutorials/ctr\"},{\"text\":\"å¬å›ç³»ç»Ÿæ­å»º\",\"link\":\"/zh/tutorials/retrieval\"},{\"text\":\"å…¨é“¾è·¯æµæ°´çº¿\",\"link\":\"/zh/tutorials/pipeline\"}]}],\"/zh/api/\":[{\"text\":\"â„¹ï¸ API Reference\",\"items\":[{\"text\":\"API å‚è€ƒ\",\"link\":\"/zh/api/api\"}]}],\"/zh/community/\":[{\"text\":\"ğŸ“˜ ç¤¾åŒºä¿¡æ¯\",\"items\":[{\"text\":\"å¸¸è§é—®é¢˜ (FAQ)\",\"link\":\"/zh/community/faq\"},{\"text\":\"è´¡çŒ®æŒ‡å— (Contributing)\",\"link\":\"/zh/community/contributing\"},{\"text\":\"ç‰ˆæœ¬æ—¥å¿— (Changelog)\",\"link\":\"/zh/community/changelog\"}]}]}}}},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>