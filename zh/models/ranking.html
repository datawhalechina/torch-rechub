<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ’åºæ¨¡å‹ | torch-rechub</title>
    <meta name="description" content="Torch-RecHub æ’åºæ¨¡å‹è¯¦ç»†ä»‹ç»">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/torch-rechub/assets/style.Dnbe36Wi.css" as="style">
    <link rel="preload stylesheet" href="/torch-rechub/vp-icons.css" as="style">
    
    <script type="module" src="/torch-rechub/assets/app.fMjXe8cR.js"></script>
    <link rel="preload" href="/torch-rechub/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/torch-rechub/assets/chunks/theme.CGwmo9Xb.js">
    <link rel="modulepreload" href="/torch-rechub/assets/chunks/framework.BiSKXDrp.js">
    <link rel="modulepreload" href="/torch-rechub/assets/zh_models_ranking.md.Cnb4xZjQ.lean.js">
    <link rel="icon" href="/torch-rechub/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle has-sidebar" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/torch-rechub/zh/" data-v-1e38c6bc><!--[--><!--]--><!--[--><img class="VPImage logo" src="/torch-rechub/img/logo.png" alt data-v-8426fc1a><!--]--><span data-v-1e38c6bc>torch-rechub</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!--[--><!----><div id="local-search"><button type="button" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><span class="vpi-search DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ  é¦–é¡µ</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/guide/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸš€ å¿«é€Ÿå…¥é—¨</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/core/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>âš™ï¸ æ ¸å¿ƒç»„ä»¶</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/models/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ° æ¨¡å‹åº“</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/tools/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ› ï¸ ç ”å‘å·¥å…·</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/serving/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸš€ ç”Ÿäº§éƒ¨ç½²</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/tutorials/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ“– åœºæ™¯æ•™ç¨‹</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/api/api.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>â„¹ï¸ API</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/community/faq.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ‘¥ ç¤¾åŒº</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-70946a35 data-v-4c1766e2 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-42cb505d><span class="text" data-v-42cb505d><span class="vpi-languages option-icon" data-v-42cb505d></span><!----><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="items" data-v-4c1766e2><p class="title" data-v-4c1766e2>ä¸­æ–‡</p><!--[--><div class="VPMenuLink" data-v-4c1766e2 data-v-faf5b206><a class="VPLink link" href="/torch-rechub/models/ranking.html" lang="en" data-v-faf5b206><!--[--><span data-v-faf5b206>English</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/datawhalechina/torch-rechub" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="group translations" data-v-bf2fac68><p class="trans-title" data-v-bf2fac68>ä¸­æ–‡</p><!--[--><div class="VPMenuLink" data-v-bf2fac68 data-v-faf5b206><a class="VPLink link" href="/torch-rechub/models/ranking.html" lang="en" data-v-faf5b206><!--[--><span data-v-faf5b206>English</span><!--]--></a></div><!--]--></div><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/datawhalechina/torch-rechub" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-db738f89><span class="vpi-align-left menu-icon" data-v-db738f89></span><span class="menu-text" data-v-db738f89>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1df9f90f data-v-af661f50><div class="curtain" data-v-af661f50></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-af661f50><span class="visually-hidden" id="sidebar-aria-label" data-v-af661f50> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 has-active" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>ğŸ° æ¨¡å‹åº“</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/intro.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>å¯¼è§ˆ (Overview)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/ranking.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>æ’åºæ¨¡å‹ (Ranking)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/matching.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>å¬å›æ¨¡å‹ (Matching)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/mtl.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>å¤šä»»åŠ¡æ¨¡å‹ (MTL)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/generative.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>ç”Ÿæˆå¼æ¨¡å‹ (Generative)</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-sidebar has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _torch-rechub_zh_models_ranking" data-v-7011f0d8><div><h1 id="æ’åºæ¨¡å‹" tabindex="-1">æ’åºæ¨¡å‹ <a class="header-anchor" href="#æ’åºæ¨¡å‹" aria-label="Permalink to â€œæ’åºæ¨¡å‹â€">â€‹</a></h1><p>æ’åºæ¨¡å‹æ˜¯æ¨èç³»ç»Ÿä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼Œç”¨äºé¢„æµ‹ç”¨æˆ·å¯¹ç‰©å“çš„ç‚¹å‡»ç‡æˆ–åå¥½åˆ†æ•°ï¼Œä»è€Œå¯¹å¬å›çš„å€™é€‰é›†è¿›è¡Œç²¾æ’åºã€‚Torch-RecHub æä¾›äº†å¤šç§å…ˆè¿›çš„æ’åºæ¨¡å‹ï¼Œæ¶µç›–äº†ä¸åŒçš„ç‰¹å¾å¤„ç†å’Œå»ºæ¨¡æ–¹å¼ã€‚</p><h2 id="_1-widedeep" tabindex="-1">1. WideDeep <a class="header-anchor" href="#_1-widedeep" aria-label="Permalink to â€œ1. WideDeepâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>WideDeep æ˜¯ä¸€ç§ç»“åˆäº†çº¿æ€§æ¨¡å‹ï¼ˆWide éƒ¨åˆ†ï¼‰å’Œæ·±åº¦ç¥ç»ç½‘ç»œï¼ˆDeep éƒ¨åˆ†ï¼‰çš„æ··åˆæ¨¡å‹ï¼Œæ—¨åœ¨åŒæ—¶åˆ©ç”¨çº¿æ€§æ¨¡å‹çš„è®°å¿†èƒ½åŠ›å’Œæ·±åº¦æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Cheng, Heng-Tze, et al. &quot;Wide &amp; deep learning for recommender systems.&quot; Proceedings of the 1st workshop on deep learning for recommender systems. 2016.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>Wide éƒ¨åˆ†</strong>ï¼šçº¿æ€§æ¨¡å‹ï¼Œä½¿ç”¨äº¤å‰ç‰¹å¾ï¼Œæ“…é•¿æ•è·è®°å¿†æ•ˆåº”</li><li><strong>Deep éƒ¨åˆ†</strong>ï¼šæ·±åº¦ç¥ç»ç½‘ç»œï¼Œä½¿ç”¨ Embedding å±‚å’Œå…¨è¿æ¥å±‚ï¼Œæ“…é•¿æ•è·æ³›åŒ–æ•ˆåº”</li><li><strong>è”åˆè®­ç»ƒ</strong>ï¼šWide éƒ¨åˆ†å’Œ Deep éƒ¨åˆ†åŒæ—¶è®­ç»ƒï¼Œè¾“å‡ºç»“æœé€šè¿‡ sigmoid å‡½æ•°ç»“åˆ</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WideDeep</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dense_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [DenseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), DenseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;income&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;city&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gender&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WideDeep(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    wide_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>wide_features</td><td>list</td><td>Wide éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>mlp_params</td><td>dict</td><td>æ·±åº¦ç¥ç»ç½‘ç»œå‚æ•°ï¼ŒåŒ…å« dimsã€dropoutã€activation ç­‰</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>åŸºç¡€æ’åºä»»åŠ¡</li><li>éœ€è¦åŒæ—¶åˆ©ç”¨è®°å¿†å’Œæ³›åŒ–èƒ½åŠ›çš„åœºæ™¯</li><li>ç‰¹å¾å·¥ç¨‹èµ„æºæœ‰é™çš„åœºæ™¯</li></ul><h2 id="_2-deepfm" tabindex="-1">2. DeepFM <a class="header-anchor" href="#_2-deepfm" aria-label="Permalink to â€œ2. DeepFMâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-1" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-1" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>DeepFM æ˜¯ä¸€ç§ç»“åˆäº†å› å­åˆ†è§£æœºï¼ˆFMï¼‰å’Œæ·±åº¦ç¥ç»ç½‘ç»œçš„æ¨¡å‹ï¼Œèƒ½å¤ŸåŒæ—¶æ•è·ä½é˜¶å’Œé«˜é˜¶ç‰¹å¾äº¤äº’ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-1" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-1" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Guo, Huifeng, et al. &quot;DeepFM: a factorization-machine based neural network for CTR prediction.&quot; Proceedings of the 26th international joint conference on artificial intelligence. 2017.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-1" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-1" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>FM éƒ¨åˆ†</strong>ï¼šæ•è·äºŒé˜¶ç‰¹å¾äº¤äº’ï¼Œå…·æœ‰çº¿æ€§å¤æ‚åº¦</li><li><strong>Deep éƒ¨åˆ†</strong>ï¼šé€šè¿‡ç¥ç»ç½‘ç»œæ•è·é«˜é˜¶ç‰¹å¾äº¤äº’</li><li><strong>å…±äº« Embedding</strong>ï¼šFM éƒ¨åˆ†å’Œ Deep éƒ¨åˆ†å…±äº«ç‰¹å¾ Embeddingï¼Œå‡å°‘å‚æ•°æ•°é‡</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-1" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-1" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DeepFM</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DeepFM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    fm_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-1" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-1" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>fm_features</td><td>list</td><td>FM éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>mlp_params</td><td>dict</td><td>æ·±åº¦ç¥ç»ç½‘ç»œå‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-1" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-1" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ç‰¹å¾äº¤äº’é‡è¦çš„åœºæ™¯</li><li>éœ€è¦åŒæ—¶æ•è·ä½é˜¶å’Œé«˜é˜¶ç‰¹å¾äº¤äº’çš„åœºæ™¯</li><li>ç‚¹å‡»ç‡é¢„æµ‹ä»»åŠ¡</li></ul><h2 id="_3-dcn" tabindex="-1">3. DCN <a class="header-anchor" href="#_3-dcn" aria-label="Permalink to â€œ3. DCNâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-2" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-2" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>DCNï¼ˆDeep &amp; Cross Networkï¼‰æ˜¯ä¸€ç§æ˜¾å¼å­¦ä¹ ç‰¹å¾äº¤å‰çš„æ¨¡å‹ï¼Œé€šè¿‡äº¤å‰ç½‘ç»œï¼ˆCross Networkï¼‰æ˜¾å¼æ•è·é«˜é˜¶ç‰¹å¾äº¤äº’ï¼ŒåŒæ—¶ä¿æŒçº¿æ€§çš„è®¡ç®—å¤æ‚åº¦ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-2" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-2" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Wang, Ruoxi, et al. &quot;Deep &amp; cross network for ad click predictions.&quot; Proceedings of the ADKDD&#39;17. 2017.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-2" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-2" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>Cross Network</strong>ï¼šæ˜¾å¼å­¦ä¹ é«˜é˜¶ç‰¹å¾äº¤å‰ï¼Œæ¯å±‚è¾“å‡ºä¸ºï¼š $$x_{l+1} = x_0 x_l^T w_l + b_l + x_l$$</li><li><strong>Deep Network</strong>ï¼šæ·±åº¦ç¥ç»ç½‘ç»œï¼Œæ•è·éçº¿æ€§ç‰¹å¾äº¤äº’</li><li><strong>è”åˆè®­ç»ƒ</strong>ï¼šCross Network å’Œ Deep Network å¹¶è¡Œè®¡ç®—ï¼Œç»“æœæ‹¼æ¥åé€šè¿‡å…¨è¿æ¥å±‚è¾“å‡º</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-2" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-2" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DCN</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DCN(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    cross_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    cross_num_layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-2" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-2" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>cross_features</td><td>list</td><td>Cross éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>mlp_params</td><td>dict</td><td>æ·±åº¦ç¥ç»ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>cross_num_layers</td><td>int</td><td>Cross Network çš„å±‚æ•°</td><td>3</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-2" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-2" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>éœ€è¦æ˜¾å¼ç‰¹å¾äº¤å‰çš„åœºæ™¯</li><li>è®¡ç®—èµ„æºæœ‰é™çš„åœºæ™¯</li><li>ç‚¹å‡»ç‡é¢„æµ‹ä»»åŠ¡</li></ul><h2 id="_4-dcnv2" tabindex="-1">4. DCNv2 <a class="header-anchor" href="#_4-dcnv2" aria-label="Permalink to â€œ4. DCNv2â€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-3" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-3" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>DCNv2 æ˜¯ DCN çš„å¢å¼ºç‰ˆæœ¬ï¼Œå¼•å…¥äº†ç‰¹å¾é€‰æ‹©å•å…ƒå’ŒåŠ¨æ€ç¼©æ”¾æœºåˆ¶ï¼Œè¿›ä¸€æ­¥æé«˜äº†æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›å’Œæ•ˆç‡ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-3" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-3" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Wang, Ruoxi, et al. &quot;DCN V2: Improved deep &amp; cross network and practical lessons for web-scale learning to rank systems.&quot; Proceedings of the web conference 2021. 2021.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-3" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-3" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>ç‰¹å¾é€‰æ‹©å•å…ƒ</strong>ï¼šä¸ºæ¯ä¸ªç‰¹å¾åˆ†é…åŠ¨æ€æƒé‡ï¼Œè‡ªåŠ¨é€‰æ‹©é‡è¦ç‰¹å¾</li><li><strong>åŠ¨æ€ç¼©æ”¾æœºåˆ¶</strong>ï¼šå¼•å…¥æ ‡é‡å‚æ•°ï¼Œè‡ªé€‚åº”è°ƒæ•´ç‰¹å¾äº¤å‰çš„è´¡çŒ®</li><li><strong>æ›´çµæ´»çš„äº¤å‰ç½‘ç»œ</strong>ï¼šæ”¯æŒä¸åŒçš„äº¤å‰å½¢å¼</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-3" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-3" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DCNv2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DCNv2(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    cross_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    cross_num_layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-3" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-3" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>cross_features</td><td>list</td><td>Cross éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>mlp_params</td><td>dict</td><td>æ·±åº¦ç¥ç»ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>cross_num_layers</td><td>int</td><td>Cross Network çš„å±‚æ•°</td><td>3</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-3" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-3" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>éœ€è¦æ›´é«˜æ•ˆç‰¹å¾äº¤å‰çš„åœºæ™¯</li><li>å¤§è§„æ¨¡æ¨èç³»ç»Ÿ</li><li>ç‚¹å‡»ç‡é¢„æµ‹ä»»åŠ¡</li></ul><h2 id="_5-edcn" tabindex="-1">5. EDCN <a class="header-anchor" href="#_5-edcn" aria-label="Permalink to â€œ5. EDCNâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-4" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-4" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>EDCNï¼ˆEnhanced Deep &amp; Cross Networkï¼‰æ˜¯ä¸€ç§å¢å¼ºå‹çš„äº¤å‰ç½‘ç»œæ¨¡å‹ï¼Œå¼•å…¥äº†æ˜¾å¼ç‰¹å¾äº¤å‰å’Œæ·±åº¦ç‰¹å¾æå–çš„ç»“åˆï¼Œè¿›ä¸€æ­¥æé«˜äº†æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-4" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-4" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Ma, Xiao, et al. &quot;Enhanced Deep &amp; Cross Network for Feature Cross Learning in Click-Through Rate Prediction.&quot; Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery &amp; Data Mining. 2021.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-4" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-4" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>Cross Network</strong>ï¼šæ˜¾å¼å­¦ä¹ é«˜é˜¶ç‰¹å¾äº¤å‰</li><li><strong>Deep Network</strong>ï¼šæ·±åº¦ç¥ç»ç½‘ç»œï¼Œæ•è·éçº¿æ€§ç‰¹å¾äº¤äº’</li><li><strong>ç‰¹å¾é‡è¦æ€§å­¦ä¹ </strong>ï¼šå¼•å…¥ç‰¹å¾é‡è¦æ€§æƒé‡ï¼Œæé«˜æ¨¡å‹çš„è§£é‡Šæ€§</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-4" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-4" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EDCN</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EDCN(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    cross_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    cross_num_layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-4" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-4" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>cross_features</td><td>list</td><td>Cross éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>mlp_params</td><td>dict</td><td>æ·±åº¦ç¥ç»ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>cross_num_layers</td><td>int</td><td>Cross Network çš„å±‚æ•°</td><td>3</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-4" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-4" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>å¤æ‚ç‰¹å¾äº¤äº’åœºæ™¯</li><li>éœ€è¦é«˜è¡¨è¾¾èƒ½åŠ›çš„æ¨¡å‹</li><li>ç‚¹å‡»ç‡é¢„æµ‹ä»»åŠ¡</li></ul><h2 id="_6-afm" tabindex="-1">6. AFM <a class="header-anchor" href="#_6-afm" aria-label="Permalink to â€œ6. AFMâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-5" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-5" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>AFMï¼ˆAttention Factorization Machineï¼‰æ˜¯ä¸€ç§åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„å› å­åˆ†è§£æœºï¼Œèƒ½å¤Ÿè‡ªé€‚åº”åœ°å­¦ä¹ ä¸åŒç‰¹å¾äº¤äº’çš„é‡è¦æ€§ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-5" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-5" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Xiao, Jun, et al. &quot;Attentional factorization machines: Learning the weight of feature interactions via attention networks.&quot; arXiv preprint arXiv:1708.04617 (2017).</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-5" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-5" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>FM åŸºç¡€</strong>ï¼šåŸºäºå› å­åˆ†è§£æœºï¼Œæ•è·äºŒé˜¶ç‰¹å¾äº¤äº’</li><li><strong>æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šå¼•å…¥æ³¨æ„åŠ›ç½‘ç»œï¼Œä¸ºæ¯ä¸ªç‰¹å¾äº¤äº’åˆ†é…åŠ¨æ€æƒé‡</li><li><strong>æ³¨æ„åŠ›è¾“å‡º</strong>ï¼šæ³¨æ„åŠ›æƒé‡ä¸ç‰¹å¾äº¤äº’å‘é‡åŠ æƒæ±‚å’Œï¼Œå¾—åˆ°æœ€ç»ˆçš„äº¤äº’å‘é‡</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-5" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-5" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AFM</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AFM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    fm_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    attention_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;attention_dim&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-5" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-5" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>fm_features</td><td>list</td><td>FM éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>attention_params</td><td>dict</td><td>æ³¨æ„åŠ›ç½‘ç»œå‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-5" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-5" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ç‰¹å¾äº¤äº’é‡è¦æ€§å·®å¼‚è¾ƒå¤§çš„åœºæ™¯</li><li>éœ€è¦è§£é‡Šæ€§çš„åœºæ™¯</li><li>ç‚¹å‡»ç‡é¢„æµ‹ä»»åŠ¡</li></ul><h2 id="_7-fibinet" tabindex="-1">7. FiBiNET <a class="header-anchor" href="#_7-fibinet" aria-label="Permalink to â€œ7. FiBiNETâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-6" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-6" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>FiBiNETï¼ˆFeature Importance and Bilinear feature Interaction NETworkï¼‰æ˜¯ä¸€ç§ç»“åˆäº†ç‰¹å¾é‡è¦æ€§å­¦ä¹ å’ŒåŒçº¿æ€§ç‰¹å¾äº¤äº’çš„æ¨¡å‹ï¼Œèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°æ•è·ç‰¹å¾äº¤äº’ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-6" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-6" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Juan, Yuchin, et al. &quot;FiBiNET: Combining Feature Importance and Bilinear feature Interaction for Click-Through Rate Prediction.&quot; Proceedings of the 13th ACM Conference on Recommender Systems. 2019.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-6" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-6" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>ç‰¹å¾é‡è¦æ€§ç½‘ç»œ</strong>ï¼šé€šè¿‡ Squeeze-and-Excitation æœºåˆ¶å­¦ä¹ ç‰¹å¾é‡è¦æ€§</li><li><strong>åŒçº¿æ€§äº¤äº’</strong>ï¼šä½¿ç”¨åŒçº¿æ€§å‡½æ•°æ•è·ç‰¹å¾äº¤äº’ï¼Œæ”¯æŒä¸åŒçš„äº¤äº’å½¢å¼</li><li><strong>ç‰¹å¾å¢å¼º</strong>ï¼šå¯¹è¾“å…¥ç‰¹å¾è¿›è¡Œå¢å¼ºï¼Œæé«˜æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-6" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-6" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FiBiNet</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FiBiNet(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    fm_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-6" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-6" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>fm_features</td><td>list</td><td>FM éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>mlp_params</td><td>dict</td><td>æ·±åº¦ç¥ç»ç½‘ç»œå‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-6" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-6" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ç‰¹å¾é‡è¦æ€§å·®å¼‚è¾ƒå¤§çš„åœºæ™¯</li><li>éœ€è¦å¤æ‚ç‰¹å¾äº¤äº’çš„åœºæ™¯</li><li>ç‚¹å‡»ç‡é¢„æµ‹ä»»åŠ¡</li></ul><h2 id="_8-deepffm" tabindex="-1">8. DeepFFM <a class="header-anchor" href="#_8-deepffm" aria-label="Permalink to â€œ8. DeepFFMâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-7" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-7" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>DeepFFMï¼ˆDeep Field-aware Factorization Machineï¼‰æ˜¯ä¸€ç§ç»“åˆäº†åœºæ„ŸçŸ¥å› å­åˆ†è§£æœºå’Œæ·±åº¦ç¥ç»ç½‘ç»œçš„æ¨¡å‹ï¼Œèƒ½å¤Ÿæ•è·åœºæ„ŸçŸ¥çš„é«˜é˜¶ç‰¹å¾äº¤äº’ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-7" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-7" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Xiao, Jun, et al. &quot;Deep learning over multi-field categorical data.&quot; European conference on information retrieval. Springer, Cham, 2016.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-7" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-7" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>FFM åŸºç¡€</strong>ï¼šåœºæ„ŸçŸ¥å› å­åˆ†è§£æœºï¼Œä¸ºæ¯ä¸ªç‰¹å¾åœºå¯¹å­¦ä¹ ç‰¹å®šçš„äº¤äº’å‘é‡</li><li><strong>Deep Network</strong>ï¼šæ·±åº¦ç¥ç»ç½‘ç»œï¼Œæ•è·é«˜é˜¶ç‰¹å¾äº¤äº’</li><li><strong>è”åˆè®­ç»ƒ</strong>ï¼šFFM éƒ¨åˆ†å’Œ Deep éƒ¨åˆ†è”åˆè®­ç»ƒï¼Œè¾“å‡ºç»“æœç»“åˆ</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-7" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-7" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DeepFFM, FatDeepFFM</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DeepFFM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    fm_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»º FatDeepFFM æ¨¡å‹ï¼ˆå¢å¼ºç‰ˆæœ¬ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fat_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FatDeepFFM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    fm_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-7" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-7" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>fm_features</td><td>list</td><td>FFM éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>mlp_params</td><td>dict</td><td>æ·±åº¦ç¥ç»ç½‘ç»œå‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-7" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-7" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>åœºæ„ŸçŸ¥ç‰¹å¾äº¤äº’é‡è¦çš„åœºæ™¯</li><li>å¤æ‚ç‰¹å¾äº¤äº’åœºæ™¯</li><li>ç‚¹å‡»ç‡é¢„æµ‹ä»»åŠ¡</li></ul><h2 id="_9-bst" tabindex="-1">9. BST <a class="header-anchor" href="#_9-bst" aria-label="Permalink to â€œ9. BSTâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-8" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-8" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>BSTï¼ˆBehavior Sequence Transformerï¼‰æ˜¯ä¸€ç§ä½¿ç”¨ Transformer å»ºæ¨¡ç”¨æˆ·è¡Œä¸ºåºåˆ—çš„æ¨¡å‹ï¼Œèƒ½å¤Ÿæ•è·ç”¨æˆ·è¡Œä¸ºåºåˆ—ä¸­çš„é•¿è·ç¦»ä¾èµ–å…³ç³»ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-8" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-8" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Sun, Fei, et al. &quot;BERT4Rec: Sequential recommendation with bidirectional encoder representations from transformer.&quot; Proceedings of the 28th ACM international conference on information and knowledge management. 2019.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-8" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-8" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>Transformer Encoder</strong>ï¼šä½¿ç”¨å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶æ•è·åºåˆ—ä¸­çš„ä¾èµ–å…³ç³»</li><li><strong>ä½ç½®ç¼–ç </strong>ï¼šæ·»åŠ ä½ç½®ä¿¡æ¯ï¼Œä¿ç•™åºåˆ—çš„é¡ºåºä¿¡æ¯</li><li><strong>ç‰¹å¾èåˆ</strong>ï¼šå°†åºåˆ—ç‰¹å¾ä¸å…¶ä»–ç‰¹å¾èåˆï¼Œå¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹ç»“æœ</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-8" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-8" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BST</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰åºåˆ—ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequence_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [SequenceFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pooling</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mean&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BST(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    sequence_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequence_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    transformer_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;num_heads&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;num_layers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hidden_size&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-8" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-8" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>sequence_features</td><td>list</td><td>åºåˆ—ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>transformer_params</td><td>dict</td><td>Transformer å‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-8" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-8" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ç”¨æˆ·è¡Œä¸ºåºåˆ—é‡è¦çš„åœºæ™¯</li><li>é•¿åºåˆ—å»ºæ¨¡åœºæ™¯</li><li>æ¨èç³»ç»Ÿä¸­çš„é¡ºåºæ¨èä»»åŠ¡</li></ul><h2 id="_10-din" tabindex="-1">10. DIN <a class="header-anchor" href="#_10-din" aria-label="Permalink to â€œ10. DINâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-9" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-9" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>DINï¼ˆDeep Interest Networkï¼‰æ˜¯ä¸€ç§åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„æ·±åº¦å…´è¶£ç½‘ç»œï¼Œèƒ½å¤Ÿæ ¹æ®ç›®æ ‡ç‰©å“åŠ¨æ€æ•è·ç”¨æˆ·çš„å…´è¶£ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-9" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-9" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Zhou, Guorui, et al. &quot;Deep interest network for click-through rate prediction.&quot; Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining. 2018.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-9" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-9" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>å…´è¶£æå–</strong>ï¼šä»ç”¨æˆ·è¡Œä¸ºåºåˆ—ä¸­æå–å…´è¶£è¡¨ç¤º</li><li><strong>æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šæ ¹æ®ç›®æ ‡ç‰©å“è®¡ç®—æ¯ä¸ªå†å²è¡Œä¸ºçš„æ³¨æ„åŠ›æƒé‡</li><li><strong>å…´è¶£åŠ¨æ€èšåˆ</strong>ï¼šæ ¹æ®æ³¨æ„åŠ›æƒé‡åŠ¨æ€èšåˆç”¨æˆ·å…´è¶£ï¼Œå¾—åˆ°æœ€ç»ˆçš„å…´è¶£è¡¨ç¤º</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-9" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-9" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DIN</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰åºåˆ—ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequence_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [SequenceFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pooling</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DIN(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    sequence_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequence_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    target_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-9" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-9" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>sequence_features</td><td>list</td><td>åºåˆ—ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>target_features</td><td>list</td><td>ç›®æ ‡ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>mlp_params</td><td>dict</td><td>æ·±åº¦ç¥ç»ç½‘ç»œå‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-9" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-9" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ç”¨æˆ·å…´è¶£åŠ¨æ€å˜åŒ–çš„åœºæ™¯</li><li>ç›®æ ‡ç‰©å“ç›¸å…³çš„å…´è¶£å»ºæ¨¡</li><li>ç‚¹å‡»ç‡é¢„æµ‹ä»»åŠ¡</li></ul><h2 id="_11-dien" tabindex="-1">11. DIEN <a class="header-anchor" href="#_11-dien" aria-label="Permalink to â€œ11. DIENâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-10" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-10" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>DIENï¼ˆDeep Interest Evolution Networkï¼‰æ˜¯ä¸€ç§ç”¨äºå»ºæ¨¡ç”¨æˆ·å…´è¶£æ¼”åŒ–è¿‡ç¨‹çš„æ·±åº¦ç½‘ç»œï¼Œèƒ½å¤Ÿæ•è·ç”¨æˆ·å…´è¶£çš„åŠ¨æ€å˜åŒ–ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-10" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-10" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Zhou, Guorui, et al. &quot;Deep interest evolution network for click-through rate prediction.&quot; Proceedings of the AAAI conference on artificial intelligence. 2019.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-10" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-10" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>GRU</strong>ï¼šä½¿ç”¨ GRU æ•æ‰ç”¨æˆ·å…´è¶£çš„æ—¶åºå˜åŒ–</li><li><strong>å…´è¶£æŠ½å–å±‚</strong>ï¼šä»åŸå§‹è¡Œä¸ºåºåˆ—ä¸­æå–å…´è¶£åºåˆ—</li><li><strong>å…´è¶£æ¼”åŒ–å±‚</strong>ï¼šä½¿ç”¨ GRU å’Œæ³¨æ„åŠ›æœºåˆ¶å»ºæ¨¡å…´è¶£çš„åŠ¨æ€æ¼”åŒ–</li><li><strong>å…´è¶£æ¿€æ´»å±‚</strong>ï¼šæ ¹æ®ç›®æ ‡ç‰©å“æ¿€æ´»ç›¸å…³å…´è¶£</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-10" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-10" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DIEN</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰åºåˆ—ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequence_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [SequenceFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pooling</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DIEN(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    sequence_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequence_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    target_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    dien_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gru_layers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;attention_dim&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-10" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-10" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>sequence_features</td><td>list</td><td>åºåˆ—ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>target_features</td><td>list</td><td>ç›®æ ‡ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>mlp_params</td><td>dict</td><td>æ·±åº¦ç¥ç»ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>dien_params</td><td>dict</td><td>DIEN ç½‘ç»œå‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-10" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-10" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ç”¨æˆ·å…´è¶£åŠ¨æ€æ¼”åŒ–çš„åœºæ™¯</li><li>é•¿åºåˆ—å…´è¶£å»ºæ¨¡</li><li>ç‚¹å‡»ç‡é¢„æµ‹ä»»åŠ¡</li></ul><h2 id="_12-autoint" tabindex="-1">12. AutoInt <a class="header-anchor" href="#_12-autoint" aria-label="Permalink to â€œ12. AutoIntâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-11" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-11" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>AutoIntï¼ˆAutomatic Feature Interaction Learning via Self-Attentive Neural Networksï¼‰æ˜¯ä¸€ç§ä½¿ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶è‡ªåŠ¨å­¦ä¹ ç‰¹å¾äº¤äº’çš„æ¨¡å‹ï¼Œèƒ½å¤Ÿçµæ´»åœ°æ•è·å„ç§é˜¶æ•°çš„ç‰¹å¾äº¤äº’ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-11" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-11" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Song, Weiping, et al. &quot;AutoInt: Automatic Feature Interaction Learning via Self-Attentive Neural Networks.&quot; Proceedings of the 28th ACM International Conference on Information and Knowledge Management. 2019.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-11" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-11" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>Embedding å±‚</strong>ï¼šå°†ç¦»æ•£ç‰¹å¾æ˜ å°„åˆ°ä½ç»´å‘é‡ç©ºé—´</li><li><strong>å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šè‡ªåŠ¨å­¦ä¹ ç‰¹å¾ä¹‹é—´çš„äº¤äº’å…³ç³»</li><li><strong>æ®‹å·®è¿æ¥</strong>ï¼šå¢å¼ºæ¨¡å‹çš„è®­ç»ƒç¨³å®šæ€§</li><li><strong>å±‚å½’ä¸€åŒ–</strong>ï¼šåŠ é€Ÿæ¨¡å‹æ”¶æ•›</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-11" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-11" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AutoInt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AutoInt(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    attention_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;num_heads&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;num_layers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hidden_size&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-11" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-11" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>deep_features</td><td>list</td><td>Deep éƒ¨åˆ†ä½¿ç”¨çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>attention_params</td><td>dict</td><td>æ³¨æ„åŠ›ç½‘ç»œå‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-11" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-11" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>è‡ªåŠ¨ç‰¹å¾äº¤äº’å­¦ä¹ </li><li>å¤æ‚ç‰¹å¾äº¤äº’åœºæ™¯</li><li>ç‚¹å‡»ç‡é¢„æµ‹ä»»åŠ¡</li></ul><h2 id="_13-æ¨¡å‹æ¯”è¾ƒ" tabindex="-1">13. æ¨¡å‹æ¯”è¾ƒ <a class="header-anchor" href="#_13-æ¨¡å‹æ¯”è¾ƒ" aria-label="Permalink to â€œ13. æ¨¡å‹æ¯”è¾ƒâ€">â€‹</a></h2><table tabindex="0"><thead><tr><th>æ¨¡å‹</th><th>å¤æ‚åº¦</th><th>è¡¨è¾¾èƒ½åŠ›</th><th>è®¡ç®—æ•ˆç‡</th><th>è§£é‡Šæ€§</th></tr></thead><tbody><tr><td>WideDeep</td><td>ä½</td><td>ä¸­</td><td>é«˜</td><td>é«˜</td></tr><tr><td>DeepFM</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>ä¸­</td></tr><tr><td>DCN/DCNv2</td><td>ä¸­</td><td>é«˜</td><td>é«˜</td><td>ä¸­</td></tr><tr><td>EDCN</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>ä¸­</td></tr><tr><td>AFM</td><td>ä¸­</td><td>ä¸­</td><td>ä¸­</td><td>é«˜</td></tr><tr><td>FiBiNET</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>ä¸­</td></tr><tr><td>DeepFFM</td><td>é«˜</td><td>é«˜</td><td>ä½</td><td>ä¸­</td></tr><tr><td>BST</td><td>é«˜</td><td>é«˜</td><td>ä½</td><td>ä¸­</td></tr><tr><td>DIN</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>ä¸­</td></tr><tr><td>DIEN</td><td>é«˜</td><td>é«˜</td><td>ä½</td><td>ä¸­</td></tr><tr><td>AutoInt</td><td>é«˜</td><td>é«˜</td><td>ä½</td><td>ä¸­</td></tr></tbody></table><h2 id="_14-ä½¿ç”¨å»ºè®®" tabindex="-1">14. ä½¿ç”¨å»ºè®® <a class="header-anchor" href="#_14-ä½¿ç”¨å»ºè®®" aria-label="Permalink to â€œ14. ä½¿ç”¨å»ºè®®â€">â€‹</a></h2><ol><li><strong>æ ¹æ®æ•°æ®è§„æ¨¡é€‰æ‹©æ¨¡å‹</strong>ï¼šå°è§„æ¨¡æ•°æ®æ¨èä½¿ç”¨ç®€å•æ¨¡å‹ï¼ˆå¦‚ WideDeepã€DeepFMï¼‰ï¼Œå¤§è§„æ¨¡æ•°æ®å¯ä»¥å°è¯•æ›´å¤æ‚çš„æ¨¡å‹</li><li><strong>æ ¹æ®ç‰¹å¾ç±»å‹é€‰æ‹©æ¨¡å‹</strong>ï¼šåºåˆ—ç‰¹å¾é‡è¦æ—¶æ¨èä½¿ç”¨ BSTã€DINã€DIENï¼›ç‰¹å¾äº¤äº’é‡è¦æ—¶æ¨èä½¿ç”¨ DCNã€DeepFM</li><li><strong>æ ¹æ®è®¡ç®—èµ„æºé€‰æ‹©æ¨¡å‹</strong>ï¼šè®¡ç®—èµ„æºæœ‰é™æ—¶æ¨èä½¿ç”¨è®¡ç®—æ•ˆç‡é«˜çš„æ¨¡å‹ï¼ˆå¦‚ DCNã€WideDeepï¼‰</li><li><strong>å°è¯•å¤šç§æ¨¡å‹å¹¶è¿›è¡Œèåˆ</strong>ï¼šä¸åŒæ¨¡å‹å¯èƒ½æ•è·ä¸åŒçš„ç‰¹å¾äº¤äº’æ¨¡å¼ï¼Œæ¨¡å‹èåˆå¯ä»¥æé«˜æœ€ç»ˆæ•ˆæœ</li></ol><h2 id="_15-ä»£ç ç¤ºä¾‹-å®Œæ•´çš„æ’åºæ¨¡å‹è®­ç»ƒæµç¨‹" tabindex="-1">15. ä»£ç ç¤ºä¾‹ï¼šå®Œæ•´çš„æ’åºæ¨¡å‹è®­ç»ƒæµç¨‹ <a class="header-anchor" href="#_15-ä»£ç ç¤ºä¾‹-å®Œæ•´çš„æ’åºæ¨¡å‹è®­ç»ƒæµç¨‹" aria-label="Permalink to â€œ15. ä»£ç ç¤ºä¾‹ï¼šå®Œæ•´çš„æ’åºæ¨¡å‹è®­ç»ƒæµç¨‹â€">â€‹</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DeepFM</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.trainers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CTRTrainer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.utils.data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataGenerator</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.basic.features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DenseFeature, SparseFeature</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. å®šä¹‰ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dense_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DenseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DenseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;income&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;city&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gender&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;occupation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. å‡†å¤‡æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å‡è®¾ x å’Œ y æ˜¯å·²ç»å¤„ç†å¥½çš„ç‰¹å¾å’Œæ ‡ç­¾æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: age_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;income&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: income_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;city&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: city_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;gender&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: gender_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;occupation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: occupation_data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> label_data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. åˆ›å»ºæ•°æ®ç”Ÿæˆå™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataGenerator(x, y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">train_dl, val_dl, test_dl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dg.generate_dataloader(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">split_ratio</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">batch_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DeepFM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dense_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    fm_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sparse_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. åˆ›å»ºè®­ç»ƒå™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CTRTrainer(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    optimizer_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;lr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;weight_decay&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_epoch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    earlystop_patience</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cuda:0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    model_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;saved/deepfm&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 6. è®­ç»ƒæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer.fit(train_dl, val_dl)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 7. è¯„ä¼°æ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">auc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> trainer.evaluate(trainer.model, test_dl)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Test AUC: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">auc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 8. å¯¼å‡º ONNX æ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer.export_onnx(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;deepfm.onnx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="_16-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" tabindex="-1">16. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ <a class="header-anchor" href="#_16-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" aria-label="Permalink to â€œ16. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆâ€">â€‹</a></h2><h3 id="q-å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ¨¡å‹" tabindex="-1">Q: å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Ÿ <a class="header-anchor" href="#q-å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ¨¡å‹" aria-label="Permalink to â€œQ: å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Ÿâ€">â€‹</a></h3><p>A: æ ¹æ®æ•°æ®è§„æ¨¡ã€ç‰¹å¾ç±»å‹ã€è®¡ç®—èµ„æºå’Œä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ¨¡å‹ã€‚å»ºè®®å…ˆä»ç®€å•æ¨¡å‹å¼€å§‹ï¼Œé€æ­¥å°è¯•æ›´å¤æ‚çš„æ¨¡å‹ã€‚</p><h3 id="q-æ¨¡å‹è®­ç»ƒè¿‡æ‹Ÿåˆæ€ä¹ˆåŠ" tabindex="-1">Q: æ¨¡å‹è®­ç»ƒè¿‡æ‹Ÿåˆæ€ä¹ˆåŠï¼Ÿ <a class="header-anchor" href="#q-æ¨¡å‹è®­ç»ƒè¿‡æ‹Ÿåˆæ€ä¹ˆåŠ" aria-label="Permalink to â€œQ: æ¨¡å‹è®­ç»ƒè¿‡æ‹Ÿåˆæ€ä¹ˆåŠï¼Ÿâ€">â€‹</a></h3><p>A: å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li>å¢åŠ æ­£åˆ™åŒ–ï¼ˆL1/L2æ­£åˆ™åŒ–ï¼‰</li><li>å¢åŠ  dropout ç‡</li><li>ä½¿ç”¨æ—©åœï¼ˆEarly Stoppingï¼‰</li><li>å¢åŠ è®­ç»ƒæ•°æ®</li><li>ç®€åŒ–æ¨¡å‹ç»“æ„</li></ul><h3 id="q-å¦‚ä½•å¤„ç†å¤§è§„æ¨¡ç‰¹å¾" tabindex="-1">Q: å¦‚ä½•å¤„ç†å¤§è§„æ¨¡ç‰¹å¾ï¼Ÿ <a class="header-anchor" href="#q-å¦‚ä½•å¤„ç†å¤§è§„æ¨¡ç‰¹å¾" aria-label="Permalink to â€œQ: å¦‚ä½•å¤„ç†å¤§è§„æ¨¡ç‰¹å¾ï¼Ÿâ€">â€‹</a></h3><p>A: å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li>ç‰¹å¾é€‰æ‹©ï¼šåªä¿ç•™é‡è¦ç‰¹å¾</li><li>ç‰¹å¾å“ˆå¸Œï¼šå°†é«˜ç»´ç‰¹å¾æ˜ å°„åˆ°ä½ç»´ç©ºé—´</li><li>åˆ†å±‚ Embeddingï¼šå¯¹ä¸åŒç‰¹å¾ä½¿ç”¨ä¸åŒçš„ Embedding ç»´åº¦</li></ul><h3 id="q-å¦‚ä½•åŠ é€Ÿæ¨¡å‹è®­ç»ƒ" tabindex="-1">Q: å¦‚ä½•åŠ é€Ÿæ¨¡å‹è®­ç»ƒï¼Ÿ <a class="header-anchor" href="#q-å¦‚ä½•åŠ é€Ÿæ¨¡å‹è®­ç»ƒ" aria-label="Permalink to â€œQ: å¦‚ä½•åŠ é€Ÿæ¨¡å‹è®­ç»ƒï¼Ÿâ€">â€‹</a></h3><p>A: å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li>ä½¿ç”¨ GPU è®­ç»ƒ</li><li>å¢åŠ  batch size</li><li>ä½¿ç”¨æ··åˆç²¾åº¦è®­ç»ƒ</li><li>é€‰æ‹©è®¡ç®—æ•ˆç‡é«˜çš„æ¨¡å‹</li><li>æ•°æ®å¹¶è¡Œè®­ç»ƒ</li></ul></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/torch-rechub/zh/models/intro.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>å¯¼è§ˆ (Overview)</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/torch-rechub/zh/models/matching.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>å¬å›æ¨¡å‹ (Matching)</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_api.md\":\"DJkjBqY1\",\"blog_hllm_reproduction.md\":\"ChKe_XN3\",\"blog_match.md\":\"BedaiOiS\",\"blog_rank.md\":\"CjbEHKm4\",\"cache_api-basic.md\":\"CxBzBbeT\",\"cache_api-models.md\":\"_Nh38IC9\",\"cache_api-trainers.md\":\"qTIo5JV-\",\"cache_api-utils.md\":\"DMICx_Eb\",\"cache_hllm_reproduction.md\":\"DJwx9hU5\",\"cache_hstu_reproduction.md\":\"bQOULsOs\",\"cache_match.md\":\"BcCUbgKz\",\"cache_rank.md\":\"DiUyOquO\",\"cache_å‚è€ƒèµ„æ–™.md\":\"-t2bObt5\",\"community_changelog.md\":\"8luSFuoT\",\"community_contributing.md\":\"xtydGDVG\",\"community_faq.md\":\"B2o2gfCA\",\"contributing.md\":\"B4CsM6F1\",\"core_data.md\":\"BxaQuxT7\",\"core_evaluation.md\":\"DG3KV-e8\",\"core_features.md\":\"qdJ0T1Hi\",\"core_intro.md\":\"MSz9eY8P\",\"guide_install.md\":\"BKEyLNSv\",\"guide_intro.md\":\"CcqgfzKq\",\"guide_quick_start.md\":\"BafQ4m9I\",\"index.md\":\"BWkYO4CN\",\"introduction.md\":\"DCcoFN4C\",\"manual_api-reference_basic.md\":\"mdpaLngf\",\"manual_api-reference_models.md\":\"ClWTbT_c\",\"manual_api-reference_trainers.md\":\"DMq3Y4lN\",\"manual_api-reference_utils.md\":\"CwgYI4XX\",\"manual_faq.md\":\"Bt4nAaSb\",\"manual_getting-started.md\":\"D1tlYLXA\",\"manual_installation.md\":\"BEi4-tgX\",\"manual_tutorials_matching.md\":\"Drdc8zHk\",\"manual_tutorials_multi-task.md\":\"DUzIv4Pd\",\"manual_tutorials_ranking.md\":\"PE87Y6VF\",\"models_generative.md\":\"lutepzOQ\",\"models_intro.md\":\"D9s-yOlN\",\"models_matching.md\":\"nlVB5KrK\",\"models_mtl.md\":\"2Xd7UBFf\",\"models_ranking.md\":\"DIKlsDzy\",\"serving_demo.md\":\"BR_nJdJp\",\"serving_intro.md\":\"Dbvd1QrA\",\"serving_onnx.md\":\"DrRUe4sH\",\"serving_vector_index.md\":\"D24mwGrX\",\"tools_callbacks.md\":\"Bs7UMuyY\",\"tools_intro.md\":\"dsxQIeoA\",\"tools_tracking.md\":\"BXuMyNWQ\",\"tools_visualization.md\":\"DDQwCOuE\",\"tutorials_ctr.md\":\"C2DkoDG-\",\"tutorials_intro.md\":\"6_GHNz3c\",\"tutorials_pipeline.md\":\"Cx5gWVpZ\",\"tutorials_retrieval.md\":\"QT31LYiv\",\"zh_api_api.md\":\"DVI6Mi62\",\"zh_community_changelog.md\":\"CbdJm96i\",\"zh_community_contributing.md\":\"XG8ponp6\",\"zh_community_faq.md\":\"BpQXxVSl\",\"zh_core_data.md\":\"CvO2Pken\",\"zh_core_evaluation.md\":\"7VnjdD4T\",\"zh_core_features.md\":\"C3UgMFjz\",\"zh_core_intro.md\":\"C5-GowRG\",\"zh_guide_install.md\":\"BjMbjNWH\",\"zh_guide_intro.md\":\"Drdzv92U\",\"zh_guide_quick_start.md\":\"BRSUyEVO\",\"zh_index.md\":\"DvSpQJI5\",\"zh_models_generative.md\":\"B9Hc2oiC\",\"zh_models_intro.md\":\"Ckt95GI6\",\"zh_models_matching.md\":\"BPmlhh3Q\",\"zh_models_mtl.md\":\"CAMx5Qxv\",\"zh_models_ranking.md\":\"Cnb4xZjQ\",\"zh_serving_demo.md\":\"DUDfCT9o\",\"zh_serving_intro.md\":\"W9cxABun\",\"zh_serving_onnx.md\":\"BjMT6Pvw\",\"zh_serving_vector_index.md\":\"DmaohZpJ\",\"zh_tools_callbacks.md\":\"3an-IhME\",\"zh_tools_intro.md\":\"Chd53O0c\",\"zh_tools_tracking.md\":\"CGCN4O4-\",\"zh_tools_visualization.md\":\"BjvRwYtC\",\"zh_tutorials_ctr.md\":\"DP55NTbQ\",\"zh_tutorials_intro.md\":\"2HyFqT62\",\"zh_tutorials_pipeline.md\":\"Byb65Sp2\",\"zh_tutorials_retrieval.md\":\"BnX5iygo\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"torch-rechub\",\"description\":\"A Lighting Pytorch Framework for Recommendation Models, Easy-to-use and Easy-to-extend.\",\"base\":\"/torch-rechub/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/img/logo.png\",\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/datawhalechina/torch-rechub\"}]},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\",\"themeConfig\":{\"nav\":[{\"text\":\"ğŸ  Home\",\"link\":\"/\"},{\"text\":\"ğŸš€ Getting Started\",\"link\":\"/guide/intro\"},{\"text\":\"âš™ï¸ Core\",\"link\":\"/core/intro\"},{\"text\":\"ğŸ° Models\",\"link\":\"/models/intro\"},{\"text\":\"ğŸ› ï¸ Tools\",\"link\":\"/tools/intro\"},{\"text\":\"ğŸš€ Serving\",\"link\":\"/serving/intro\"},{\"text\":\"ğŸ“– Tutorials\",\"link\":\"/tutorials/intro\"},{\"text\":\"â„¹ï¸ API\",\"link\":\"/api/api\"},{\"text\":\"ğŸ‘¥ Community\",\"link\":\"/community/faq\"}],\"sidebar\":{\"/guide/\":[{\"text\":\"ğŸš€ Getting Started\",\"items\":[{\"text\":\"Overview\",\"link\":\"/guide/intro\"},{\"text\":\"Installation\",\"link\":\"/guide/install\"},{\"text\":\"Quick Start\",\"link\":\"/guide/quick_start\"}]}],\"/core/\":[{\"text\":\"âš™ï¸ Core Components\",\"items\":[{\"text\":\"Overview\",\"link\":\"/core/intro\"},{\"text\":\"Feature Columns\",\"link\":\"/core/features\"},{\"text\":\"Data Pipeline\",\"link\":\"/core/data\"},{\"text\":\"Training & Eval\",\"link\":\"/core/evaluation\"}]}],\"/models/\":[{\"text\":\"ğŸ° Model Zoo\",\"items\":[{\"text\":\"Overview\",\"link\":\"/models/intro\"},{\"text\":\"Ranking Models\",\"link\":\"/models/ranking\"},{\"text\":\"Matching Models\",\"link\":\"/models/matching\"},{\"text\":\"Multi-Task Models\",\"link\":\"/models/mtl\"},{\"text\":\"Generative Models\",\"link\":\"/models/generative\"}]}],\"/tools/\":[{\"text\":\"ğŸ› ï¸ Dev Tools\",\"items\":[{\"text\":\"Overview\",\"link\":\"/tools/intro\"},{\"text\":\"Visualization\",\"link\":\"/tools/visualization\"},{\"text\":\"Experiment Tracking\",\"link\":\"/tools/tracking\"},{\"text\":\"Callbacks\",\"link\":\"/tools/callbacks\"}]}],\"/serving/\":[{\"text\":\"ğŸš€ Serving\",\"items\":[{\"text\":\"Overview\",\"link\":\"/serving/intro\"},{\"text\":\"ONNX & Quantization\",\"link\":\"/serving/onnx\"},{\"text\":\"Vector Indexing\",\"link\":\"/serving/vector_index\"},{\"text\":\"Serving Demo\",\"link\":\"/serving/demo\"}]}],\"/tutorials/\":[{\"text\":\"ğŸ“– Tutorials\",\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/intro\"},{\"text\":\"CTR Pipeline\",\"link\":\"/tutorials/ctr\"},{\"text\":\"Retrieval System\",\"link\":\"/tutorials/retrieval\"},{\"text\":\"Big Data Pipeline\",\"link\":\"/tutorials/pipeline\"}]}],\"/api/\":[{\"text\":\"â„¹ï¸ API Reference\",\"items\":[{\"text\":\"Main API\",\"link\":\"/api/api\"}]}],\"/community/\":[{\"text\":\"ğŸ“˜ Community\",\"items\":[{\"text\":\"FAQ\",\"link\":\"/community/faq\"},{\"text\":\"Contributing\",\"link\":\"/community/contributing\"},{\"text\":\"Changelog\",\"link\":\"/community/changelog\"}]}]}}},\"zh\":{\"label\":\"ä¸­æ–‡\",\"lang\":\"zh-CN\",\"link\":\"/zh/\",\"themeConfig\":{\"nav\":[{\"text\":\"ğŸ  é¦–é¡µ\",\"link\":\"/zh/\"},{\"text\":\"ğŸš€ å¿«é€Ÿå…¥é—¨\",\"link\":\"/zh/guide/intro\"},{\"text\":\"âš™ï¸ æ ¸å¿ƒç»„ä»¶\",\"link\":\"/zh/core/intro\"},{\"text\":\"ğŸ° æ¨¡å‹åº“\",\"link\":\"/zh/models/intro\"},{\"text\":\"ğŸ› ï¸ ç ”å‘å·¥å…·\",\"link\":\"/zh/tools/intro\"},{\"text\":\"ğŸš€ ç”Ÿäº§éƒ¨ç½²\",\"link\":\"/zh/serving/intro\"},{\"text\":\"ğŸ“– åœºæ™¯æ•™ç¨‹\",\"link\":\"/zh/tutorials/intro\"},{\"text\":\"â„¹ï¸ API\",\"link\":\"/zh/api/api\"},{\"text\":\"ğŸ‘¥ ç¤¾åŒº\",\"link\":\"/zh/community/faq\"}],\"sidebar\":{\"/zh/guide/\":[{\"text\":\"ğŸš€ å¿«é€Ÿå…¥é—¨\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/guide/intro\"},{\"text\":\"å®‰è£…æŒ‡å—\",\"link\":\"/zh/guide/install\"},{\"text\":\"3åˆ†é’Ÿä¸Šæ‰‹\",\"link\":\"/zh/guide/quick_start\"}]}],\"/zh/core/\":[{\"text\":\"âš™ï¸ æ ¸å¿ƒç»„ä»¶\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/core/intro\"},{\"text\":\"ç‰¹å¾å®šä¹‰ (Features)\",\"link\":\"/zh/core/features\"},{\"text\":\"æ•°æ®æµæ°´çº¿ (Data)\",\"link\":\"/zh/core/data\"},{\"text\":\"è®­ç»ƒä¸è¯„ä¼° (Eval)\",\"link\":\"/zh/core/evaluation\"}]}],\"/zh/models/\":[{\"text\":\"ğŸ° æ¨¡å‹åº“\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/models/intro\"},{\"text\":\"æ’åºæ¨¡å‹ (Ranking)\",\"link\":\"/zh/models/ranking\"},{\"text\":\"å¬å›æ¨¡å‹ (Matching)\",\"link\":\"/zh/models/matching\"},{\"text\":\"å¤šä»»åŠ¡æ¨¡å‹ (MTL)\",\"link\":\"/zh/models/mtl\"},{\"text\":\"ç”Ÿæˆå¼æ¨¡å‹ (Generative)\",\"link\":\"/zh/models/generative\"}]}],\"/zh/tools/\":[{\"text\":\"ğŸ› ï¸ ç ”å‘å·¥å…·\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/tools/intro\"},{\"text\":\"å¯è§†åŒ–ç›‘æ§\",\"link\":\"/zh/tools/visualization\"},{\"text\":\"å®éªŒè¿½è¸ª\",\"link\":\"/zh/tools/tracking\"},{\"text\":\"å›è°ƒå‡½æ•°\",\"link\":\"/zh/tools/callbacks\"}]}],\"/zh/serving/\":[{\"text\":\"ğŸš€ ç”Ÿäº§éƒ¨ç½²\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/serving/intro\"},{\"text\":\"ONNX å¯¼å‡ºä¸é‡åŒ–\",\"link\":\"/zh/serving/onnx\"},{\"text\":\"å‘é‡æ£€ç´¢å°è£…\",\"link\":\"/zh/serving/vector_index\"},{\"text\":\"åœ¨çº¿æœåŠ¡ç¤ºä¾‹\",\"link\":\"/zh/serving/demo\"}]}],\"/zh/tutorials/\":[{\"text\":\"ğŸ“– åœºæ™¯æ•™ç¨‹\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/tutorials/intro\"},{\"text\":\"CTR é¢„ä¼°æµç¨‹\",\"link\":\"/zh/tutorials/ctr\"},{\"text\":\"å¬å›ç³»ç»Ÿæ­å»º\",\"link\":\"/zh/tutorials/retrieval\"},{\"text\":\"å…¨é“¾è·¯æµæ°´çº¿\",\"link\":\"/zh/tutorials/pipeline\"}]}],\"/zh/api/\":[{\"text\":\"â„¹ï¸ API Reference\",\"items\":[{\"text\":\"API å‚è€ƒ\",\"link\":\"/zh/api/api\"}]}],\"/zh/community/\":[{\"text\":\"ğŸ“˜ ç¤¾åŒºä¿¡æ¯\",\"items\":[{\"text\":\"å¸¸è§é—®é¢˜ (FAQ)\",\"link\":\"/zh/community/faq\"},{\"text\":\"è´¡çŒ®æŒ‡å— (Contributing)\",\"link\":\"/zh/community/contributing\"},{\"text\":\"ç‰ˆæœ¬æ—¥å¿— (Changelog)\",\"link\":\"/zh/community/changelog\"}]}]}}}},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>