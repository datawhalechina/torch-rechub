<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å¤šä»»åŠ¡æ¨¡å‹ | torch-rechub</title>
    <meta name="description" content="Torch-RecHub å¤šä»»åŠ¡æ¨¡å‹è¯¦ç»†ä»‹ç»">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/torch-rechub/assets/style.Dnbe36Wi.css" as="style">
    <link rel="preload stylesheet" href="/torch-rechub/vp-icons.css" as="style">
    
    <script type="module" src="/torch-rechub/assets/app.CtCE54ez.js"></script>
    <link rel="preload" href="/torch-rechub/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/torch-rechub/assets/chunks/theme.BkbgLTTS.js">
    <link rel="modulepreload" href="/torch-rechub/assets/chunks/framework.BiSKXDrp.js">
    <link rel="modulepreload" href="/torch-rechub/assets/zh_models_mtl.md.CAMx5Qxv.lean.js">
    <link rel="icon" href="/torch-rechub/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle has-sidebar" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/torch-rechub/zh/" data-v-1e38c6bc><!--[--><!--]--><!--[--><img class="VPImage logo" src="/torch-rechub/img/logo.png" alt data-v-8426fc1a><!--]--><span data-v-1e38c6bc>torch-rechub</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!--[--><!----><div id="local-search"><button type="button" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><span class="vpi-search DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ  é¦–é¡µ</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/guide/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸš€ å¿«é€Ÿå…¥é—¨</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/core/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>âš™ï¸ æ ¸å¿ƒç»„ä»¶</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/models/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ° æ¨¡å‹åº“</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/tools/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ› ï¸ ç ”å‘å·¥å…·</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/serving/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸš€ ç”Ÿäº§éƒ¨ç½²</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/tutorials/intro.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ“– åœºæ™¯æ•™ç¨‹</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/api/api.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>â„¹ï¸ API</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/community/faq.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>ğŸ‘¥ ç¤¾åŒº</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-70946a35 data-v-4c1766e2 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-42cb505d><span class="text" data-v-42cb505d><span class="vpi-languages option-icon" data-v-42cb505d></span><!----><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="items" data-v-4c1766e2><p class="title" data-v-4c1766e2>ä¸­æ–‡</p><!--[--><div class="VPMenuLink" data-v-4c1766e2 data-v-faf5b206><a class="VPLink link" href="/torch-rechub/models/mtl.html" lang="en" data-v-faf5b206><!--[--><span data-v-faf5b206>English</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/datawhalechina/torch-rechub" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="group translations" data-v-bf2fac68><p class="trans-title" data-v-bf2fac68>ä¸­æ–‡</p><!--[--><div class="VPMenuLink" data-v-bf2fac68 data-v-faf5b206><a class="VPLink link" href="/torch-rechub/models/mtl.html" lang="en" data-v-faf5b206><!--[--><span data-v-faf5b206>English</span><!--]--></a></div><!--]--></div><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/datawhalechina/torch-rechub" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-db738f89><span class="vpi-align-left menu-icon" data-v-db738f89></span><span class="menu-text" data-v-db738f89>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1df9f90f data-v-af661f50><div class="curtain" data-v-af661f50></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-af661f50><span class="visually-hidden" id="sidebar-aria-label" data-v-af661f50> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 has-active" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>ğŸ° æ¨¡å‹åº“</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/intro.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>å¯¼è§ˆ (Overview)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/ranking.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>æ’åºæ¨¡å‹ (Ranking)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/matching.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>å¬å›æ¨¡å‹ (Matching)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/mtl.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>å¤šä»»åŠ¡æ¨¡å‹ (MTL)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/models/generative.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>ç”Ÿæˆå¼æ¨¡å‹ (Generative)</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-sidebar has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _torch-rechub_zh_models_mtl" data-v-7011f0d8><div><h1 id="å¤šä»»åŠ¡æ¨¡å‹" tabindex="-1">å¤šä»»åŠ¡æ¨¡å‹ <a class="header-anchor" href="#å¤šä»»åŠ¡æ¨¡å‹" aria-label="Permalink to â€œå¤šä»»åŠ¡æ¨¡å‹â€">â€‹</a></h1><p>å¤šä»»åŠ¡å­¦ä¹ æ˜¯ä¸€ç§æœºå™¨å­¦ä¹ èŒƒå¼ï¼Œé€šè¿‡åŒæ—¶å­¦ä¹ å¤šä¸ªç›¸å…³ä»»åŠ¡æ¥æé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œæ€§èƒ½ã€‚åœ¨æ¨èç³»ç»Ÿä¸­ï¼Œå¤šä»»åŠ¡æ¨¡å‹å¸¸ç”¨äºåŒæ—¶ä¼˜åŒ–ç‚¹å‡»ç‡ï¼ˆCTRï¼‰ã€è½¬åŒ–ç‡ï¼ˆCVRï¼‰ã€ç”¨æˆ·ç•™å­˜ç­‰å¤šä¸ªç›¸å…³ç›®æ ‡ã€‚</p><h2 id="_1-sharedbottom" tabindex="-1">1. SharedBottom <a class="header-anchor" href="#_1-sharedbottom" aria-label="Permalink to â€œ1. SharedBottomâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>SharedBottom æ˜¯ä¸€ç§ç»å…¸çš„å¤šä»»åŠ¡å­¦ä¹ æ¨¡å‹ï¼Œæ‰€æœ‰ä»»åŠ¡å…±äº«åº•å±‚ç½‘ç»œï¼Œä¸Šå±‚æœ‰å„è‡ªçš„ä»»åŠ¡ç‰¹å®šç½‘ç»œã€‚</p><h3 id="æ ¸å¿ƒåŸç†" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>å…±äº«åº•å±‚</strong>ï¼šæ‰€æœ‰ä»»åŠ¡å…±äº«ä¸€ä¸ªåº•å±‚ç¥ç»ç½‘ç»œï¼Œå­¦ä¹ ä»»åŠ¡é—´çš„å…±äº«è¡¨ç¤º</li><li><strong>ä»»åŠ¡ç‰¹å®šé¡¶å±‚</strong>ï¼šæ¯ä¸ªä»»åŠ¡æœ‰è‡ªå·±çš„é¡¶å±‚ç½‘ç»œï¼Œå­¦ä¹ ä»»åŠ¡ç‰¹å®šçš„è¡¨ç¤º</li><li><strong>è”åˆè®­ç»ƒ</strong>ï¼šæ‰€æœ‰ä»»åŠ¡åŒæ—¶è®­ç»ƒï¼Œé€šè¿‡åå‘ä¼ æ’­æ›´æ–°å…±äº«åº•å±‚å’Œä»»åŠ¡ç‰¹å®šé¡¶å±‚</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.multi_task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SharedBottom</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.basic.features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SparseFeature, DenseFeature</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">common_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DenseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SharedBottom(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">common_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    task_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸¤ä¸ªåˆ†ç±»ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    bottom_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    tower_params_list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»»åŠ¡1çš„é¡¶å±‚å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»»åŠ¡2çš„é¡¶å±‚å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>features</td><td>list</td><td>æ‰€æœ‰ä»»åŠ¡å…±äº«çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>task_types</td><td>list</td><td>ä»»åŠ¡ç±»å‹åˆ—è¡¨ï¼Œæ”¯æŒ &quot;classification&quot; å’Œ &quot;regression&quot;</td><td>None</td></tr><tr><td>bottom_params</td><td>dict</td><td>å…±äº«åº•å±‚ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>tower_params_list</td><td>list</td><td>ä»»åŠ¡ç‰¹å®šé¡¶å±‚ç½‘ç»œå‚æ•°åˆ—è¡¨</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ä»»åŠ¡ç›¸å…³æ€§å¼ºçš„åœºæ™¯</li><li>æ•°æ®é‡æœ‰é™çš„åœºæ™¯</li><li>è®¡ç®—èµ„æºæœ‰é™çš„åœºæ™¯</li></ul><h2 id="_2-esmm" tabindex="-1">2. ESMM <a class="header-anchor" href="#_2-esmm" aria-label="Permalink to â€œ2. ESMMâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-1" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-1" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>ESMMï¼ˆEntire Space Multi-Task Modelï¼‰æ˜¯ä¸€ç§ç”¨äºè§£å†³æ ·æœ¬é€‰æ‹©åå·®é—®é¢˜çš„å¤šä»»åŠ¡å­¦ä¹ æ¨¡å‹ï¼Œç‰¹åˆ«é€‚ç”¨äºCTRå’ŒCVRè”åˆä¼˜åŒ–åœºæ™¯ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Xiao, Jun, et al. &quot;Entire space multi-task model: An effective approach for estimating post-click conversion rate.&quot; Proceedings of the 41st international ACM SIGIR conference on research &amp; development in information retrieval. 2018.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-1" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-1" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>å…¨ç©ºé—´å»ºæ¨¡</strong>ï¼šåœ¨æ•´ä¸ªæ ·æœ¬ç©ºé—´ä¸­å»ºæ¨¡CTRå’ŒCVRï¼Œé¿å…æ ·æœ¬é€‰æ‹©åå·®</li><li><strong>çº§è”å…³ç³»</strong>ï¼šåˆ©ç”¨CTRå’ŒCVRçš„çº§è”å…³ç³»ï¼ˆCTCVR = CTR * CVRï¼‰</li><li><strong>å…±äº«åº•å±‚</strong>ï¼šCTRå’ŒCVRä»»åŠ¡å…±äº«åº•å±‚ç½‘ç»œ</li><li><strong>ä»»åŠ¡ç‰¹å®šé¡¶å±‚</strong>ï¼šæ¯ä¸ªä»»åŠ¡æœ‰è‡ªå·±çš„é¡¶å±‚ç½‘ç»œ</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-1" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-1" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.multi_task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ESMM</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ESMM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">common_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    task_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># CTRå’ŒCVRéƒ½æ˜¯åˆ†ç±»ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    bottom_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    tower_params_list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># CTRä»»åŠ¡çš„é¡¶å±‚å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># CVRä»»åŠ¡çš„é¡¶å±‚å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-1" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-1" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>features</td><td>list</td><td>æ‰€æœ‰ä»»åŠ¡å…±äº«çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>task_types</td><td>list</td><td>ä»»åŠ¡ç±»å‹åˆ—è¡¨ï¼Œæ”¯æŒ &quot;classification&quot;</td><td>None</td></tr><tr><td>bottom_params</td><td>dict</td><td>å…±äº«åº•å±‚ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>tower_params_list</td><td>list</td><td>ä»»åŠ¡ç‰¹å®šé¡¶å±‚ç½‘ç»œå‚æ•°åˆ—è¡¨</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-1" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-1" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ç‚¹å‡»ç‡ï¼ˆCTRï¼‰å’Œè½¬åŒ–ç‡ï¼ˆCVRï¼‰è”åˆä¼˜åŒ–</li><li>å­˜åœ¨æ ·æœ¬é€‰æ‹©åå·®çš„åœºæ™¯</li><li>ç”µå•†æ¨èåœºæ™¯</li></ul><h2 id="_3-mmoe" tabindex="-1">3. MMOE <a class="header-anchor" href="#_3-mmoe" aria-label="Permalink to â€œ3. MMOEâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-2" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-2" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>MMOEï¼ˆMulti-gate Mixture-of-Expertsï¼‰æ˜¯ä¸€ç§å¤šé—¨æ§ä¸“å®¶æ··åˆæ¨¡å‹ï¼Œé€šè¿‡å¤šä¸ªä¸“å®¶ç½‘ç»œå’Œé—¨æ§æœºåˆ¶ï¼Œä¸ºä¸åŒä»»åŠ¡å­¦ä¹ ä¸åŒçš„ä¸“å®¶ç»„åˆã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-1" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-1" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Ma, Jiaqi, et al. &quot;Modeling task relationships in multi-task learning with multi-gate mixture-of-experts.&quot; Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining. 2018.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-2" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-2" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>ä¸“å®¶ç½‘ç»œ</strong>ï¼šå¤šä¸ªç‹¬ç«‹çš„ä¸“å®¶ç½‘ç»œï¼Œæ¯ä¸ªä¸“å®¶ç½‘ç»œå­¦ä¹ ä¸åŒçš„ç‰¹å¾è¡¨ç¤º</li><li><strong>é—¨æ§æœºåˆ¶</strong>ï¼šæ¯ä¸ªä»»åŠ¡æœ‰è‡ªå·±çš„é—¨æ§ç½‘ç»œï¼ŒåŠ¨æ€é€‰æ‹©ä¸“å®¶ç½‘ç»œçš„ç»„åˆ</li><li><strong>ä»»åŠ¡ç‰¹å®šé¡¶å±‚</strong>ï¼šæ¯ä¸ªä»»åŠ¡æœ‰è‡ªå·±çš„é¡¶å±‚ç½‘ç»œ</li><li><strong>è”åˆè®­ç»ƒ</strong>ï¼šæ‰€æœ‰ä»»åŠ¡åŒæ—¶è®­ç»ƒï¼Œæ›´æ–°ä¸“å®¶ç½‘ç»œã€é—¨æ§ç½‘ç»œå’Œä»»åŠ¡ç‰¹å®šé¡¶å±‚</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-2" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-2" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.multi_task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MMOE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MMOE(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">common_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    task_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;regression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ†ç±»ä»»åŠ¡å’Œå›å½’ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_expert</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸“å®¶ç½‘ç»œæ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    expert_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    tower_params_list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ†ç±»ä»»åŠ¡çš„é¡¶å±‚å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å›å½’ä»»åŠ¡çš„é¡¶å±‚å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-2" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-2" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>features</td><td>list</td><td>æ‰€æœ‰ä»»åŠ¡å…±äº«çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>task_types</td><td>list</td><td>ä»»åŠ¡ç±»å‹åˆ—è¡¨ï¼Œæ”¯æŒ &quot;classification&quot; å’Œ &quot;regression&quot;</td><td>None</td></tr><tr><td>n_expert</td><td>int</td><td>ä¸“å®¶ç½‘ç»œæ•°é‡</td><td>None</td></tr><tr><td>expert_params</td><td>dict</td><td>ä¸“å®¶ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>tower_params_list</td><td>list</td><td>ä»»åŠ¡ç‰¹å®šé¡¶å±‚ç½‘ç»œå‚æ•°åˆ—è¡¨</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-2" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-2" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ä»»åŠ¡é—´å­˜åœ¨å†²çªçš„åœºæ™¯</li><li>ä»»åŠ¡æ•°é‡è¾ƒå¤šçš„åœºæ™¯</li><li>éœ€è¦åŠ¨æ€è°ƒæ•´ä»»åŠ¡æƒé‡çš„åœºæ™¯</li></ul><h2 id="_4-ple" tabindex="-1">4. PLE <a class="header-anchor" href="#_4-ple" aria-label="Permalink to â€œ4. PLEâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-3" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-3" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>PLEï¼ˆProgressive Layered Extractionï¼‰æ˜¯ä¸€ç§æ¸è¿›å¼åˆ†å±‚æå–æ¨¡å‹ï¼Œå¼•å…¥äº†ä»»åŠ¡ç‰¹å®šä¸“å®¶å’Œå…±äº«ä¸“å®¶ï¼Œç¼“è§£äº†è´Ÿè¿ç§»é—®é¢˜ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-2" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-2" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Tang, Hongyan, et al. &quot;Progressive layered extraction (ple): A novel multi-task learning (mtl) model for personalized recommendations.&quot; Fourteenth ACM Conference on Recommender Systems. 2020.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-3" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-3" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>åˆ†å±‚ç»“æ„</strong>ï¼šåŒ…å«å¤šä¸ªPLEå±‚ï¼Œæ¯å±‚æœ‰ä»»åŠ¡ç‰¹å®šä¸“å®¶å’Œå…±äº«ä¸“å®¶</li><li><strong>ä»»åŠ¡ç‰¹å®šä¸“å®¶</strong>ï¼šåªå¯¹ç‰¹å®šä»»åŠ¡æœ‰ç”¨çš„ä¸“å®¶ç½‘ç»œ</li><li><strong>å…±äº«ä¸“å®¶</strong>ï¼šå¯¹æ‰€æœ‰ä»»åŠ¡éƒ½æœ‰ç”¨çš„ä¸“å®¶ç½‘ç»œ</li><li><strong>é—¨æ§æœºåˆ¶</strong>ï¼šæ¯ä¸ªä»»åŠ¡æœ‰è‡ªå·±çš„é—¨æ§ç½‘ç»œï¼Œé€‰æ‹©ä¸“å®¶ç½‘ç»œçš„ç»„åˆ</li><li><strong>æ¸è¿›å¼æå–</strong>ï¼šé€šè¿‡å¤šå±‚PLEç»“æ„ï¼Œæ¸è¿›å¼æå–ä»»åŠ¡ç‰¹å®šå’Œå…±äº«è¡¨ç¤º</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-3" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-3" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.multi_task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PLE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PLE(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">common_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    task_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;regression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PLEå±‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_expert_specific</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ¯å±‚ä»»åŠ¡ç‰¹å®šä¸“å®¶æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_expert_shared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ¯å±‚å…±äº«ä¸“å®¶æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    expert_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    tower_params_list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ†ç±»ä»»åŠ¡çš„é¡¶å±‚å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å›å½’ä»»åŠ¡çš„é¡¶å±‚å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-3" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-3" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>features</td><td>list</td><td>æ‰€æœ‰ä»»åŠ¡å…±äº«çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>task_types</td><td>list</td><td>ä»»åŠ¡ç±»å‹åˆ—è¡¨ï¼Œæ”¯æŒ &quot;classification&quot; å’Œ &quot;regression&quot;</td><td>None</td></tr><tr><td>n_level</td><td>int</td><td>PLEå±‚æ•°</td><td>None</td></tr><tr><td>n_expert_specific</td><td>int</td><td>æ¯å±‚ä»»åŠ¡ç‰¹å®šä¸“å®¶æ•°é‡</td><td>None</td></tr><tr><td>n_expert_shared</td><td>int</td><td>æ¯å±‚å…±äº«ä¸“å®¶æ•°é‡</td><td>None</td></tr><tr><td>expert_params</td><td>dict</td><td>ä¸“å®¶ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>tower_params_list</td><td>list</td><td>ä»»åŠ¡ç‰¹å®šé¡¶å±‚ç½‘ç»œå‚æ•°åˆ—è¡¨</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-3" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-3" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ä»»åŠ¡é—´å­˜åœ¨è¾ƒå¼ºå†²çªçš„åœºæ™¯</li><li>éœ€è¦ç¼“è§£è´Ÿè¿ç§»é—®é¢˜çš„åœºæ™¯</li><li>å¤æ‚å¤šä»»åŠ¡å­¦ä¹ åœºæ™¯</li></ul><h2 id="_5-aitm" tabindex="-1">5. AITM <a class="header-anchor" href="#_5-aitm" aria-label="Permalink to â€œ5. AITMâ€">â€‹</a></h2><h3 id="åŠŸèƒ½æè¿°-4" tabindex="-1">åŠŸèƒ½æè¿° <a class="header-anchor" href="#åŠŸèƒ½æè¿°-4" aria-label="Permalink to â€œåŠŸèƒ½æè¿°â€">â€‹</a></h3><p>AITMï¼ˆAdaptive Information Transfer Multi-taskï¼‰æ˜¯ä¸€ç§è‡ªé€‚åº”ä¿¡æ¯è¿ç§»å¤šä»»åŠ¡æ¨¡å‹ï¼Œèƒ½å¤Ÿè‡ªåŠ¨å­¦ä¹ ä»»åŠ¡é—´çš„ä¿¡æ¯è¿ç§»å…³ç³»ã€‚</p><h3 id="è®ºæ–‡å¼•ç”¨-3" tabindex="-1">è®ºæ–‡å¼•ç”¨ <a class="header-anchor" href="#è®ºæ–‡å¼•ç”¨-3" aria-label="Permalink to â€œè®ºæ–‡å¼•ç”¨â€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Tang, Jiaxi, et al. &quot;Learning Task Relationships in Multi-task Learning with Adaptive Information Transfer.&quot; Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery &amp; Data Mining. 2021.</span></span></code></pre></div><h3 id="æ ¸å¿ƒåŸç†-4" tabindex="-1">æ ¸å¿ƒåŸç† <a class="header-anchor" href="#æ ¸å¿ƒåŸç†-4" aria-label="Permalink to â€œæ ¸å¿ƒåŸç†â€">â€‹</a></h3><ul><li><strong>ä¿¡æ¯è¿ç§»æœºåˆ¶</strong>ï¼šè‡ªåŠ¨å­¦ä¹ ä»»åŠ¡é—´çš„ä¿¡æ¯è¿ç§»å…³ç³»</li><li><strong>ä»»åŠ¡ç‰¹å®šç½‘ç»œ</strong>ï¼šæ¯ä¸ªä»»åŠ¡æœ‰è‡ªå·±çš„ç½‘ç»œ</li><li><strong>æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶è‡ªé€‚åº”åœ°ä¼ é€’ä»»åŠ¡é—´çš„ä¿¡æ¯</li><li><strong>è”åˆè®­ç»ƒ</strong>ï¼šæ‰€æœ‰ä»»åŠ¡åŒæ—¶è®­ç»ƒï¼Œæ›´æ–°ä»»åŠ¡ç‰¹å®šç½‘ç»œå’Œä¿¡æ¯è¿ç§»æœºåˆ¶</li></ul><h3 id="ä½¿ç”¨æ–¹æ³•-4" tabindex="-1">ä½¿ç”¨æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-4" aria-label="Permalink to â€œä½¿ç”¨æ–¹æ³•â€">â€‹</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.multi_task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AITM</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AITM(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">common_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    task_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    bottom_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    tower_params_list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»»åŠ¡1çš„é¡¶å±‚å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»»åŠ¡2çš„é¡¶å±‚å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    attention_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;attention_dim&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ³¨æ„åŠ›æœºåˆ¶å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å‚æ•°è¯´æ˜-4" tabindex="-1">å‚æ•°è¯´æ˜ <a class="header-anchor" href="#å‚æ•°è¯´æ˜-4" aria-label="Permalink to â€œå‚æ•°è¯´æ˜â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>features</td><td>list</td><td>æ‰€æœ‰ä»»åŠ¡å…±äº«çš„ç‰¹å¾åˆ—è¡¨</td><td>None</td></tr><tr><td>task_types</td><td>list</td><td>ä»»åŠ¡ç±»å‹åˆ—è¡¨ï¼Œæ”¯æŒ &quot;classification&quot; å’Œ &quot;regression&quot;</td><td>None</td></tr><tr><td>bottom_params</td><td>dict</td><td>å…±äº«åº•å±‚ç½‘ç»œå‚æ•°</td><td>None</td></tr><tr><td>tower_params_list</td><td>list</td><td>ä»»åŠ¡ç‰¹å®šé¡¶å±‚ç½‘ç»œå‚æ•°åˆ—è¡¨</td><td>None</td></tr><tr><td>attention_params</td><td>dict</td><td>æ³¨æ„åŠ›æœºåˆ¶å‚æ•°</td><td>None</td></tr></tbody></table><h3 id="é€‚ç”¨åœºæ™¯-4" tabindex="-1">é€‚ç”¨åœºæ™¯ <a class="header-anchor" href="#é€‚ç”¨åœºæ™¯-4" aria-label="Permalink to â€œé€‚ç”¨åœºæ™¯â€">â€‹</a></h3><ul><li>ä»»åŠ¡é—´å­˜åœ¨ä¾èµ–å…³ç³»çš„åœºæ™¯</li><li>éœ€è¦è‡ªé€‚åº”ä¿¡æ¯è¿ç§»çš„åœºæ™¯</li><li>å¤æ‚å¤šä»»åŠ¡å­¦ä¹ åœºæ™¯</li></ul><h2 id="_6-æ¨¡å‹æ¯”è¾ƒ" tabindex="-1">6. æ¨¡å‹æ¯”è¾ƒ <a class="header-anchor" href="#_6-æ¨¡å‹æ¯”è¾ƒ" aria-label="Permalink to â€œ6. æ¨¡å‹æ¯”è¾ƒâ€">â€‹</a></h2><table tabindex="0"><thead><tr><th>æ¨¡å‹</th><th>å¤æ‚åº¦</th><th>è¡¨è¾¾èƒ½åŠ›</th><th>è®¡ç®—æ•ˆç‡</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>SharedBottom</td><td>ä½</td><td>ä¸­</td><td>é«˜</td><td>ä»»åŠ¡ç›¸å…³æ€§å¼ºã€èµ„æºæœ‰é™</td></tr><tr><td>ESMM</td><td>ä½</td><td>ä¸­</td><td>é«˜</td><td>CTR/CVRè”åˆä¼˜åŒ–ã€æ ·æœ¬é€‰æ‹©åå·®</td></tr><tr><td>MMOE</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>ä»»åŠ¡å†²çªã€å¤šä»»åŠ¡åœºæ™¯</td></tr><tr><td>PLE</td><td>é«˜</td><td>é«˜</td><td>ä½</td><td>å¤æ‚å¤šä»»åŠ¡ã€è´Ÿè¿ç§»ç¼“è§£</td></tr><tr><td>AITM</td><td>ä¸­</td><td>é«˜</td><td>ä¸­</td><td>ä»»åŠ¡ä¾èµ–ã€è‡ªé€‚åº”ä¿¡æ¯è¿ç§»</td></tr></tbody></table><h2 id="_7-ä½¿ç”¨å»ºè®®" tabindex="-1">7. ä½¿ç”¨å»ºè®® <a class="header-anchor" href="#_7-ä½¿ç”¨å»ºè®®" aria-label="Permalink to â€œ7. ä½¿ç”¨å»ºè®®â€">â€‹</a></h2><ol><li><p><strong>æ ¹æ®ä»»åŠ¡å…³ç³»é€‰æ‹©æ¨¡å‹</strong>ï¼š</p><ul><li>ä»»åŠ¡ç›¸å…³æ€§å¼ºæ—¶æ¨èä½¿ç”¨ SharedBottom</li><li>ä»»åŠ¡é—´å­˜åœ¨å†²çªæ—¶æ¨èä½¿ç”¨ MMOE æˆ– PLE</li><li>ä»»åŠ¡é—´å­˜åœ¨ä¾èµ–å…³ç³»æ—¶æ¨èä½¿ç”¨ AITM</li><li>å¤„ç†CTR/CVRè”åˆä¼˜åŒ–æ—¶æ¨èä½¿ç”¨ ESMM</li></ul></li><li><p><strong>æ ¹æ®è®¡ç®—èµ„æºé€‰æ‹©æ¨¡å‹</strong>ï¼š</p><ul><li>è®¡ç®—èµ„æºæœ‰é™æ—¶æ¨èä½¿ç”¨ SharedBottom æˆ– ESMM</li><li>è®¡ç®—èµ„æºå……è¶³æ—¶å¯ä»¥å°è¯• MMOEã€PLE æˆ– AITM</li></ul></li><li><p><strong>æ ¹æ®æ•°æ®é‡é€‰æ‹©æ¨¡å‹</strong>ï¼š</p><ul><li>æ•°æ®é‡è¾ƒå°æ—¶æ¨èä½¿ç”¨ç®€å•æ¨¡å‹ï¼ˆå¦‚ SharedBottomï¼‰</li><li>æ•°æ®é‡è¾ƒå¤§æ—¶å¯ä»¥å°è¯•æ›´å¤æ‚çš„æ¨¡å‹ï¼ˆå¦‚ PLEã€AITMï¼‰</li></ul></li><li><p><strong>å¤šä»»åŠ¡æƒé‡è°ƒæ•´</strong>ï¼š</p><ul><li>å¯ä»¥é€šè¿‡è°ƒæ•´æŸå¤±æƒé‡æ¥å¹³è¡¡ä¸åŒä»»åŠ¡çš„é‡è¦æ€§</li><li>å°è¯•ä½¿ç”¨è‡ªé€‚åº”æƒé‡æ–¹æ³•ï¼Œå¦‚ UWLLossã€GradNorm ç­‰</li></ul></li></ol><h2 id="_8-ä»£ç ç¤ºä¾‹-å®Œæ•´çš„å¤šä»»åŠ¡æ¨¡å‹è®­ç»ƒæµç¨‹" tabindex="-1">8. ä»£ç ç¤ºä¾‹ï¼šå®Œæ•´çš„å¤šä»»åŠ¡æ¨¡å‹è®­ç»ƒæµç¨‹ <a class="header-anchor" href="#_8-ä»£ç ç¤ºä¾‹-å®Œæ•´çš„å¤šä»»åŠ¡æ¨¡å‹è®­ç»ƒæµç¨‹" aria-label="Permalink to â€œ8. ä»£ç ç¤ºä¾‹ï¼šå®Œæ•´çš„å¤šä»»åŠ¡æ¨¡å‹è®­ç»ƒæµç¨‹â€">â€‹</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.multi_task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MMOE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.trainers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MTLTrainer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.utils.data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataGenerator</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.basic.features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SparseFeature, DenseFeature</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. å®šä¹‰ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">common_features </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SparseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;city&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vocab_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DenseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DenseFeature(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;income&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">embed_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. å‡†å¤‡æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å‡è®¾ x åŒ…å«æ‰€æœ‰ç‰¹å¾ï¼Œy åŒ…å«ä¸¤ä¸ªä»»åŠ¡çš„æ ‡ç­¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: user_id_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;city&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: city_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: age_data,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;income&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: income_data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;task1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: task1_labels,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç‚¹å‡»ç‡æ ‡ç­¾</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;task2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: task2_labels   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è½¬åŒ–ç‡æ ‡ç­¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. åˆ›å»ºæ•°æ®ç”Ÿæˆå™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataGenerator(x, y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">train_dl, val_dl, test_dl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dg.generate_dataloader(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">split_ratio</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">batch_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. åˆ›å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MMOE(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">common_features,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    task_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_expert</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    expert_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    tower_params_list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;activation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;relu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. åˆ›å»ºè®­ç»ƒå™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MTLTrainer(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    task_types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;classification&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    optimizer_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;lr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;weight_decay&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    adaptive_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;method&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;uwl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨è‡ªé€‚åº”æŸå¤±æƒé‡</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    n_epoch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    earlystop_patience</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cuda:0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    model_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;saved/mmoe&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 6. è®­ç»ƒæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer.fit(train_dl, val_dl)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 7. è¯„ä¼°æ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scores </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> trainer.evaluate(trainer.model, test_dl)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Task 1 AUC: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scores[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Task 2 AUC: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scores[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 8. å¯¼å‡ºONNXæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer.export_onnx(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mmoe.onnx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 9. æ¨¡å‹é¢„æµ‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">preds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> trainer.predict(trainer.model, test_dl)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Predictions shape: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">np.array(preds).shape</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="_9-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" tabindex="-1">9. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ <a class="header-anchor" href="#_9-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" aria-label="Permalink to â€œ9. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆâ€">â€‹</a></h2><h3 id="q-å¦‚ä½•å¤„ç†ä¸åŒä»»åŠ¡çš„æ•°æ®åˆ†å¸ƒå·®å¼‚" tabindex="-1">Q: å¦‚ä½•å¤„ç†ä¸åŒä»»åŠ¡çš„æ•°æ®åˆ†å¸ƒå·®å¼‚ï¼Ÿ <a class="header-anchor" href="#q-å¦‚ä½•å¤„ç†ä¸åŒä»»åŠ¡çš„æ•°æ®åˆ†å¸ƒå·®å¼‚" aria-label="Permalink to â€œQ: å¦‚ä½•å¤„ç†ä¸åŒä»»åŠ¡çš„æ•°æ®åˆ†å¸ƒå·®å¼‚ï¼Ÿâ€">â€‹</a></h3><p>A: å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li>å¯¹æ¯ä¸ªä»»åŠ¡çš„æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–æˆ–å½’ä¸€åŒ–</li><li>ä½¿ç”¨ä»»åŠ¡ç‰¹å®šçš„Embeddingå±‚</li><li>è°ƒæ•´ä»»åŠ¡æƒé‡ï¼Œå¹³è¡¡ä¸åŒä»»åŠ¡çš„é‡è¦æ€§</li><li>ä½¿ç”¨è‡ªé€‚åº”æƒé‡æ–¹æ³•ï¼Œå¦‚UWLLossã€GradNormç­‰</li></ul><h3 id="q-å¦‚ä½•ç¼“è§£å¤šä»»åŠ¡å­¦ä¹ ä¸­çš„è´Ÿè¿ç§»é—®é¢˜" tabindex="-1">Q: å¦‚ä½•ç¼“è§£å¤šä»»åŠ¡å­¦ä¹ ä¸­çš„è´Ÿè¿ç§»é—®é¢˜ï¼Ÿ <a class="header-anchor" href="#q-å¦‚ä½•ç¼“è§£å¤šä»»åŠ¡å­¦ä¹ ä¸­çš„è´Ÿè¿ç§»é—®é¢˜" aria-label="Permalink to â€œQ: å¦‚ä½•ç¼“è§£å¤šä»»åŠ¡å­¦ä¹ ä¸­çš„è´Ÿè¿ç§»é—®é¢˜ï¼Ÿâ€">â€‹</a></h3><p>A: å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li>ä½¿ç”¨ PLE æ¨¡å‹ï¼Œå¼•å…¥ä»»åŠ¡ç‰¹å®šä¸“å®¶å’Œå…±äº«ä¸“å®¶</li><li>ä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶ï¼Œè‡ªé€‚åº”åœ°é€‰æ‹©ä»»åŠ¡é—´çš„ä¿¡æ¯è¿ç§»</li><li>å‡å°‘å…±äº«å±‚çš„æ·±åº¦ï¼Œå¢åŠ ä»»åŠ¡ç‰¹å®šå±‚çš„æ·±åº¦</li><li>å°è¯•ä½¿ç”¨æ¨¡å‹é€‰æ‹©ç­–ç•¥ï¼Œé€‰æ‹©åˆé€‚çš„ä»»åŠ¡ç»„åˆ</li></ul><h3 id="q-å¦‚ä½•é€‰æ‹©åˆé€‚çš„ä»»åŠ¡ç»„åˆ" tabindex="-1">Q: å¦‚ä½•é€‰æ‹©åˆé€‚çš„ä»»åŠ¡ç»„åˆï¼Ÿ <a class="header-anchor" href="#q-å¦‚ä½•é€‰æ‹©åˆé€‚çš„ä»»åŠ¡ç»„åˆ" aria-label="Permalink to â€œQ: å¦‚ä½•é€‰æ‹©åˆé€‚çš„ä»»åŠ¡ç»„åˆï¼Ÿâ€">â€‹</a></h3><p>A: å¯ä»¥è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š</p><ul><li>ä»»åŠ¡é—´çš„ç›¸å…³æ€§ï¼šé€‰æ‹©ç›¸å…³æ€§è¾ƒé«˜çš„ä»»åŠ¡ç»„åˆ</li><li>ä»»åŠ¡çš„é‡è¦æ€§ï¼šé€‰æ‹©å¯¹ä¸šåŠ¡æ›´é‡è¦çš„ä»»åŠ¡</li><li>æ•°æ®é‡ï¼šé€‰æ‹©æ•°æ®é‡å……è¶³çš„ä»»åŠ¡</li><li>è®¡ç®—èµ„æºï¼šè€ƒè™‘æ¨¡å‹çš„è®¡ç®—å¤æ‚åº¦</li></ul><h3 id="q-å¦‚ä½•è¯„ä¼°å¤šä»»åŠ¡æ¨¡å‹çš„æ•ˆæœ" tabindex="-1">Q: å¦‚ä½•è¯„ä¼°å¤šä»»åŠ¡æ¨¡å‹çš„æ•ˆæœï¼Ÿ <a class="header-anchor" href="#q-å¦‚ä½•è¯„ä¼°å¤šä»»åŠ¡æ¨¡å‹çš„æ•ˆæœ" aria-label="Permalink to â€œQ: å¦‚ä½•è¯„ä¼°å¤šä»»åŠ¡æ¨¡å‹çš„æ•ˆæœï¼Ÿâ€">â€‹</a></h3><p>A: å¸¸ç”¨çš„è¯„ä¼°æŒ‡æ ‡åŒ…æ‹¬ï¼š</p><ul><li>å•ä¸ªä»»åŠ¡çš„è¯„ä¼°æŒ‡æ ‡ï¼ˆå¦‚ AUCã€F1ã€RMSE ç­‰ï¼‰</li><li>æ‰€æœ‰ä»»åŠ¡æŒ‡æ ‡çš„åŠ æƒå¹³å‡</li><li>å¸•ç´¯æ‰˜æœ€ä¼˜åˆ†æï¼šåœ¨å¤šä¸ªä»»åŠ¡é—´å¯»æ‰¾æœ€ä½³å¹³è¡¡ç‚¹</li><li>ä¸šåŠ¡æŒ‡æ ‡ï¼šæœ€ç»ˆçš„ä¸šåŠ¡æ•ˆæœï¼ˆå¦‚ç‚¹å‡»ç‡æå‡ã€è½¬åŒ–ç‡æå‡ç­‰ï¼‰</li></ul><h3 id="q-å¦‚ä½•è°ƒæ•´å¤šä»»åŠ¡æ¨¡å‹çš„è¶…å‚æ•°" tabindex="-1">Q: å¦‚ä½•è°ƒæ•´å¤šä»»åŠ¡æ¨¡å‹çš„è¶…å‚æ•°ï¼Ÿ <a class="header-anchor" href="#q-å¦‚ä½•è°ƒæ•´å¤šä»»åŠ¡æ¨¡å‹çš„è¶…å‚æ•°" aria-label="Permalink to â€œQ: å¦‚ä½•è°ƒæ•´å¤šä»»åŠ¡æ¨¡å‹çš„è¶…å‚æ•°ï¼Ÿâ€">â€‹</a></h3><p>A: å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li>ç½‘æ ¼æœç´¢æˆ–éšæœºæœç´¢ï¼šè°ƒæ•´ä¸“å®¶æ•°é‡ã€ç½‘ç»œæ·±åº¦ã€dropoutç‡ç­‰</li><li>è´å¶æ–¯ä¼˜åŒ–ï¼šæ›´é«˜æ•ˆåœ°æœç´¢æœ€ä¼˜è¶…å‚æ•°</li><li>è¿ç§»å­¦ä¹ ï¼šä»ç®€å•æ¨¡å‹çš„è¶…å‚æ•°å¼€å§‹è°ƒæ•´</li><li>ç»éªŒæ³•åˆ™ï¼šä¸“å®¶æ•°é‡ä¸€èˆ¬é€‰æ‹© 4-16 ä¸ªï¼Œç½‘ç»œæ·±åº¦é€‰æ‹© 2-4 å±‚</li></ul><h2 id="_10-å¤šä»»åŠ¡å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨åœºæ™¯" tabindex="-1">10. å¤šä»»åŠ¡å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨åœºæ™¯ <a class="header-anchor" href="#_10-å¤šä»»åŠ¡å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨åœºæ™¯" aria-label="Permalink to â€œ10. å¤šä»»åŠ¡å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨åœºæ™¯â€">â€‹</a></h2><ol><li><p><strong>ç”µå•†æ¨è</strong>ï¼š</p><ul><li>åŒæ—¶ä¼˜åŒ–ç‚¹å‡»ç‡ï¼ˆCTRï¼‰ã€è½¬åŒ–ç‡ï¼ˆCVRï¼‰ã€å®¢å•ä»·</li><li>ä¼˜åŒ–å•†å“æ¨èã€å¹¿å‘Šæ¨èã€ä¸ªæ€§åŒ–æœç´¢</li></ul></li><li><p><strong>å†…å®¹æ¨è</strong>ï¼š</p><ul><li>åŒæ—¶ä¼˜åŒ–ç‚¹å‡»ç‡ã€é˜…è¯»æ—¶é•¿ã€ç‚¹èµç‡ã€è¯„è®ºç‡</li><li>ä¼˜åŒ–æ–°é—»æ¨èã€è§†é¢‘æ¨èã€éŸ³ä¹æ¨è</li></ul></li><li><p><strong>ç¤¾äº¤åª’ä½“</strong>ï¼š</p><ul><li>åŒæ—¶ä¼˜åŒ–å¥½å‹æ¨èã€å†…å®¹æ¨èã€å¹¿å‘Šæ¨è</li><li>ä¼˜åŒ–ç”¨æˆ·ç•™å­˜ã€æ´»è·ƒåº¦ã€äº’åŠ¨ç‡</li></ul></li><li><p><strong>é‡‘èæ¨è</strong>ï¼š</p><ul><li>åŒæ—¶ä¼˜åŒ–è´·æ¬¾ç”³è¯·ç‡ã€è¿˜æ¬¾ç‡ã€é€¾æœŸç‡</li><li>ä¼˜åŒ–ç†è´¢äº§å“æ¨èã€ä¿¡ç”¨å¡æ¨è</li></ul></li></ol><h2 id="_11-æœªæ¥å‘å±•è¶‹åŠ¿" tabindex="-1">11. æœªæ¥å‘å±•è¶‹åŠ¿ <a class="header-anchor" href="#_11-æœªæ¥å‘å±•è¶‹åŠ¿" aria-label="Permalink to â€œ11. æœªæ¥å‘å±•è¶‹åŠ¿â€">â€‹</a></h2><ol><li><p><strong>åŠ¨æ€ä»»åŠ¡æƒé‡è°ƒæ•´</strong>ï¼š</p><ul><li>è‡ªé€‚åº”åœ°è°ƒæ•´ä¸åŒä»»åŠ¡çš„æƒé‡ï¼Œæ ¹æ®ä»»åŠ¡çš„é‡è¦æ€§å’Œéš¾åº¦åŠ¨æ€å˜åŒ–</li></ul></li><li><p><strong>è·¨é¢†åŸŸå¤šä»»åŠ¡å­¦ä¹ </strong>ï¼š</p><ul><li>åˆ©ç”¨ä¸åŒé¢†åŸŸçš„æ•°æ®å’Œä»»åŠ¡ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›</li></ul></li><li><p><strong>å±‚æ¬¡åŒ–å¤šä»»åŠ¡å­¦ä¹ </strong>ï¼š</p><ul><li>æ„å»ºä»»åŠ¡é—´çš„å±‚æ¬¡å…³ç³»ï¼Œæ›´æœ‰æ•ˆåœ°åˆ©ç”¨ä»»åŠ¡é—´çš„ç»“æ„ä¿¡æ¯</li></ul></li><li><p><strong>å¤šæ¨¡æ€å¤šä»»åŠ¡å­¦ä¹ </strong>ï¼š</p><ul><li>ç»“åˆæ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰å¤šç§æ¨¡æ€ï¼ŒåŒæ—¶å­¦ä¹ å¤šä¸ªä»»åŠ¡</li></ul></li><li><p><strong>å¤§è§„æ¨¡å¤šä»»åŠ¡å­¦ä¹ </strong>ï¼š</p><ul><li>æ”¯æŒæ•°ç™¾ä¸ªç”šè‡³æ•°åƒä¸ªä»»åŠ¡çš„åŒæ—¶å­¦ä¹ ï¼Œå¤„ç†æ›´å¤æ‚çš„æ¨èåœºæ™¯</li></ul></li></ol><p>å¤šä»»åŠ¡å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­å…·æœ‰å¹¿é˜”çš„åº”ç”¨å‰æ™¯ï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨ä»»åŠ¡é—´çš„å…³ç³»ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œæ€§èƒ½ã€‚Torch-RecHub æä¾›äº†å¤šç§å…ˆè¿›çš„å¤šä»»åŠ¡æ¨¡å‹ï¼Œæ–¹ä¾¿å¼€å‘è€…æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©å’Œä½¿ç”¨ã€‚</p></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/torch-rechub/zh/models/matching.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>å¬å›æ¨¡å‹ (Matching)</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/torch-rechub/zh/models/generative.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>ç”Ÿæˆå¼æ¨¡å‹ (Generative)</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_api.md\":\"DJkjBqY1\",\"blog_hllm_reproduction.md\":\"ChKe_XN3\",\"blog_match.md\":\"BedaiOiS\",\"blog_rank.md\":\"CjbEHKm4\",\"cache_api-basic.md\":\"CxBzBbeT\",\"cache_api-models.md\":\"_Nh38IC9\",\"cache_api-trainers.md\":\"qTIo5JV-\",\"cache_api-utils.md\":\"DMICx_Eb\",\"cache_hllm_reproduction.md\":\"DJwx9hU5\",\"cache_hstu_reproduction.md\":\"bQOULsOs\",\"cache_match.md\":\"BcCUbgKz\",\"cache_rank.md\":\"DiUyOquO\",\"cache_å‚è€ƒèµ„æ–™.md\":\"-t2bObt5\",\"community_changelog.md\":\"DI6L-6X3\",\"community_contributing.md\":\"xtydGDVG\",\"community_faq.md\":\"B2o2gfCA\",\"contributing.md\":\"B4CsM6F1\",\"core_data.md\":\"Bubnqsmb\",\"core_evaluation.md\":\"DLBJ7YIh\",\"core_features.md\":\"D6cNP9Y0\",\"core_intro.md\":\"Lk2AEgiP\",\"guide_install.md\":\"BKEyLNSv\",\"guide_intro.md\":\"CcqgfzKq\",\"guide_quick_start.md\":\"BafQ4m9I\",\"index.md\":\"BWkYO4CN\",\"introduction.md\":\"DCcoFN4C\",\"manual_api-reference_basic.md\":\"mdpaLngf\",\"manual_api-reference_models.md\":\"ClWTbT_c\",\"manual_api-reference_trainers.md\":\"DMq3Y4lN\",\"manual_api-reference_utils.md\":\"CwgYI4XX\",\"manual_faq.md\":\"Bt4nAaSb\",\"manual_getting-started.md\":\"D1tlYLXA\",\"manual_installation.md\":\"BEi4-tgX\",\"manual_tutorials_matching.md\":\"Drdc8zHk\",\"manual_tutorials_multi-task.md\":\"DUzIv4Pd\",\"manual_tutorials_ranking.md\":\"PE87Y6VF\",\"models_intro.md\":\"C8lRqRQK\",\"models_matching.md\":\"COwPnsEO\",\"models_mtl.md\":\"sP0ImAnD\",\"models_ranking.md\":\"D7MJwMCh\",\"serving_demo.md\":\"BR_nJdJp\",\"serving_intro.md\":\"Dbvd1QrA\",\"serving_onnx.md\":\"DrRUe4sH\",\"serving_vector_index.md\":\"D24mwGrX\",\"tools_callbacks.md\":\"Bs7UMuyY\",\"tools_intro.md\":\"dsxQIeoA\",\"tools_tracking.md\":\"ZPTrqYAs\",\"tools_visualization.md\":\"DDQwCOuE\",\"tutorials_ctr.md\":\"C2DkoDG-\",\"tutorials_intro.md\":\"6_GHNz3c\",\"tutorials_pipeline.md\":\"Cx5gWVpZ\",\"tutorials_retrieval.md\":\"QT31LYiv\",\"zh_api_api.md\":\"DVI6Mi62\",\"zh_community_changelog.md\":\"JvWSlN_3\",\"zh_community_contributing.md\":\"XG8ponp6\",\"zh_community_faq.md\":\"BpQXxVSl\",\"zh_core_data.md\":\"CvO2Pken\",\"zh_core_evaluation.md\":\"DR3CPkh0\",\"zh_core_features.md\":\"C3UgMFjz\",\"zh_core_intro.md\":\"C5-GowRG\",\"zh_guide_install.md\":\"BjMbjNWH\",\"zh_guide_intro.md\":\"Drdzv92U\",\"zh_guide_quick_start.md\":\"D3UL5FjI\",\"zh_index.md\":\"DvSpQJI5\",\"zh_models_generative.md\":\"B9Hc2oiC\",\"zh_models_intro.md\":\"Ckt95GI6\",\"zh_models_matching.md\":\"BPmlhh3Q\",\"zh_models_mtl.md\":\"CAMx5Qxv\",\"zh_models_ranking.md\":\"Cnb4xZjQ\",\"zh_serving_demo.md\":\"DUDfCT9o\",\"zh_serving_intro.md\":\"W9cxABun\",\"zh_serving_onnx.md\":\"BEGPf9Qt\",\"zh_serving_vector_index.md\":\"DmaohZpJ\",\"zh_tools_callbacks.md\":\"3an-IhME\",\"zh_tools_intro.md\":\"Chd53O0c\",\"zh_tools_tracking.md\":\"BBve1TKh\",\"zh_tools_visualization.md\":\"BjvRwYtC\",\"zh_tutorials_ctr.md\":\"DP55NTbQ\",\"zh_tutorials_intro.md\":\"2HyFqT62\",\"zh_tutorials_pipeline.md\":\"Byb65Sp2\",\"zh_tutorials_retrieval.md\":\"BnX5iygo\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"torch-rechub\",\"description\":\"A Lighting Pytorch Framework for Recommendation Models, Easy-to-use and Easy-to-extend.\",\"base\":\"/torch-rechub/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/img/logo.png\",\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/datawhalechina/torch-rechub\"}]},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\",\"themeConfig\":{\"nav\":[{\"text\":\"ğŸ  Home\",\"link\":\"/\"},{\"text\":\"ğŸš€ Getting Started\",\"link\":\"/guide/intro\"},{\"text\":\"âš™ï¸ Core\",\"link\":\"/core/intro\"},{\"text\":\"ğŸ° Models\",\"link\":\"/models/intro\"},{\"text\":\"ğŸ› ï¸ Tools\",\"link\":\"/tools/intro\"},{\"text\":\"ğŸš€ Serving\",\"link\":\"/serving/intro\"},{\"text\":\"ğŸ“– Tutorials\",\"link\":\"/tutorials/intro\"},{\"text\":\"â„¹ï¸ API\",\"link\":\"/api/api\"},{\"text\":\"ğŸ‘¥ Community\",\"link\":\"/community/faq\"}],\"sidebar\":{\"/guide/\":[{\"text\":\"ğŸš€ Getting Started\",\"items\":[{\"text\":\"Overview\",\"link\":\"/guide/intro\"},{\"text\":\"Installation\",\"link\":\"/guide/install\"},{\"text\":\"Quick Start\",\"link\":\"/guide/quick_start\"}]}],\"/core/\":[{\"text\":\"âš™ï¸ Core Components\",\"items\":[{\"text\":\"Overview\",\"link\":\"/core/intro\"},{\"text\":\"Feature Columns\",\"link\":\"/core/features\"},{\"text\":\"Data Pipeline\",\"link\":\"/core/data\"},{\"text\":\"Training & Eval\",\"link\":\"/core/evaluation\"}]}],\"/models/\":[{\"text\":\"ğŸ° Model Zoo\",\"items\":[{\"text\":\"Overview\",\"link\":\"/models/intro\"},{\"text\":\"Ranking Models\",\"link\":\"/models/ranking\"},{\"text\":\"Matching Models\",\"link\":\"/models/matching\"},{\"text\":\"Multi-Task Models\",\"link\":\"/models/mtl\"},{\"text\":\"Generative Models\",\"link\":\"/models/generative\"}]}],\"/tools/\":[{\"text\":\"ğŸ› ï¸ Dev Tools\",\"items\":[{\"text\":\"Overview\",\"link\":\"/tools/intro\"},{\"text\":\"Visualization\",\"link\":\"/tools/visualization\"},{\"text\":\"Experiment Tracking\",\"link\":\"/tools/tracking\"},{\"text\":\"Callbacks\",\"link\":\"/tools/callbacks\"}]}],\"/serving/\":[{\"text\":\"ğŸš€ Serving\",\"items\":[{\"text\":\"Overview\",\"link\":\"/serving/intro\"},{\"text\":\"ONNX & Quantization\",\"link\":\"/serving/onnx\"},{\"text\":\"Vector Indexing\",\"link\":\"/serving/vector_index\"},{\"text\":\"Serving Demo\",\"link\":\"/serving/demo\"}]}],\"/tutorials/\":[{\"text\":\"ğŸ“– Tutorials\",\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/intro\"},{\"text\":\"CTR Pipeline\",\"link\":\"/tutorials/ctr\"},{\"text\":\"Retrieval System\",\"link\":\"/tutorials/retrieval\"},{\"text\":\"Big Data Pipeline\",\"link\":\"/tutorials/pipeline\"}]}],\"/api/\":[{\"text\":\"â„¹ï¸ API Reference\",\"items\":[{\"text\":\"Main API\",\"link\":\"/api/api\"}]}],\"/community/\":[{\"text\":\"ğŸ“˜ Community\",\"items\":[{\"text\":\"FAQ\",\"link\":\"/community/faq\"},{\"text\":\"Contributing\",\"link\":\"/community/contributing\"},{\"text\":\"Changelog\",\"link\":\"/community/changelog\"}]}]}}},\"zh\":{\"label\":\"ä¸­æ–‡\",\"lang\":\"zh-CN\",\"link\":\"/zh/\",\"themeConfig\":{\"nav\":[{\"text\":\"ğŸ  é¦–é¡µ\",\"link\":\"/zh/\"},{\"text\":\"ğŸš€ å¿«é€Ÿå…¥é—¨\",\"link\":\"/zh/guide/intro\"},{\"text\":\"âš™ï¸ æ ¸å¿ƒç»„ä»¶\",\"link\":\"/zh/core/intro\"},{\"text\":\"ğŸ° æ¨¡å‹åº“\",\"link\":\"/zh/models/intro\"},{\"text\":\"ğŸ› ï¸ ç ”å‘å·¥å…·\",\"link\":\"/zh/tools/intro\"},{\"text\":\"ğŸš€ ç”Ÿäº§éƒ¨ç½²\",\"link\":\"/zh/serving/intro\"},{\"text\":\"ğŸ“– åœºæ™¯æ•™ç¨‹\",\"link\":\"/zh/tutorials/intro\"},{\"text\":\"â„¹ï¸ API\",\"link\":\"/zh/api/api\"},{\"text\":\"ğŸ‘¥ ç¤¾åŒº\",\"link\":\"/zh/community/faq\"}],\"sidebar\":{\"/zh/guide/\":[{\"text\":\"ğŸš€ å¿«é€Ÿå…¥é—¨\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/guide/intro\"},{\"text\":\"å®‰è£…æŒ‡å—\",\"link\":\"/zh/guide/install\"},{\"text\":\"3åˆ†é’Ÿä¸Šæ‰‹\",\"link\":\"/zh/guide/quick_start\"}]}],\"/zh/core/\":[{\"text\":\"âš™ï¸ æ ¸å¿ƒç»„ä»¶\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/core/intro\"},{\"text\":\"ç‰¹å¾å®šä¹‰ (Features)\",\"link\":\"/zh/core/features\"},{\"text\":\"æ•°æ®æµæ°´çº¿ (Data)\",\"link\":\"/zh/core/data\"},{\"text\":\"è®­ç»ƒä¸è¯„ä¼° (Eval)\",\"link\":\"/zh/core/evaluation\"}]}],\"/zh/models/\":[{\"text\":\"ğŸ° æ¨¡å‹åº“\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/models/intro\"},{\"text\":\"æ’åºæ¨¡å‹ (Ranking)\",\"link\":\"/zh/models/ranking\"},{\"text\":\"å¬å›æ¨¡å‹ (Matching)\",\"link\":\"/zh/models/matching\"},{\"text\":\"å¤šä»»åŠ¡æ¨¡å‹ (MTL)\",\"link\":\"/zh/models/mtl\"},{\"text\":\"ç”Ÿæˆå¼æ¨¡å‹ (Generative)\",\"link\":\"/zh/models/generative\"}]}],\"/zh/tools/\":[{\"text\":\"ğŸ› ï¸ ç ”å‘å·¥å…·\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/tools/intro\"},{\"text\":\"å¯è§†åŒ–ç›‘æ§\",\"link\":\"/zh/tools/visualization\"},{\"text\":\"å®éªŒè¿½è¸ª\",\"link\":\"/zh/tools/tracking\"},{\"text\":\"å›è°ƒå‡½æ•°\",\"link\":\"/zh/tools/callbacks\"}]}],\"/zh/serving/\":[{\"text\":\"ğŸš€ ç”Ÿäº§éƒ¨ç½²\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/serving/intro\"},{\"text\":\"ONNX å¯¼å‡ºä¸é‡åŒ–\",\"link\":\"/zh/serving/onnx\"},{\"text\":\"å‘é‡æ£€ç´¢å°è£…\",\"link\":\"/zh/serving/vector_index\"},{\"text\":\"åœ¨çº¿æœåŠ¡ç¤ºä¾‹\",\"link\":\"/zh/serving/demo\"}]}],\"/zh/tutorials/\":[{\"text\":\"ğŸ“– åœºæ™¯æ•™ç¨‹\",\"items\":[{\"text\":\"å¯¼è§ˆ (Overview)\",\"link\":\"/zh/tutorials/intro\"},{\"text\":\"CTR é¢„ä¼°æµç¨‹\",\"link\":\"/zh/tutorials/ctr\"},{\"text\":\"å¬å›ç³»ç»Ÿæ­å»º\",\"link\":\"/zh/tutorials/retrieval\"},{\"text\":\"å…¨é“¾è·¯æµæ°´çº¿\",\"link\":\"/zh/tutorials/pipeline\"}]}],\"/zh/api/\":[{\"text\":\"â„¹ï¸ API Reference\",\"items\":[{\"text\":\"API å‚è€ƒ\",\"link\":\"/zh/api/api\"}]}],\"/zh/community/\":[{\"text\":\"ğŸ“˜ ç¤¾åŒºä¿¡æ¯\",\"items\":[{\"text\":\"å¸¸è§é—®é¢˜ (FAQ)\",\"link\":\"/zh/community/faq\"},{\"text\":\"è´¡çŒ®æŒ‡å— (Contributing)\",\"link\":\"/zh/community/contributing\"},{\"text\":\"ç‰ˆæœ¬æ—¥å¿— (Changelog)\",\"link\":\"/zh/community/changelog\"}]}]}}}},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>