<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>模型 API 参考 | torch-rechub</title>
    <meta name="description" content="Torch-RecHub 所有模型的完整 API 文档，包括召回、排序和多任务学习模型">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/torch-rechub/assets/style.S8AY_U8R.css" as="style">
    <link rel="preload stylesheet" href="/torch-rechub/vp-icons.css" as="style">
    
    <script type="module" src="/torch-rechub/assets/app.BfS5OTDA.js"></script>
    <link rel="preload" href="/torch-rechub/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/torch-rechub/assets/chunks/theme.3xMu4BWr.js">
    <link rel="modulepreload" href="/torch-rechub/assets/chunks/framework.BwlcJEXh.js">
    <link rel="modulepreload" href="/torch-rechub/assets/zh_manual_api-reference_models.md.DZHCOd48.lean.js">
    <link rel="icon" href="/torch-rechub/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle has-sidebar" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/torch-rechub/zh/" data-v-1e38c6bc><!--[--><!--]--><!--[--><img class="VPImage logo" src="/torch-rechub/img/logo.png" alt data-v-8426fc1a><!--]--><span data-v-1e38c6bc>torch-rechub</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>首页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/introduction.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>项目介绍</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/manual/installation.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>项目文档</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/manual/api-reference/basic.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>API</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/blog/match.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>博客</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/torch-rechub/zh/contributing.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>贡献指南</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-70946a35 data-v-4c1766e2 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-42cb505d><span class="text" data-v-42cb505d><span class="vpi-languages option-icon" data-v-42cb505d></span><!----><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="items" data-v-4c1766e2><p class="title" data-v-4c1766e2>中文</p><!--[--><div class="VPMenuLink" data-v-4c1766e2 data-v-faf5b206><a class="VPLink link" href="/torch-rechub/manual/api-reference/models.html" lang="en" data-v-faf5b206><!--[--><span data-v-faf5b206>English</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/datawhalechina/torch-rechub" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="group translations" data-v-bf2fac68><p class="trans-title" data-v-bf2fac68>中文</p><!--[--><div class="VPMenuLink" data-v-bf2fac68 data-v-faf5b206><a class="VPLink link" href="/torch-rechub/manual/api-reference/models.html" lang="en" data-v-faf5b206><!--[--><span data-v-faf5b206>English</span><!--]--></a></div><!--]--></div><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/datawhalechina/torch-rechub" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-db738f89><span class="vpi-align-left menu-icon" data-v-db738f89></span><span class="menu-text" data-v-db738f89>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1df9f90f data-v-af661f50><div class="curtain" data-v-af661f50></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-af661f50><span class="visually-hidden" id="sidebar-aria-label" data-v-af661f50> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>入门指南</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/manual/installation.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>安装指南</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/manual/getting-started.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>快速开始</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>教程</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/manual/tutorials/matching.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>召回模型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/manual/tutorials/ranking.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>排序模型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/manual/tutorials/multi-task.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>多任务学习</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 has-active" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>API 参考</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/manual/api-reference/basic.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>基础组件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/manual/api-reference/models.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>模型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/manual/api-reference/trainers.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>训练器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/manual/api-reference/utils.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>工具类</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>其他</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/manual/faq.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>常见问题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/torch-rechub/zh/%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>参考资料</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-sidebar has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _torch-rechub_zh_manual_api-reference_models" data-v-7011f0d8><div><h1 id="模型-api-参考" tabindex="-1">模型 API 参考 <a class="header-anchor" href="#模型-api-参考" aria-label="Permalink to “模型 API 参考”">​</a></h1><p>这里详细介绍 Torch-RecHub 中各个模型的 API 接口和参数说明。</p><h2 id="召回模型-recall-models" tabindex="-1">召回模型 (Recall Models) <a class="header-anchor" href="#召回模型-recall-models" aria-label="Permalink to “召回模型 (Recall Models)”">​</a></h2><p>召回模型主要用于召回阶段，从海量候选集中快速检索相关物品。通常采用双塔结构或序列模型结构，以满足召回阶段的效率要求。</p><h3 id="双塔模型系列" tabindex="-1">双塔模型系列 <a class="header-anchor" href="#双塔模型系列" aria-label="Permalink to “双塔模型系列”">​</a></h3><h4 id="dssm-deep-structured-semantic-model" tabindex="-1">DSSM (Deep Structured Semantic Model) <a class="header-anchor" href="#dssm-deep-structured-semantic-model" aria-label="Permalink to “DSSM (Deep Structured Semantic Model)”">​</a></h4><ul><li><strong>简介</strong>：最早由微软提出的语义匹配模型，后被广泛应用于推荐系统。采用经典的双塔结构，分别对用户和物品进行表征，通过内积计算相似度。这种结构允许在线服务时预先计算物品向量，极大提高了服务效率。模型的关键在于如何学习到有效的用户和物品表征。</li><li><strong>参数</strong>： <ul><li><code>user_features</code> (list): 用户特征列表</li><li><code>item_features</code> (list): 物品特征列表</li><li><code>hidden_units</code> (list): 隐藏层单元数列表</li><li><code>dropout_rates</code> (list): Dropout比率列表</li><li><code>embedding_dim</code> (int): 最终的表征向量维度</li></ul></li></ul><h4 id="facebook-dssm" tabindex="-1">Facebook DSSM <a class="header-anchor" href="#facebook-dssm" aria-label="Permalink to “Facebook DSSM”">​</a></h4><ul><li><strong>简介</strong>：Facebook对DSSM的改进版本，引入多任务学习框架。除了主要的召回任务外，还增加了辅助任务来帮助学习更好的特征表征。模型可以同时优化多个相关目标，如点击、收藏、购买等，从而学习到更丰富的用户和物品表征。</li><li><strong>参数</strong>： <ul><li><code>user_features</code> (list): 用户特征列表</li><li><code>item_features</code> (list): 物品特征列表</li><li><code>hidden_units</code> (list): 隐藏层单元数列表</li><li><code>num_tasks</code> (int): 任务数量</li><li><code>task_types</code> (list): 任务类型列表</li></ul></li></ul><h4 id="youtube-dnn" tabindex="-1">YouTube DNN <a class="header-anchor" href="#youtube-dnn" aria-label="Permalink to “YouTube DNN”">​</a></h4><ul><li><strong>简介</strong>：YouTube提出的深度召回模型，针对大规模视频推荐场景设计。模型将用户观看历史通过平均池化进行聚合，并结合用户其他特征进行建模。创新性地引入了负采样技术和多任务学习框架，以提高模型的训练效率和效果。</li><li><strong>参数</strong>： <ul><li><code>user_features</code> (list): 用户特征列表</li><li><code>item_features</code> (list): 物品特征列表</li><li><code>hidden_units</code> (list): 隐藏层单元数列表</li><li><code>embedding_dim</code> (int): 嵌入维度</li><li><code>max_seq_len</code> (int): 最大序列长度</li></ul></li></ul><h3 id="序列推荐系列" tabindex="-1">序列推荐系列 <a class="header-anchor" href="#序列推荐系列" aria-label="Permalink to “序列推荐系列”">​</a></h3><h4 id="gru4rec" tabindex="-1">GRU4Rec <a class="header-anchor" href="#gru4rec" aria-label="Permalink to “GRU4Rec”">​</a></h4><ul><li><strong>简介</strong>：首次将GRU网络应用于会话序列推荐的开创性工作。通过GRU网络捕捉用户行为序列中的时序依赖关系，每个时间步的隐藏状态都包含了用户历史行为的信息。模型还引入了特殊的mini-batch构造方法和损失函数设计，以适应序列推荐的特点。</li><li><strong>参数</strong>： <ul><li><code>item_num</code> (int): 物品总数</li><li><code>hidden_size</code> (int): GRU隐藏层大小</li><li><code>num_layers</code> (int): GRU层数</li><li><code>dropout_rate</code> (float): Dropout比率</li><li><code>embedding_dim</code> (int): 物品嵌入维度</li></ul></li></ul><h4 id="narm-neural-attentive-recommendation-machine" tabindex="-1">NARM (Neural Attentive Recommendation Machine) <a class="header-anchor" href="#narm-neural-attentive-recommendation-machine" aria-label="Permalink to “NARM (Neural Attentive Recommendation Machine)”">​</a></h4><ul><li><strong>简介</strong>：在GRU4Rec基础上引入注意力机制的序列推荐模型。通过注意力机制，模型可以根据当前预测目标动态关注序列中的相关行为。模型维护全局和局部序列表征，全面捕捉用户的短期兴趣。这种设计能更好地处理用户兴趣的多样性和动态性。</li><li><strong>参数</strong>： <ul><li><code>item_num</code> (int): 物品总数</li><li><code>hidden_size</code> (int): 隐藏层大小</li><li><code>attention_size</code> (int): 注意力层大小</li><li><code>dropout_rate</code> (float): Dropout比率</li><li><code>embedding_dim</code> (int): 物品嵌入维度</li></ul></li></ul><h4 id="sasrec-self-attentive-sequential-recommendation" tabindex="-1">SASRec (Self-Attentive Sequential Recommendation) <a class="header-anchor" href="#sasrec-self-attentive-sequential-recommendation" aria-label="Permalink to “SASRec (Self-Attentive Sequential Recommendation)”">​</a></h4><ul><li><strong>简介</strong>：将Transformer结构应用于序列推荐的代表性工作。通过自注意力机制，模型可以直接计算和学习序列中任意两个行为之间的关系，不受RNN固有的序列依赖限制。位置编码帮助保留行为的时序信息，多层结构使模型能逐层提取越来越抽象的行为模式。相比RNN模型，具有更好的并行性和可扩展性。</li><li><strong>参数</strong>： <ul><li><code>item_num</code> (int): 物品总数</li><li><code>max_len</code> (int): 最大序列长度</li><li><code>num_heads</code> (int): 注意力头数</li><li><code>num_layers</code> (int): Transformer层数</li><li><code>hidden_size</code> (int): 隐藏层维度</li><li><code>dropout_rate</code> (float): Dropout比率</li></ul></li></ul><h4 id="mind-multi-interest-network-with-dynamic-routing" tabindex="-1">MIND (Multi-Interest Network with Dynamic routing) <a class="header-anchor" href="#mind-multi-interest-network-with-dynamic-routing" aria-label="Permalink to “MIND (Multi-Interest Network with Dynamic routing)”">​</a></h4><ul><li><strong>简介</strong>：为用户多样化兴趣设计的召回模型。通过胶囊网络和动态路由机制，从用户行为序列中提取多个兴趣向量。每个兴趣向量代表用户在不同方面的偏好，提供了更全面的用户兴趣分布表征。</li><li><strong>参数</strong>： <ul><li><code>item_num</code> (int): 物品总数</li><li><code>num_interests</code> (int): 兴趣向量数量</li><li><code>routing_iterations</code> (int): 动态路由迭代次数</li><li><code>hidden_size</code> (int): 隐藏层维度</li><li><code>embedding_dim</code> (int): 物品嵌入维度</li></ul></li></ul><h2 id="排序模型-ranking-models" tabindex="-1">排序模型 (Ranking Models) <a class="header-anchor" href="#排序模型-ranking-models" aria-label="Permalink to “排序模型 (Ranking Models)”">​</a></h2><p>排序模型主要用于精排阶段，对候选物品进行精确排序。通过深度学习方法学习用户与物品之间的复杂交互，生成最终的排序分数。</p><h3 id="wide-deep-系列" tabindex="-1">Wide &amp; Deep 系列 <a class="header-anchor" href="#wide-deep-系列" aria-label="Permalink to “Wide &amp; Deep 系列”">​</a></h3><h4 id="widedeep" tabindex="-1">WideDeep <a class="header-anchor" href="#widedeep" aria-label="Permalink to “WideDeep”">​</a></h4><ul><li><strong>简介</strong>：Google在2016年提出的经典模型，结合了线性模型和深度神经网络的优势。Wide部分通过特征交叉进行记忆，适合建模直接、显式的特征相关性；Deep部分通过深度网络进行泛化，能学习隐式、高阶的特征关系。这种结合使模型既能记忆历史模式，又能泛化到新模式。</li><li><strong>参数</strong>： <ul><li><code>wide_features</code> (list): Wide部分的特征列表，用于线性层</li><li><code>deep_features</code> (list): Deep部分的特征列表，用于深度网络</li><li><code>hidden_units</code> (list): 深度网络的隐藏层单元数列表，如[256, 128, 64]</li><li><code>dropout_rates</code> (list): 各层的Dropout比率，用于防止过拟合</li></ul></li></ul><h4 id="deepfm" tabindex="-1">DeepFM <a class="header-anchor" href="#deepfm" aria-label="Permalink to “DeepFM”">​</a></h4><ul><li><strong>简介</strong>：结合因子分解机(FM)特征交互和深度学习模型的模型。FM部分高效地建模二阶特征交互，Deep部分学习高阶特征关系。相比Wide&amp;Deep，DeepFM无需手工特征工程，能自动学习特征交叉。模型包含三部分：一阶特征、FM的二阶交互和深度网络的高阶交互。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 特征列表</li><li><code>hidden_units</code> (list): DNN部分的隐藏层单元数</li><li><code>dropout_rates</code> (list): Dropout比率列表</li><li><code>embedding_dim</code> (int): 特征嵌入维度</li></ul></li></ul><h4 id="dcn-dcn-v2" tabindex="-1">DCN / DCN-V2 <a class="header-anchor" href="#dcn-dcn-v2" aria-label="Permalink to “DCN / DCN-V2”">​</a></h4><ul><li><strong>简介</strong>：通过特殊设计的交叉网络层显式学习特征交互。每个交叉层在特征向量与其原始形式之间进行交互，随着深度增加，特征交叉的阶数也增加。DCN-V2改进了交叉网络参数化，提供&quot;向量&quot;和&quot;矩阵&quot;两种选项，在保持模型表达能力的同时提高效率。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 特征列表</li><li><code>cross_num</code> (int): 交叉层数</li><li><code>hidden_units</code> (list): DNN部分的隐藏层单元数</li><li><code>cross_parameterization</code> (str, DCN-V2): 交叉参数化方法，&quot;vector&quot;或&quot;matrix&quot;</li></ul></li></ul><h4 id="afm-attentional-factorization-machine" tabindex="-1">AFM (Attentional Factorization Machine) <a class="header-anchor" href="#afm-attentional-factorization-machine" aria-label="Permalink to “AFM (Attentional Factorization Machine)”">​</a></h4><ul><li><strong>简介</strong>：在FM基础上引入注意力机制，为不同的特征交互分配不同的重要性权重。通过注意力网络，自适应地学习特征交互的重要性，识别与预测目标更相关的特征组合。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 特征列表</li><li><code>attention_units</code> (list): 注意力网络的隐藏层单元数</li><li><code>embedding_dim</code> (int): 特征嵌入维度</li><li><code>dropout_rate</code> (float): 注意力网络的Dropout比率</li></ul></li></ul><h4 id="fibinet-feature-importance-and-bilinear-feature-interaction-network" tabindex="-1">FiBiNET (Feature Importance and Bilinear feature Interaction Network) <a class="header-anchor" href="#fibinet-feature-importance-and-bilinear-feature-interaction-network" aria-label="Permalink to “FiBiNET (Feature Importance and Bilinear feature Interaction Network)”">​</a></h4><ul><li><strong>简介</strong>：通过SENET机制动态学习特征重要性，使用双线性层进行特征交互。SENET模块帮助识别重要特征，双线性交互提供比内积更丰富的特征交互方式。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 特征列表</li><li><code>bilinear_type</code> (str): 双线性层类型，可选&quot;field_all&quot;/&quot;field_each&quot;/&quot;field_interaction&quot;</li><li><code>hidden_units</code> (list): DNN部分的隐藏层单元数</li><li><code>reduction_ratio</code> (int): SENET模块的缩放比率</li></ul></li></ul><h3 id="基于注意力的系列" tabindex="-1">基于注意力的系列 <a class="header-anchor" href="#基于注意力的系列" aria-label="Permalink to “基于注意力的系列”">​</a></h3><h4 id="din-deep-interest-network" tabindex="-1">DIN (Deep Interest Network) <a class="header-anchor" href="#din-deep-interest-network" aria-label="Permalink to “DIN (Deep Interest Network)”">​</a></h4><ul><li><strong>简介</strong>：为用户兴趣多样性设计的模型，使用注意力机制自适应学习用户历史行为。模型根据当前候选物品动态计算用户历史行为的相关性权重，从而激活相关用户兴趣，捕捉多样化用户偏好。创新性地将注意力机制引入推荐系统，开创了行为序列建模的新范式。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 基础特征列表</li><li><code>behavior_features</code> (list): 用于注意力计算的行为特征列表</li><li><code>attention_units</code> (list): 注意力网络的隐藏层单元数</li><li><code>hidden_units</code> (list): DNN部分的隐藏层单元数</li><li><code>activation</code> (str): 激活函数类型</li></ul></li></ul><h4 id="dien-deep-interest-evolution-network" tabindex="-1">DIEN (Deep Interest Evolution Network) <a class="header-anchor" href="#dien-deep-interest-evolution-network" aria-label="Permalink to “DIEN (Deep Interest Evolution Network)”">​</a></h4><ul><li><strong>简介</strong>：DIN的高级版本，通过兴趣演化层建模用户兴趣的动态演化。使用GRU结构捕捉兴趣演化，创新性地设计AUGRU(带注意力更新门的GRU)使兴趣演化过程感知目标物品。还包含辅助损失监督兴趣提取层的训练。这种设计既捕捉用户兴趣的动态变化，又建模兴趣的时序依赖。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 基础特征列表</li><li><code>behavior_features</code> (list): 行为特征列表</li><li><code>interest_units</code> (list): 兴趣提取层的单元数</li><li><code>gru_type</code> (str): GRU类型，&quot;AUGRU&quot;或&quot;AIGRU&quot;</li><li><code>hidden_units</code> (list): DNN部分的隐藏层单元数</li></ul></li></ul><h4 id="bst-behavior-sequence-transformer" tabindex="-1">BST (Behavior Sequence Transformer) <a class="header-anchor" href="#bst-behavior-sequence-transformer" aria-label="Permalink to “BST (Behavior Sequence Transformer)”">​</a></h4><ul><li><strong>简介</strong>：将Transformer架构引入推荐系统建模用户行为序列的开创性工作。通过自注意力机制，模型可以直接计算序列中任意两个行为之间的关系，克服RNN模型处理长序列的局限。位置嵌入帮助模型感知行为的时序信息，多头注意力使模型从多个角度理解用户行为模式。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 基础特征列表</li><li><code>behavior_features</code> (list): 行为特征列表</li><li><code>num_heads</code> (int): 注意力头数</li><li><code>num_layers</code> (int): Transformer层数</li><li><code>hidden_size</code> (int): 隐藏层维度</li><li><code>dropout_rate</code> (float): Dropout比率</li></ul></li></ul><h4 id="edcn-enhancing-explicit-and-implicit-feature-interactions" tabindex="-1">EDCN (Enhancing Explicit and Implicit Feature Interactions) <a class="header-anchor" href="#edcn-enhancing-explicit-and-implicit-feature-interactions" aria-label="Permalink to “EDCN (Enhancing Explicit and Implicit Feature Interactions)”">​</a></h4><ul><li><strong>简介</strong>：增强显式和隐式特征交互的深度交叉网络。通过新设计的交叉网络结构，同时考虑显式和隐式特征交互。引入门控机制调节不同阶特征交互的重要性，使用残差连接缓解深度网络的训练问题。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 特征列表</li><li><code>cross_num</code> (int): 交叉层数</li><li><code>hidden_units</code> (list): DNN部分的隐藏层单元数</li><li><code>gate_type</code> (str): 门控类型，&quot;FGU&quot;或&quot;BGU&quot;</li></ul></li></ul><h2 id="多任务模型-multi-task-models" tabindex="-1">多任务模型 (Multi-task Models) <a class="header-anchor" href="#多任务模型-multi-task-models" aria-label="Permalink to “多任务模型 (Multi-task Models)”">​</a></h2><p>多任务模型联合学习多个相关任务，实现知识共享和迁移，提升整体模型性能。</p><h3 id="sharedbottom" tabindex="-1">SharedBottom <a class="header-anchor" href="#sharedbottom" aria-label="Permalink to “SharedBottom”">​</a></h3><ul><li><strong>简介</strong>：最基础的多任务学习模型，在底层网络中共享参数以提取通用特征表征。共享层学习任务间的通用特征，而任务特定层学习各任务的个性化特征。这种简单而有效的结构为多任务学习奠定了基础。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 特征列表</li><li><code>hidden_units</code> (list): 共享网络的隐藏层单元数</li><li><code>task_hidden_units</code> (list): 任务特定网络的隐藏层单元数</li><li><code>num_tasks</code> (int): 任务数量</li><li><code>task_types</code> (list): 任务类型列表</li></ul></li></ul><h3 id="esmm-entire-space-multi-task-model" tabindex="-1">ESMM (Entire Space Multi-Task Model) <a class="header-anchor" href="#esmm-entire-space-multi-task-model" aria-label="Permalink to “ESMM (Entire Space Multi-Task Model)”">​</a></h3><ul><li><strong>简介</strong>：阿里巴巴提出的创新多任务模型，专门设计用于解决推荐系统中的样本选择偏差问题。通过联合建模CVR和CTR任务，在全空间进行参数学习。核心创新在于引入CTR作为辅助任务，通过任务乘法关系优化CVR估计。这种设计不仅解决了传统CVR估计中的样本选择偏差，还提供了无偏的CTR和CTCVR估计。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 特征列表</li><li><code>hidden_units</code> (list): 隐藏层单元数列表</li><li><code>tower_units</code> (list): 任务塔层的单元数列表</li><li><code>embedding_dim</code> (int): 特征嵌入维度</li></ul></li></ul><h3 id="mmoe-multi-gate-mixture-of-experts" tabindex="-1">MMoE (Multi-gate Mixture-of-Experts) <a class="header-anchor" href="#mmoe-multi-gate-mixture-of-experts" aria-label="Permalink to “MMoE (Multi-gate Mixture-of-Experts)”">​</a></h3><ul><li><strong>简介</strong>：Google提出的多任务学习模型，通过专家机制和任务相关的门控网络实现软参数共享。每个专家网络可学习特定的特征转换，门控网络动态为各任务分配专家重要性。这种设计使模型能根据任务需求灵活组合专家知识，有效处理任务差异。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 特征列表</li><li><code>expert_units</code> (list): 专家网络的隐藏层单元数</li><li><code>num_experts</code> (int): 专家数量</li><li><code>num_tasks</code> (int): 任务数量</li><li><code>expert_activation</code> (str): 专家网络的激活函数</li><li><code>gate_activation</code> (str): 门控网络的激活函数</li></ul></li></ul><h3 id="ple-progressive-layered-extraction" tabindex="-1">PLE (Progressive Layered Extraction) <a class="header-anchor" href="#ple-progressive-layered-extraction" aria-label="Permalink to “PLE (Progressive Layered Extraction)”">​</a></h3><ul><li><strong>简介</strong>：MMoE的改进版本，通过渐进式分层提取更好地建模任务关系。引入任务特定专家和共享专家的概念，通过多层专家网络实现渐进式特征提取。每层包含任务特定专家和共享专家，使模型既能学习任务的共性，又能学习个性。这种渐进式设计增强了模型的知识提取和迁移能力。</li><li><strong>参数</strong>： <ul><li><code>features</code> (list): 特征列表</li><li><code>expert_units</code> (list): 专家网络的单元数</li><li><code>num_experts</code> (int): 每层的专家数量</li><li><code>num_layers</code> (int): 层数</li><li><code>num_shared_experts</code> (int): 共享专家数量</li><li><code>task_types</code> (list): 任务类型列表</li></ul></li></ul></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/torch-rechub/zh/manual/api-reference/basic.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>基础组件</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/torch-rechub/zh/manual/api-reference/trainers.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>训练器</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"blog_hllm_reproduction.md\":\"yuV-SsBv\",\"blog_match.md\":\"CPuzcfjd\",\"blog_rank.md\":\"DGhQPaz2\",\"contributing.md\":\"CUorbUfd\",\"index.md\":\"Cqic6cYn\",\"introduction.md\":\"C3ivNS4w\",\"manual_api-reference_basic.md\":\"a1hQJN48\",\"manual_api-reference_models.md\":\"BC7332-F\",\"manual_api-reference_trainers.md\":\"C9gaUSvY\",\"manual_api-reference_utils.md\":\"Cz5MxAdE\",\"manual_faq.md\":\"Zh9C2F0s\",\"manual_getting-started.md\":\"BKnudMhe\",\"manual_installation.md\":\"BBUqxC3v\",\"manual_tutorials_matching.md\":\"BNFTZfwo\",\"manual_tutorials_multi-task.md\":\"aOxHv2Vy\",\"manual_tutorials_ranking.md\":\"DBqwdTv_\",\"zh_blog_hllm_reproduction.md\":\"KAgxJQQg\",\"zh_blog_hstu_reproduction.md\":\"DkK6C8Mp\",\"zh_blog_match.md\":\"RaF2lBou\",\"zh_blog_rank.md\":\"CKtohOpZ\",\"zh_contributing.md\":\"DWHWXL8s\",\"zh_index.md\":\"wym27tv7\",\"zh_introduction.md\":\"D1pMA1wf\",\"zh_manual_api-reference_basic.md\":\"-1li-g9-\",\"zh_manual_api-reference_models.md\":\"DZHCOd48\",\"zh_manual_api-reference_trainers.md\":\"CblIx0DK\",\"zh_manual_api-reference_utils.md\":\"DZb7to6c\",\"zh_manual_faq.md\":\"DBvLibvd\",\"zh_manual_getting-started.md\":\"R1Gsrjhx\",\"zh_manual_installation.md\":\"DgTR4l7H\",\"zh_manual_tutorials_matching.md\":\"CnaHtP6_\",\"zh_manual_tutorials_multi-task.md\":\"BYklIFEe\",\"zh_manual_tutorials_ranking.md\":\"DI2yGw4o\",\"zh_参考资料_参考资料.md\":\"DxRzuPtn\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"torch-rechub\",\"description\":\"A Lighting Pytorch Framework for Recommendation Models, Easy-to-use and Easy-to-extend.\",\"base\":\"/torch-rechub/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/img/logo.png\"},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\",\"title\":\"torch-rechub\",\"description\":\"A Lighting Pytorch Framework for Recommendation Models, Easy-to-use and Easy-to-extend.\",\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Introduction\",\"link\":\"/introduction\"},{\"text\":\"Documentation\",\"link\":\"/manual/installation\"},{\"text\":\"API\",\"link\":\"/manual/api-reference/basic\"},{\"text\":\"Blog\",\"link\":\"/blog/match\"},{\"text\":\"Contributing\",\"link\":\"/contributing\"}],\"sidebar\":{\"/manual/\":[{\"text\":\"Getting Started\",\"items\":[{\"text\":\"Installation\",\"link\":\"/manual/installation\"},{\"text\":\"Getting Started\",\"link\":\"/manual/getting-started\"}]},{\"text\":\"Tutorials\",\"items\":[{\"text\":\"Recall Models\",\"link\":\"/manual/tutorials/matching\"},{\"text\":\"Ranking Models\",\"link\":\"/manual/tutorials/ranking\"},{\"text\":\"Multi-Task Learning\",\"link\":\"/manual/tutorials/multi-task\"}]},{\"text\":\"API Reference\",\"items\":[{\"text\":\"Basic Components\",\"link\":\"/manual/api-reference/basic\"},{\"text\":\"Models\",\"link\":\"/manual/api-reference/models\"},{\"text\":\"Trainers\",\"link\":\"/manual/api-reference/trainers\"},{\"text\":\"Utilities\",\"link\":\"/manual/api-reference/utils\"}]},{\"text\":\"Others\",\"items\":[{\"text\":\"FAQ\",\"link\":\"/manual/faq\"}]}],\"/blog/\":[{\"text\":\"Blog\",\"items\":[{\"text\":\"Matching Training Guide\",\"link\":\"/blog/match\"},{\"text\":\"Ranking Training Guide\",\"link\":\"/blog/rank\"},{\"text\":\"HSTU Reproduction\",\"link\":\"/blog/hstu_reproduction\"},{\"text\":\"HLLM Reproduction\",\"link\":\"/blog/hllm_reproduction\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/datawhalechina/torch-rechub\"}]}},\"zh\":{\"label\":\"中文\",\"lang\":\"zh-CN\",\"title\":\"torch-rechub\",\"description\":\"一个基于 PyTorch 的易用、可扩展且高性能的推荐系统框架\",\"themeConfig\":{\"nav\":[{\"text\":\"首页\",\"link\":\"/zh/\"},{\"text\":\"项目介绍\",\"link\":\"/zh/introduction\"},{\"text\":\"项目文档\",\"link\":\"/zh/manual/installation\"},{\"text\":\"API\",\"link\":\"/zh/manual/api-reference/basic\"},{\"text\":\"博客\",\"link\":\"/zh/blog/match\"},{\"text\":\"贡献指南\",\"link\":\"/zh/contributing\"}],\"sidebar\":{\"/zh/manual/\":[{\"text\":\"入门指南\",\"items\":[{\"text\":\"安装指南\",\"link\":\"/zh/manual/installation\"},{\"text\":\"快速开始\",\"link\":\"/zh/manual/getting-started\"}]},{\"text\":\"教程\",\"items\":[{\"text\":\"召回模型\",\"link\":\"/zh/manual/tutorials/matching\"},{\"text\":\"排序模型\",\"link\":\"/zh/manual/tutorials/ranking\"},{\"text\":\"多任务学习\",\"link\":\"/zh/manual/tutorials/multi-task\"}]},{\"text\":\"API 参考\",\"items\":[{\"text\":\"基础组件\",\"link\":\"/zh/manual/api-reference/basic\"},{\"text\":\"模型\",\"link\":\"/zh/manual/api-reference/models\"},{\"text\":\"训练器\",\"link\":\"/zh/manual/api-reference/trainers\"},{\"text\":\"工具类\",\"link\":\"/zh/manual/api-reference/utils\"}]},{\"text\":\"其他\",\"items\":[{\"text\":\"常见问题\",\"link\":\"/zh/manual/faq\"},{\"text\":\"参考资料\",\"link\":\"/zh/参考资料/参考资料\"}]}],\"/zh/blog/\":[{\"text\":\"博客\",\"items\":[{\"text\":\"召回模型训练指南\",\"link\":\"/zh/blog/match\"},{\"text\":\"排序模型训练指南\",\"link\":\"/zh/blog/rank\"},{\"text\":\"HSTU 模型复现\",\"link\":\"/zh/blog/hstu_reproduction\"},{\"text\":\"HLLM 模型复现\",\"link\":\"/zh/blog/hllm_reproduction\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/datawhalechina/torch-rechub\"}]}}},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>