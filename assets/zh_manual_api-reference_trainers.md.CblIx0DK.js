import{_ as i,c as a,o as l,ah as o}from"./chunks/framework.BwlcJEXh.js";const p=JSON.parse('{"title":"训练器 API 参考","description":"Torch-RecHub 所有训练器的 API 文档，包括 CTRTrainer、MatchTrainer 和 MTLTrainer","frontmatter":{"title":"训练器 API 参考","description":"Torch-RecHub 所有训练器的 API 文档，包括 CTRTrainer、MatchTrainer 和 MTLTrainer"},"headers":[],"relativePath":"zh/manual/api-reference/trainers.md","filePath":"zh/manual/api-reference/trainers.md"}'),r={name:"zh/manual/api-reference/trainers.md"};function d(c,e,t,n,h,s){return l(),a("div",null,[...e[0]||(e[0]=[o('<h1 id="训练器-api-参考" tabindex="-1">训练器 API 参考 <a class="header-anchor" href="#训练器-api-参考" aria-label="Permalink to “训练器 API 参考”">​</a></h1><p>这里详细介绍 Torch-RecHub 中各个训练器的 API 接口和参数说明。</p><h2 id="ctrtrainer" tabindex="-1">CTRTrainer <a class="header-anchor" href="#ctrtrainer" aria-label="Permalink to “CTRTrainer”">​</a></h2><p>CTRTrainer 是一个用于单任务学习的通用训练器，主要用于点击率预测（CTR）等二分类任务。</p><h3 id="参数说明" tabindex="-1">参数说明 <a class="header-anchor" href="#参数说明" aria-label="Permalink to “参数说明”">​</a></h3><ul><li><code>model</code> (nn.Module): 任何单任务学习模型</li><li><code>optimizer_fn</code> (torch.optim): PyTorch优化器函数，默认为 <code>torch.optim.Adam</code></li><li><code>optimizer_params</code> (dict): 优化器参数，默认为 <code>{&quot;lr&quot;: 1e-3, &quot;weight_decay&quot;: 1e-5}</code></li><li><code>scheduler_fn</code> (torch.optim.lr_scheduler): PyTorch学习率调度器，例如 <code>torch.optim.lr_scheduler.StepLR</code></li><li><code>scheduler_params</code> (dict): 学习率调度器参数</li><li><code>n_epoch</code> (int): 训练轮数</li><li><code>earlystop_patience</code> (int): 早停耐心值，即在验证集性能多少轮未提升后停止训练，默认为10</li><li><code>device</code> (str): 使用的设备，可选 <code>&quot;cpu&quot;</code> 或 <code>&quot;cuda:0&quot;</code></li><li><code>gpus</code> (list): 多GPU ID列表，默认为空。如果长度&gt;=1，模型将被 nn.DataParallel 包装</li><li><code>loss_mode</code> (bool): 训练模式，默认为True</li><li><code>model_path</code> (str): 模型保存路径，默认为 <code>&quot;./&quot;</code></li></ul><h3 id="主要方法" tabindex="-1">主要方法 <a class="header-anchor" href="#主要方法" aria-label="Permalink to “主要方法”">​</a></h3><ul><li><code>train_one_epoch(data_loader, log_interval=10)</code>: 训练一个epoch</li><li><code>fit(train_dataloader, val_dataloader=None)</code>: 训练模型</li><li><code>evaluate(model, data_loader)</code>: 评估模型</li><li><code>predict(model, data_loader)</code>: 模型预测</li></ul><h2 id="matchtrainer" tabindex="-1">MatchTrainer <a class="header-anchor" href="#matchtrainer" aria-label="Permalink to “MatchTrainer”">​</a></h2><p>MatchTrainer 是一个用于匹配/检索任务的训练器，支持多种训练模式。</p><h3 id="参数说明-1" tabindex="-1">参数说明 <a class="header-anchor" href="#参数说明-1" aria-label="Permalink to “参数说明”">​</a></h3><ul><li><code>model</code> (nn.Module): 任何匹配模型</li><li><code>mode</code> (int): 训练模式，可选值： <ul><li>0: 逐点式(point-wise)</li><li>1: 成对式(pair-wise)</li><li>2: 列表式(list-wise)</li></ul></li><li><code>optimizer_fn</code> (torch.optim): 同CTRTrainer</li><li><code>optimizer_params</code> (dict): 同CTRTrainer</li><li><code>scheduler_fn</code> (torch.optim.lr_scheduler): 同CTRTrainer</li><li><code>scheduler_params</code> (dict): 同CTRTrainer</li><li><code>n_epoch</code> (int): 同CTRTrainer</li><li><code>earlystop_patience</code> (int): 同CTRTrainer</li><li><code>device</code> (str): 同CTRTrainer</li><li><code>gpus</code> (list): 同CTRTrainer</li><li><code>model_path</code> (str): 同CTRTrainer</li></ul><h3 id="主要方法-1" tabindex="-1">主要方法 <a class="header-anchor" href="#主要方法-1" aria-label="Permalink to “主要方法”">​</a></h3><ul><li><code>train_one_epoch(data_loader, log_interval=10)</code>: 训练一个epoch</li><li><code>fit(train_dataloader, val_dataloader=None)</code>: 训练模型</li><li><code>evaluate(model, data_loader)</code>: 评估模型</li><li><code>predict(model, data_loader)</code>: 模型预测</li><li><code>inference_embedding(model, mode, data_loader, model_path)</code>: 推理嵌入向量 <ul><li><code>mode</code>: &quot;user&quot;或&quot;item&quot;</li></ul></li></ul><h2 id="mtltrainer" tabindex="-1">MTLTrainer <a class="header-anchor" href="#mtltrainer" aria-label="Permalink to “MTLTrainer”">​</a></h2><p>MTLTrainer 是一个用于多任务学习的训练器，支持多种自适应损失加权方法。</p><h3 id="参数说明-2" tabindex="-1">参数说明 <a class="header-anchor" href="#参数说明-2" aria-label="Permalink to “参数说明”">​</a></h3><ul><li><code>model</code> (nn.Module): 任何多任务学习模型</li><li><code>task_types</code> (list): 任务类型列表，支持[&quot;classification&quot;, &quot;regression&quot;]</li><li><code>optimizer_fn</code> (torch.optim): 同CTRTrainer</li><li><code>optimizer_params</code> (dict): 同CTRTrainer</li><li><code>scheduler_fn</code> (torch.optim.lr_scheduler): 同CTRTrainer</li><li><code>scheduler_params</code> (dict): 同CTRTrainer</li><li><code>adaptive_params</code> (dict): 自适应损失加权方法参数，支持： <ul><li><code>{&quot;method&quot;: &quot;uwl&quot;}</code>: 不确定性加权损失</li><li><code>{&quot;method&quot;: &quot;metabalance&quot;}</code>: MetaBalance方法</li><li><code>{&quot;method&quot;: &quot;gradnorm&quot;, &quot;alpha&quot;: 0.16}</code>: GradNorm方法</li></ul></li><li><code>n_epoch</code> (int): 同CTRTrainer</li><li><code>earlystop_taskid</code> (int): 早停任务ID，默认为0</li><li><code>earlystop_patience</code> (int): 同CTRTrainer</li><li><code>device</code> (str): 同CTRTrainer</li><li><code>gpus</code> (list): 同CTRTrainer</li><li><code>model_path</code> (str): 同CTRTrainer</li></ul><h3 id="主要方法-2" tabindex="-1">主要方法 <a class="header-anchor" href="#主要方法-2" aria-label="Permalink to “主要方法”">​</a></h3><ul><li><code>train_one_epoch(data_loader)</code>: 训练一个epoch</li><li><code>fit(train_dataloader, val_dataloader, mode=&#39;base&#39;, seed=0)</code>: 训练模型</li><li><code>evaluate(model, data_loader)</code>: 评估模型</li><li><code>predict(model, data_loader)</code>: 模型预测</li></ul><h3 id="特殊功能" tabindex="-1">特殊功能 <a class="header-anchor" href="#特殊功能" aria-label="Permalink to “特殊功能”">​</a></h3><ol><li><p>支持多种自适应损失加权方法：</p><ul><li>UWL (不确定性加权损失)</li><li>MetaBalance</li><li>GradNorm</li></ul></li><li><p>多任务早停：</p><ul><li>基于指定任务性能的早停</li><li>根据验证集性能保存最佳模型权重</li></ul></li><li><p>支持多种任务类型组合：</p><ul><li>分类任务</li><li>回归任务</li></ul></li><li><p>训练日志记录：</p><ul><li>记录每个任务的损失</li><li>记录损失权重（使用自适应方法时）</li><li>记录验证集上的性能指标</li></ul></li></ol>',22)])])}const m=i(r,[["render",d]]);export{p as __pageData,m as default};
