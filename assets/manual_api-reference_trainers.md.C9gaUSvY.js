import{_ as a,c as i,o,ah as r}from"./chunks/framework.BwlcJEXh.js";const p=JSON.parse('{"title":"Trainers API Reference","description":"API documentation for all trainers including CTRTrainer, MatchTrainer, and MTLTrainer","frontmatter":{"title":"Trainers API Reference","description":"API documentation for all trainers including CTRTrainer, MatchTrainer, and MTLTrainer"},"headers":[],"relativePath":"manual/api-reference/trainers.md","filePath":"en/manual/api-reference/trainers.md"}'),l={name:"manual/api-reference/trainers.md"};function t(d,e,n,c,s,m){return o(),i("div",null,[...e[0]||(e[0]=[r('<h1 id="trainers-api-reference" tabindex="-1">Trainers API Reference <a class="header-anchor" href="#trainers-api-reference" aria-label="Permalink to “Trainers API Reference”">​</a></h1><p>This section provides detailed API documentation for all trainers in Torch-RecHub.</p><h2 id="ctrtrainer" tabindex="-1">CTRTrainer <a class="header-anchor" href="#ctrtrainer" aria-label="Permalink to “CTRTrainer”">​</a></h2><p>CTRTrainer is a general trainer for single task learning, primarily used for binary classification tasks such as Click-Through Rate (CTR) prediction.</p><h3 id="parameters" tabindex="-1">Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to “Parameters”">​</a></h3><ul><li><code>model</code> (nn.Module): Any single task learning model</li><li><code>optimizer_fn</code> (torch.optim): PyTorch optimizer function, defaults to <code>torch.optim.Adam</code></li><li><code>optimizer_params</code> (dict): Optimizer parameters, defaults to <code>{&quot;lr&quot;: 1e-3, &quot;weight_decay&quot;: 1e-5}</code></li><li><code>scheduler_fn</code> (torch.optim.lr_scheduler): PyTorch learning rate scheduler, e.g., <code>torch.optim.lr_scheduler.StepLR</code></li><li><code>scheduler_params</code> (dict): Learning rate scheduler parameters</li><li><code>n_epoch</code> (int): Number of training epochs</li><li><code>earlystop_patience</code> (int): Number of epochs to wait before early stopping when validation performance doesn&#39;t improve, defaults to 10</li><li><code>device</code> (str): Device to use, either <code>&quot;cpu&quot;</code> or <code>&quot;cuda:0&quot;</code></li><li><code>gpus</code> (list): List of GPU IDs, defaults to empty. If length &gt;=1, model will be wrapped by nn.DataParallel</li><li><code>loss_mode</code> (bool): Training mode, defaults to True</li><li><code>model_path</code> (str): Path to save the model, defaults to <code>&quot;./&quot;</code></li></ul><h3 id="main-methods" tabindex="-1">Main Methods <a class="header-anchor" href="#main-methods" aria-label="Permalink to “Main Methods”">​</a></h3><ul><li><code>train_one_epoch(data_loader, log_interval=10)</code>: Train for one epoch</li><li><code>fit(train_dataloader, val_dataloader=None)</code>: Train the model</li><li><code>evaluate(model, data_loader)</code>: Evaluate the model</li><li><code>predict(model, data_loader)</code>: Make predictions</li></ul><h2 id="matchtrainer" tabindex="-1">MatchTrainer <a class="header-anchor" href="#matchtrainer" aria-label="Permalink to “MatchTrainer”">​</a></h2><p>MatchTrainer is a trainer for matching/retrieval tasks, supporting multiple training modes.</p><h3 id="parameters-1" tabindex="-1">Parameters <a class="header-anchor" href="#parameters-1" aria-label="Permalink to “Parameters”">​</a></h3><ul><li><code>model</code> (nn.Module): Any matching model</li><li><code>mode</code> (int): Training mode, options: <ul><li>0: point-wise</li><li>1: pair-wise</li><li>2: list-wise</li></ul></li><li><code>optimizer_fn</code> (torch.optim): Same as CTRTrainer</li><li><code>optimizer_params</code> (dict): Same as CTRTrainer</li><li><code>scheduler_fn</code> (torch.optim.lr_scheduler): Same as CTRTrainer</li><li><code>scheduler_params</code> (dict): Same as CTRTrainer</li><li><code>n_epoch</code> (int): Same as CTRTrainer</li><li><code>earlystop_patience</code> (int): Same as CTRTrainer</li><li><code>device</code> (str): Same as CTRTrainer</li><li><code>gpus</code> (list): Same as CTRTrainer</li><li><code>model_path</code> (str): Same as CTRTrainer</li></ul><h3 id="main-methods-1" tabindex="-1">Main Methods <a class="header-anchor" href="#main-methods-1" aria-label="Permalink to “Main Methods”">​</a></h3><ul><li><code>train_one_epoch(data_loader, log_interval=10)</code>: Train for one epoch</li><li><code>fit(train_dataloader, val_dataloader=None)</code>: Train the model</li><li><code>evaluate(model, data_loader)</code>: Evaluate the model</li><li><code>predict(model, data_loader)</code>: Make predictions</li><li><code>inference_embedding(model, mode, data_loader, model_path)</code>: Infer embeddings <ul><li><code>mode</code>: Either &quot;user&quot; or &quot;item&quot;</li></ul></li></ul><h2 id="mtltrainer" tabindex="-1">MTLTrainer <a class="header-anchor" href="#mtltrainer" aria-label="Permalink to “MTLTrainer”">​</a></h2><p>MTLTrainer is a trainer for multi-task learning, supporting various adaptive loss weighting methods.</p><h3 id="parameters-2" tabindex="-1">Parameters <a class="header-anchor" href="#parameters-2" aria-label="Permalink to “Parameters”">​</a></h3><ul><li><code>model</code> (nn.Module): Any multi-task learning model</li><li><code>task_types</code> (list): List of task types, supports [&quot;classification&quot;, &quot;regression&quot;]</li><li><code>optimizer_fn</code> (torch.optim): Same as CTRTrainer</li><li><code>optimizer_params</code> (dict): Same as CTRTrainer</li><li><code>scheduler_fn</code> (torch.optim.lr_scheduler): Same as CTRTrainer</li><li><code>scheduler_params</code> (dict): Same as CTRTrainer</li><li><code>adaptive_params</code> (dict): Adaptive loss weighting method parameters, supports: <ul><li><code>{&quot;method&quot;: &quot;uwl&quot;}</code>: Uncertainty Weighted Loss</li><li><code>{&quot;method&quot;: &quot;metabalance&quot;}</code>: MetaBalance method</li><li><code>{&quot;method&quot;: &quot;gradnorm&quot;, &quot;alpha&quot;: 0.16}</code>: GradNorm method</li></ul></li><li><code>n_epoch</code> (int): Same as CTRTrainer</li><li><code>earlystop_taskid</code> (int): Task ID for early stopping, defaults to 0</li><li><code>earlystop_patience</code> (int): Same as CTRTrainer</li><li><code>device</code> (str): Same as CTRTrainer</li><li><code>gpus</code> (list): Same as CTRTrainer</li><li><code>model_path</code> (str): Same as CTRTrainer</li></ul><h3 id="main-methods-2" tabindex="-1">Main Methods <a class="header-anchor" href="#main-methods-2" aria-label="Permalink to “Main Methods”">​</a></h3><ul><li><code>train_one_epoch(data_loader)</code>: Train for one epoch</li><li><code>fit(train_dataloader, val_dataloader, mode=&#39;base&#39;, seed=0)</code>: Train the model</li><li><code>evaluate(model, data_loader)</code>: Evaluate the model</li><li><code>predict(model, data_loader)</code>: Make predictions</li></ul><h3 id="special-features" tabindex="-1">Special Features <a class="header-anchor" href="#special-features" aria-label="Permalink to “Special Features”">​</a></h3><ol><li><p>Support for Multiple Adaptive Loss Weighting Methods:</p><ul><li>UWL (Uncertainty Weighted Loss)</li><li>MetaBalance</li><li>GradNorm</li></ul></li><li><p>Multi-task Early Stopping:</p><ul><li>Early stopping based on specified task performance</li><li>Saves best model weights based on validation performance</li></ul></li><li><p>Support for Multiple Task Type Combinations:</p><ul><li>Classification tasks</li><li>Regression tasks</li></ul></li><li><p>Training Log Recording:</p><ul><li>Records loss for each task</li><li>Records loss weights (when using adaptive methods)</li><li>Records performance metrics on validation set</li></ul></li></ol>',22)])])}const u=a(l,[["render",t]]);export{p as __pageData,u as default};
