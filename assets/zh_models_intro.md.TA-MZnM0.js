import{_ as i,c as a,o as t,aj as h}from"./chunks/framework.BuEeO6_n.js";const o=JSON.parse('{"title":"模型库导览","description":"Torch-RecHub 模型库概述","frontmatter":{"title":"模型库导览","description":"Torch-RecHub 模型库概述"},"headers":[],"relativePath":"zh/models/intro.md","filePath":"zh/models/intro.md"}'),n={name:"zh/models/intro.md"};function l(e,s,r,k,d,p){return t(),a("div",null,[...s[0]||(s[0]=[h(`<h1 id="模型库导览" tabindex="-1">模型库导览 <a class="header-anchor" href="#模型库导览" aria-label="Permalink to “模型库导览”">​</a></h1><p>Torch-RecHub 提供了丰富的推荐模型库，涵盖了推荐系统的各个环节，包括排序、召回、多任务学习和生成式推荐。所有模型均基于 PyTorch 实现，易于使用和扩展。</p><h2 id="模型库结构" tabindex="-1">模型库结构 <a class="header-anchor" href="#模型库结构" aria-label="Permalink to “模型库结构”">​</a></h2><p>模型库按照推荐系统的不同阶段和任务类型进行组织：</p><ol><li><strong>排序模型 (Ranking)</strong>：用于精排阶段，预测用户对物品的点击率或偏好分数</li><li><strong>召回模型 (Matching)</strong>：用于粗排阶段，从海量物品中召回候选集</li><li><strong>多任务模型 (Multi-Task)</strong>：同时优化多个相关任务，提高模型的泛化能力</li><li><strong>生成式推荐 (Generative)</strong>：利用生成式模型生成个性化推荐</li></ol><h2 id="模型选择指南" tabindex="-1">模型选择指南 <a class="header-anchor" href="#模型选择指南" aria-label="Permalink to “模型选择指南”">​</a></h2><h3 id="排序模型选择" tabindex="-1">排序模型选择 <a class="header-anchor" href="#排序模型选择" aria-label="Permalink to “排序模型选择”">​</a></h3><table tabindex="0"><thead><tr><th>模型</th><th>适用场景</th><th>特点</th></tr></thead><tbody><tr><td>WideDeep</td><td>基础排序任务</td><td>结合线性模型和深度模型，兼顾记忆和泛化能力</td></tr><tr><td>DeepFM</td><td>特征交互重要的场景</td><td>同时捕获低阶和高阶特征交互</td></tr><tr><td>DCN/DCNv2</td><td>显式特征交叉场景</td><td>显式学习高阶特征交叉，计算效率高</td></tr><tr><td>DIN</td><td>用户兴趣动态变化场景</td><td>基于注意力机制捕捉用户兴趣</td></tr><tr><td>DIEN</td><td>长序列兴趣建模</td><td>建模用户兴趣的动态演化过程</td></tr><tr><td>BST</td><td>序列特征重要的场景</td><td>使用 Transformer 建模序列特征</td></tr><tr><td>AutoInt</td><td>自动特征交互学习</td><td>自动学习特征交互模式</td></tr></tbody></table><h3 id="召回模型选择" tabindex="-1">召回模型选择 <a class="header-anchor" href="#召回模型选择" aria-label="Permalink to “召回模型选择”">​</a></h3><table tabindex="0"><thead><tr><th>模型</th><th>适用场景</th><th>特点</th></tr></thead><tbody><tr><td>DSSM</td><td>文本匹配场景</td><td>双塔结构，将用户和物品映射到同一向量空间</td></tr><tr><td>YoutubeDNN</td><td>大规模推荐场景</td><td>基于用户行为序列的深度召回</td></tr><tr><td>MIND</td><td>多兴趣推荐场景</td><td>为用户学习多个兴趣表示</td></tr><tr><td>GRU4Rec/SASRec</td><td>序列推荐场景</td><td>建模用户近期行为序列</td></tr><tr><td>ComirecDR/ComirecSA</td><td>可控多兴趣推荐</td><td>允许控制生成的兴趣数量</td></tr></tbody></table><h3 id="多任务模型选择" tabindex="-1">多任务模型选择 <a class="header-anchor" href="#多任务模型选择" aria-label="Permalink to “多任务模型选择”">​</a></h3><table tabindex="0"><thead><tr><th>模型</th><th>适用场景</th><th>特点</th></tr></thead><tbody><tr><td>SharedBottom</td><td>任务相关性强的场景</td><td>所有任务共享底层网络</td></tr><tr><td>MMOE</td><td>任务冲突较大的场景</td><td>多门控专家混合，为不同任务学习不同专家组合</td></tr><tr><td>PLE</td><td>复杂多任务场景</td><td>渐进式分层提取，缓解负迁移问题</td></tr><tr><td>ESMM</td><td>样本选择偏差场景</td><td>全空间建模，解决样本选择偏差</td></tr><tr><td>AITM</td><td>任务间存在依赖关系</td><td>自适应信息迁移，学习任务间的依赖关系</td></tr></tbody></table><h3 id="生成式推荐选择" tabindex="-1">生成式推荐选择 <a class="header-anchor" href="#生成式推荐选择" aria-label="Permalink to “生成式推荐选择”">​</a></h3><table tabindex="0"><thead><tr><th>模型</th><th>适用场景</th><th>特点</th></tr></thead><tbody><tr><td>HSTU</td><td>大规模序列推荐</td><td>层级序列转换单元，支撑万亿参数推荐系统</td></tr><tr><td>HLLM</td><td>融合 LLM 能力的推荐</td><td>结合大语言模型的语义理解能力</td></tr></tbody></table><h2 id="模型文档导航" tabindex="-1">模型文档导航 <a class="header-anchor" href="#模型文档导航" aria-label="Permalink to “模型文档导航”">​</a></h2><h3 id="排序模型" tabindex="-1">排序模型 <a class="header-anchor" href="#排序模型" aria-label="Permalink to “排序模型”">​</a></h3><p>详细介绍各种排序模型的原理、使用方法和参数说明。</p><p><a href="/torch-rechub/zh/models/ranking.html">查看排序模型文档</a></p><h3 id="召回模型" tabindex="-1">召回模型 <a class="header-anchor" href="#召回模型" aria-label="Permalink to “召回模型”">​</a></h3><p>详细介绍各种召回模型的原理、使用方法和参数说明。</p><p><a href="/torch-rechub/zh/models/matching.html">查看召回模型文档</a></p><h3 id="多任务模型" tabindex="-1">多任务模型 <a class="header-anchor" href="#多任务模型" aria-label="Permalink to “多任务模型”">​</a></h3><p>详细介绍各种多任务模型的原理、使用方法和参数说明。</p><p><a href="/torch-rechub/zh/models/mtl.html">查看多任务模型文档</a></p><h3 id="生成式推荐模型" tabindex="-1">生成式推荐模型 <a class="header-anchor" href="#生成式推荐模型" aria-label="Permalink to “生成式推荐模型”">​</a></h3><p>详细介绍各种生成式推荐模型的原理、使用方法和参数说明。</p><p><a href="/torch-rechub/zh/models/generative.html">查看生成式推荐模型文档</a></p><h2 id="使用示例" tabindex="-1">使用示例 <a class="header-anchor" href="#使用示例" aria-label="Permalink to “使用示例”">​</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 排序模型使用示例</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.ranking </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DeepFM</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.trainers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CTRTrainer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建模型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DeepFM(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">deep_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deep_features, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fm_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fm_features, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mlp_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建训练器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CTRTrainer(model, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">optimizer_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;lr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cuda:0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 训练模型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer.fit(train_dataloader, val_dataloader)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 召回模型使用示例</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.models.matching </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DSSM</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch_rechub.trainers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MatchTrainer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建模型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DSSM(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">user_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_features, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">item_features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item_features, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">temperature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">             user_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]}, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">item_params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dims&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建训练器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MatchTrainer(model, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cuda:0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 训练模型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trainer.fit(train_dataloader)</span></span></code></pre></div><h2 id="贡献新模型" tabindex="-1">贡献新模型 <a class="header-anchor" href="#贡献新模型" aria-label="Permalink to “贡献新模型”">​</a></h2><p>如果您想贡献新的模型，请参考 <a href="/torch-rechub/zh/community/contributing.html">贡献指南</a>，遵循项目的编码规范和文档要求。</p>`,31)])])}const g=i(n,[["render",l]]);export{o as __pageData,g as default};
