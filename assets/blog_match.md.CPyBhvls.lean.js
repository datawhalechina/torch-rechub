import{_ as s,c as a,o as e,j as Q,aj as l,a as t}from"./chunks/framework.BuEeO6_n.js";const $=JSON.parse('{"title":"Matching Models Training Guide","description":"Comprehensive guide on loss functions, similarity metrics, and temperature scaling for matching models","frontmatter":{"title":"Matching Models Training Guide","description":"Comprehensive guide on loss functions, similarity metrics, and temperature scaling for matching models"},"headers":[],"relativePath":"blog/match.md","filePath":"en/blog/match.md"}'),m={name:"blog/match.md"},n={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.334ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 6335.7 1000","aria-hidden":"true"},o={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.721ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 10042.7 1000","aria-hidden":"true"},i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"23.422ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 10352.7 1000","aria-hidden":"true"},p={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.552ex"},xmlns:"http://www.w3.org/2000/svg",width:"57.492ex",height:"5.473ex",role:"img",focusable:"false",viewBox:"0 -1733 25411.4 2419","aria-hidden":"true"},H={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"53.758ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -683 23761.2 888","aria-hidden":"true"},w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.931ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -705 12787.3 910","aria-hidden":"true"},L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.627ex",height:"2.004ex",role:"img",focusable:"false",viewBox:"0 -846 4697 886","aria-hidden":"true"},M={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.835ex",height:"2.004ex",role:"img",focusable:"false",viewBox:"0 -846 4789 886","aria-hidden":"true"},Z={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.17ex"},xmlns:"http://www.w3.org/2000/svg",width:"20.035ex",height:"5.269ex",role:"img",focusable:"false",viewBox:"0 -1370 8855.4 2329","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.951ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 3514.2 888","aria-hidden":"true"},V={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.236ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.076ex",height:"3.503ex",role:"img",focusable:"false",viewBox:"0 -1002 6663.5 1548.4","aria-hidden":"true"},v={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.072ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3567.7 1000","aria-hidden":"true"},C={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},j={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-11.693ex"},xmlns:"http://www.w3.org/2000/svg",width:"57.685ex",height:"24.517ex",role:"img",focusable:"false",viewBox:"0 -5668.3 25496.6 10836.6","aria-hidden":"true"},A={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.783ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.361ex",height:"2.697ex",role:"img",focusable:"false",viewBox:"0 -846 6347.4 1191.9","aria-hidden":"true"},P={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.777ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.334ex",height:"2.949ex",role:"img",focusable:"false",viewBox:"0 -960 5009.6 1303.3","aria-hidden":"true"},E={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"44.361ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 19607.4 1000","aria-hidden":"true"},F={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.361ex",height:"1.946ex",role:"img",focusable:"false",viewBox:"0 -666 8115.6 860","aria-hidden":"true"},N={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"44.361ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 19607.4 1000","aria-hidden":"true"};function z(G,T,J,q,X,U){return e(),a("div",null,[T[60]||(T[60]=Q("h2",{id:"i-understanding-different-loss-functions-‚Äî-3-training-methods",tabindex:"-1"},[t("I. Understanding Different Loss Functions ‚Äî 3 Training Methods "),Q("a",{class:"header-anchor",href:"#i-understanding-different-loss-functions-‚Äî-3-training-methods","aria-label":"Permalink to ‚ÄúI. Understanding Different Loss Functions ‚Äî 3 Training Methods‚Äù"},"‚Äã")],-1)),T[61]||(T[61]=Q("p",null,[t("In recall tasks, there are generally three training methods: point-wise, pair-wise, and list-wise. In RecHub, we use the "),Q("em",null,[Q("strong",null,"mode")]),t(" parameter to specify the training method, with each method corresponding to a different loss function.")],-1)),T[62]||(T[62]=Q("h4",{id:"_1-1-point-wise-mode-0",tabindex:"-1"},[t("1.1 Point-wise (mode = 0) "),Q("a",{class:"header-anchor",href:"#_1-1-point-wise-mode-0","aria-label":"Permalink to ‚Äú1.1 Point-wise (mode = 0)‚Äù"},"‚Äã")],-1)),T[63]||(T[63]=Q("blockquote",null,[Q("p",null,[t("ü•∞"),Q("strong",null,"Core Idea: Treat recall as binary classification.")])],-1)),Q("p",null,[T[2]||(T[2]=t("For a recall model, the input is a tuple <User, Item>, and the output is ",-1)),Q("mjx-container",n,[(e(),a("svg",d,[...T[0]||(T[0]=[l("",1)])])),T[1]||(T[1]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"U"),Q("mi",null,"s"),Q("mi",null,"e"),Q("mi",null,"r"),Q("mo",null,","),Q("mi",null,"I"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"m"),Q("mo",{stretchy:"false"},")")])],-1))]),T[3]||(T[3]=t(", representing the user's interest level in the item.",-1))]),T[64]||(T[64]=Q("p",null,"Training objective: For positive samples, the output should be as close to 1 as possible; for negative samples, as close to 0 as possible.",-1)),T[65]||(T[65]=Q("p",null,"The most commonly used loss function is BCELoss (Binary Cross Entropy Loss).",-1)),T[66]||(T[66]=Q("h4",{id:"_1-2-pair-wise-mode-1",tabindex:"-1"},[t("1.2 Pair-wise (mode = 1) "),Q("a",{class:"header-anchor",href:"#_1-2-pair-wise-mode-1","aria-label":"Permalink to ‚Äú1.2 Pair-wise (mode = 1)‚Äù"},"‚Äã")],-1)),T[67]||(T[67]=Q("blockquote",null,[Q("p",null,[t("üòù"),Q("strong",null,"Core Idea: A user's interest in positive samples should be higher than in negative samples.")])],-1)),Q("p",null,[T[8]||(T[8]=t("For a recall model, the input is a triple <User, ItemPositive, ItemNegative>, outputting interest scores ",-1)),Q("mjx-container",o,[(e(),a("svg",r,[...T[4]||(T[4]=[l("",1)])])),T[5]||(T[5]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"U"),Q("mi",null,"s"),Q("mi",null,"e"),Q("mi",null,"r"),Q("mo",null,","),Q("mi",null,"I"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"m"),Q("mi",null,"P"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mi",null,"i"),Q("mi",null,"t"),Q("mi",null,"i"),Q("mi",null,"v"),Q("mi",null,"e"),Q("mo",{stretchy:"false"},")")])],-1))]),T[9]||(T[9]=t(" and ",-1)),Q("mjx-container",i,[(e(),a("svg",h,[...T[6]||(T[6]=[l("",1)])])),T[7]||(T[7]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"U"),Q("mi",null,"s"),Q("mi",null,"e"),Q("mi",null,"r"),Q("mo",null,","),Q("mi",null,"I"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"m"),Q("mi",null,"N"),Q("mi",null,"e"),Q("mi",null,"g"),Q("mi",null,"a"),Q("mi",null,"t"),Q("mi",null,"i"),Q("mi",null,"v"),Q("mi",null,"e"),Q("mo",{stretchy:"false"},")")])],-1))]),T[10]||(T[10]=t(", representing the user's interest scores for positive and negative item samples.",-1))]),T[68]||(T[68]=Q("p",null,"Training objective: The interest score for positive samples should be higher than that for negative samples.",-1)),T[69]||(T[69]=Q("p",null,[t("The framework uses BPRLoss (Bayes Personalized Ranking Loss). Here's the loss formula (for more details, see "),Q("a",{href:"https://www.cnblogs.com/pinard/p/9128682.html",title:"here",target:"_blank",rel:"noreferrer"},"here"),t(" - note that there are slight differences between the linked content and the formula below, but the core idea remains the same):")],-1)),Q("mjx-container",p,[(e(),a("svg",g,[...T[11]||(T[11]=[l("",1)])])),T[12]||(T[12]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"L"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mi",null,"s"),Q("mo",null,"="),Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"N")]),Q("mover",null,[Q("mo",{"data-mjx-texclass":"OP"},"‚àë"),Q("mi",null,"N")]),Q("msub",null,[Q("mtext",null,"¬†"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")])]),Q("mo",null,"‚àí"),Q("mi",null,"l"),Q("mi",null,"o"),Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"s"),Q("mi",null,"i"),Q("mi",null,"g"),Q("mi",null,"m"),Q("mi",null,"o"),Q("mi",null,"i"),Q("mi",null,"d"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"p"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mi",{mathvariant:"normal"},"_"),Q("mi",null,"s"),Q("mi",null,"c"),Q("mi",null,"o"),Q("mi",null,"r"),Q("mi",null,"e"),Q("mo",null,"‚àí"),Q("mi",null,"n"),Q("mi",null,"e"),Q("mi",null,"g"),Q("mi",{mathvariant:"normal"},"_"),Q("mi",null,"s"),Q("mi",null,"c"),Q("mi",null,"o"),Q("mi",null,"r"),Q("mi",null,"e"),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")")])],-1))]),T[70]||(T[70]=Q("hr",null,null,-1)),T[71]||(T[71]=Q("h4",{id:"_1-3-list-wise-mode-2",tabindex:"-1"},[t("1.3 List-wise (mode = 2) "),Q("a",{class:"header-anchor",href:"#_1-3-list-wise-mode-2","aria-label":"Permalink to ‚Äú1.3 List-wise (mode = 2)‚Äù"},"‚Äã")],-1)),T[72]||(T[72]=Q("blockquote",null,[Q("p",null,[t("üòá"),Q("strong",null,"Core Idea: A user's interest in positive samples should be higher than in negative samples.")])],-1)),T[73]||(T[73]=Q("p",null,"Wait, isn't this the same as Pair-wise?",-1)),T[74]||(T[74]=Q("p",null,"Yes! The core idea of List-wise training is the same as Pair-wise, but the implementation differs.",-1)),Q("p",null,[T[15]||(T[15]=t("For a recall model, the input is an N+2 tuple ",-1)),Q("mjx-container",H,[(e(),a("svg",u,[...T[13]||(T[13]=[l("",1)])])),T[14]||(T[14]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",null,"<"),Q("mi",null,"U"),Q("mi",null,"s"),Q("mi",null,"e"),Q("mi",null,"r"),Q("mo",null,","),Q("mi",null,"I"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"m"),Q("mi",null,"P"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mi",null,"i"),Q("mi",null,"t"),Q("mi",null,"i"),Q("mi",null,"v"),Q("mi",null,"e"),Q("mo",null,","),Q("mi",null,"I"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"m"),Q("mi",null,"N"),Q("mi",null,"e"),Q("mi",null,"g"),Q("mi",{mathvariant:"normal"},"_"),Q("mn",null,"1"),Q("mo",null,","),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,","),Q("mi",null,"I"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"m"),Q("mi",null,"N"),Q("mi",null,"e"),Q("mi",null,"g"),Q("mi",{mathvariant:"normal"},"_"),Q("mi",null,"N"),Q("mo",null,">")])],-1))]),T[16]||(T[16]=t(", outputting interest scores for 1 positive sample and N negative samples.",-1))]),T[75]||(T[75]=Q("p",null,"Training objective: The interest score for the positive sample should be higher than all negative samples.",-1)),Q("p",null,[T[19]||(T[19]=t("The framework uses ",-1)),Q("mjx-container",w,[(e(),a("svg",c,[...T[17]||(T[17]=[l("",1)])])),T[18]||(T[18]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"t"),Q("mi",null,"o"),Q("mi",null,"r"),Q("mi",null,"c"),Q("mi",null,"h"),Q("mo",null,"."),Q("mi",null,"n"),Q("mi",null,"n"),Q("mo",null,"."),Q("mi",null,"C"),Q("mi",null,"r"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mi",null,"s"),Q("mi",null,"E"),Q("mi",null,"n"),Q("mi",null,"t"),Q("mi",null,"r"),Q("mi",null,"o"),Q("mi",null,"p"),Q("mi",null,"y"),Q("mi",null,"L"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mi",null,"s")])],-1))]),T[20]||(T[20]=t(", applying Softmax to the outputs.",-1))]),T[76]||(T[76]=Q("blockquote",null,[Q("p",null,"PS: This List-wise approach can be easily confused with List-wise in Ranking. Although they share the same name, List-wise in ranking considers the order relationship between samples. For example, ranking uses order-sensitive metrics like MAP and NDCG for evaluation, while List-wise in Matching doesn't consider order.")],-1)),T[77]||(T[77]=Q("h2",{id:"ii-how-far-apart-are-two-vectors-‚Äî-3-similarity-metrics",tabindex:"-1"},[t("II. How Far Apart Are Two Vectors? ‚Äî 3 Similarity Metrics "),Q("a",{class:"header-anchor",href:"#ii-how-far-apart-are-two-vectors-‚Äî-3-similarity-metrics","aria-label":"Permalink to ‚ÄúII. How Far Apart Are Two Vectors? ‚Äî 3 Similarity Metrics‚Äù"},"‚Äã")],-1)),T[78]||(T[78]=Q("blockquote",null,[Q("p",null,"ü§îGiven a user vector and an item vector, how do we measure their similarity?")],-1)),Q("p",null,[T[25]||(T[25]=t("Let's first define user vector ",-1)),Q("mjx-container",L,[(e(),a("svg",f,[...T[21]||(T[21]=[l("",1)])])),T[22]||(T[22]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"u"),Q("mi",null,"s"),Q("mi",null,"e"),Q("mi",null,"r"),Q("mo",null,"‚àà"),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"R")]),Q("mi",null,"D")])])],-1))]),T[26]||(T[26]=t(" and item vector ",-1)),Q("mjx-container",M,[(e(),a("svg",y,[...T[23]||(T[23]=[l("",1)])])),T[24]||(T[24]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"i"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"m"),Q("mo",null,"‚àà"),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"R")]),Q("mi",null,"D")])])],-1))]),T[27]||(T[27]=t(", where D represents their dimension.",-1))]),T[79]||(T[79]=Q("h3",{id:"_2-1-cosine",tabindex:"-1"},[t("2.1 Cosine "),Q("a",{class:"header-anchor",href:"#_2-1-cosine","aria-label":"Permalink to ‚Äú2.1 Cosine‚Äù"},"‚Äã")],-1)),T[80]||(T[80]=Q("p",null,"From middle school math:",-1)),Q("mjx-container",Z,[(e(),a("svg",k,[...T[28]||(T[28]=[l("",1)])])),T[29]||(T[29]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"c"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"a"),Q("mo",null,","),Q("mi",null,"b"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mfrac",null,[Q("mrow",null,[Q("mo",null,"<"),Q("mi",null,"a"),Q("mo",null,","),Q("mi",null,"b"),Q("mo",null,">")]),Q("mrow",null,[Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mi",null,"a"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mo",null,"‚àó"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mi",null,"b"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])])],-1))]),T[81]||(T[81]=Q("p",null,"This represents the angle between two vectors, outputting a real number between [-1, 1]. We can use this as a similarity measure: the smaller the angle between vectors, the more similar they are.",-1)),T[82]||(T[82]=Q("p",null,"In all two-tower models in RecHub, cosine similarity is used during the training phase.",-1)),T[83]||(T[83]=Q("h3",{id:"_2-2-dot-product",tabindex:"-1"},[t("2.2 Dot Product "),Q("a",{class:"header-anchor",href:"#_2-2-dot-product","aria-label":"Permalink to ‚Äú2.2 Dot Product‚Äù"},"‚Äã")],-1)),Q("p",null,[T[32]||(T[32]=t("This is the inner product of vectors, denoted as ",-1)),Q("mjx-container",x,[(e(),a("svg",D,[...T[30]||(T[30]=[l("",1)])])),T[31]||(T[31]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",null,"<"),Q("mi",null,"a"),Q("mo",null,","),Q("mi",null,"b"),Q("mo",null,">")])],-1))]),T[33]||(T[33]=t(" for vectors a and b.",-1))]),Q("p",null,[T[40]||(T[40]=t("A simple insight: ",-1)),Q("strong",null,[T[38]||(T[38]=t("If we L2 normalize vectors a and b, i.e., ",-1)),Q("mjx-container",V,[(e(),a("svg",b,[...T[34]||(T[34]=[l("",1)])])),T[35]||(T[35]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"a"),Q("mo",{stretchy:"false"},"~")])]),Q("mo",null,"="),Q("mfrac",null,[Q("mi",null,"a"),Q("mrow",null,[Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mi",null,"a"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),Q("mtext",null,"¬†"),Q("mo",null,","),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"b"),Q("mo",{stretchy:"false"},"~")])]),Q("mo",null,"="),Q("mfrac",null,[Q("mi",null,"b"),Q("mrow",null,[Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mi",null,"b"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])])],-1))]),T[39]||(T[39]=t(", then computing their dot product is equivalent to ",-1)),Q("mjx-container",v,[(e(),a("svg",_,[...T[36]||(T[36]=[l("",1)])])),T[37]||(T[37]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"c"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"a"),Q("mo",null,","),Q("mi",null,"b"),Q("mo",{stretchy:"false"},")")])],-1))])]),T[41]||(T[41]=t(". (This is straightforward, so we'll skip the proof)",-1))]),T[84]||(T[84]=Q("p",null,"In fact, this is exactly how all two-tower models in RecHub work: first computing User Embedding and Item Embedding, then applying L2 Norm to each, and finally computing their dot product to get cosine similarity. This approach improves model validation and inference speed.",-1)),T[85]||(T[85]=Q("h3",{id:"_2-3-euclidean-distance",tabindex:"-1"},[t("2.3 Euclidean Distance "),Q("a",{class:"header-anchor",href:"#_2-3-euclidean-distance","aria-label":"Permalink to ‚Äú2.3 Euclidean Distance‚Äù"},"‚Äã")],-1)),T[86]||(T[86]=Q("p",null,'Euclidean distance is what we commonly understand as "distance" in everyday life.',-1)),T[87]||(T[87]=Q("blockquote",null,[Q("p",null,[t("üôã"),Q("strong",null,"For L2 normalized vectors a and b, maximizing their cosine similarity is equivalent to minimizing their Euclidean distance")])],-1)),T[88]||(T[88]=Q("p",null,"Why? See the formula below:",-1)),Q("mjx-container",C,[(e(),a("svg",j,[...T[42]||(T[42]=[l("",1)])])),T[43]||(T[43]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[Q("mtr",null,[Q("mtd",null,[Q("mi",null,"E"),Q("mi",null,"u"),Q("mi",null,"c"),Q("mi",null,"l"),Q("mi",null,"i"),Q("mi",null,"d"),Q("mi",null,"i"),Q("mi",null,"a"),Q("mi",null,"n"),Q("mi",null,"D"),Q("mi",null,"i"),Q("mi",null,"s"),Q("mi",null,"t"),Q("mi",null,"a"),Q("mi",null,"n"),Q("mi",null,"c"),Q("mi",null,"e"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"a"),Q("mo",null,","),Q("mi",null,"b"),Q("msup",null,[Q("mo",{stretchy:"false"},")"),Q("mn",null,"2")])]),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"‚àë"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"a"),Q("mi",null,"i")]),Q("mo",null,"‚àí"),Q("msub",null,[Q("mi",null,"b"),Q("mi",null,"i")]),Q("msup",null,[Q("mo",{stretchy:"false"},")"),Q("mn",null,"2")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"‚àë"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msubsup",null,[Q("mi",null,"a"),Q("mi",null,"i"),Q("mn",null,"2")]),Q("mo",null,"+"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"‚àë"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msubsup",null,[Q("mi",null,"b"),Q("mi",null,"i"),Q("mn",null,"2")]),Q("mo",null,"‚àí"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"‚àë"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("mn",null,"2"),Q("mo",null,"‚àó"),Q("msub",null,[Q("mi",null,"a"),Q("mi",null,"i")]),Q("mo",null,"‚àó"),Q("msub",null,[Q("mi",null,"b"),Q("mi",null,"i")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("mn",null,"2"),Q("mo",null,"‚àí"),Q("mn",null,"2"),Q("mo",null,"‚àó"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"‚àë"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msub",null,[Q("mi",null,"a"),Q("mi",null,"i")]),Q("mo",null,"‚àó"),Q("msub",null,[Q("mi",null,"b"),Q("mi",null,"i")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("mn",null,"2"),Q("mo",null,"‚àó"),Q("mo",{stretchy:"false"},"("),Q("mn",null,"1"),Q("mo",null,"‚àí"),Q("mi",null,"c"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"a"),Q("mo",null,","),Q("mi",null,"b"),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")")])])])])],-1))]),T[89]||(T[89]=Q("p",null,"Two points to explain:",-1)),Q("ol",null,[Q("li",null,[T[46]||(T[46]=t("From second line to third line, ",-1)),Q("mjx-container",A,[(e(),a("svg",S,[...T[44]||(T[44]=[l("",1)])])),T[45]||(T[45]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{"data-mjx-texclass":"OP"},"‚àë"),Q("msubsup",null,[Q("mtext",null,"¬†"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("mi",null,"a"),Q("mi",{mathvariant:"normal"},"_"),Q("msup",null,[Q("mi",null,"i"),Q("mn",null,"2")]),Q("mo",null,"="),Q("mn",null,"1")])],-1))]),T[47]||(T[47]=t(". Why? Because a is L2 normalized. Same for b.",-1))]),Q("li",null,[T[50]||(T[50]=t("From third line to fourth line, ",-1)),Q("mjx-container",P,[(e(),a("svg",I,[...T[48]||(T[48]=[l("",1)])])),T[49]||(T[49]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"‚àë"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msub",null,[Q("mi",null,"a"),Q("mi",null,"i")]),Q("mo",null,"‚àó"),Q("msub",null,[Q("mi",null,"b"),Q("mi",null,"i")])])],-1))]),T[51]||(T[51]=t(" is the dot product of vectors a and b; since they're L2 normalized, this equals cos.",-1))])]),T[90]||(T[90]=l("",6)),Q("mjx-container",E,[(e(),a("svg",R,[...T[52]||(T[52]=[l("",1)])])),T[53]||(T[53]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mo",null,"‚àí"),Q("mi",null,"l"),Q("mi",null,"o"),Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"e"),Q("mi",null,"x"),Q("mi",null,"p"),Q("mo",{stretchy:"false"},"("),Q("mn",null,"1"),Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"/")]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"e"),Q("mi",null,"x"),Q("mi",null,"p"),Q("mo",{stretchy:"false"},"("),Q("mn",null,"1"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"+"),Q("mi",null,"e"),Q("mi",null,"x"),Q("mi",null,"p"),Q("mo",{stretchy:"false"},"("),Q("mo",null,"‚àí"),Q("mn",null,"1"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"‚àó"),Q("mn",null,"3"),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mn",null,"0.341")])],-1))]),Q("p",null,[T[56]||(T[56]=t("But if we divide the logits by a temperature coefficient ",-1)),Q("mjx-container",F,[(e(),a("svg",O,[...T[54]||(T[54]=[l("",1)])])),T[55]||(T[55]=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"m"),Q("mi",null,"p"),Q("mi",null,"e"),Q("mi",null,"r"),Q("mi",null,"a"),Q("mi",null,"t"),Q("mi",null,"u"),Q("mi",null,"r"),Q("mi",null,"e"),Q("mo",null,"="),Q("mn",null,"0.2")])],-1))]),T[57]||(T[57]=t(", making them (5, -5, -5, -5), after CrossEntropyLoss, we get:",-1))]),Q("mjx-container",N,[(e(),a("svg",B,[...T[58]||(T[58]=[l("",1)])])),T[59]||(T[59]=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mo",null,"‚àí"),Q("mi",null,"l"),Q("mi",null,"o"),Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"e"),Q("mi",null,"x"),Q("mi",null,"p"),Q("mo",{stretchy:"false"},"("),Q("mn",null,"5"),Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"/")]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"e"),Q("mi",null,"x"),Q("mi",null,"p"),Q("mo",{stretchy:"false"},"("),Q("mn",null,"5"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"+"),Q("mi",null,"e"),Q("mi",null,"x"),Q("mi",null,"p"),Q("mo",{stretchy:"false"},"("),Q("mo",null,"‚àí"),Q("mn",null,"5"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"‚àó"),Q("mn",null,"3"),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mn",null,"0.016")])],-1))]),T[91]||(T[91]=Q("p",null,"This gives us a negligibly small Loss.",-1)),T[92]||(T[92]=Q("p",null,[t("In other words, "),Q("strong",null,"dividing logits by a temperature expands the upper and lower bounds of each element in the logits, bringing them back into the sensitive range of softmax operations"),t(".")],-1)),T[93]||(T[93]=Q("p",null,"In practice, L2 Norm is commonly used together with temperature scaling.",-1))])}const Y=s(m,[["render",z]]);export{$ as __pageData,Y as default};
